<!doctype html><html lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=manifest href=manifest.webmanifest><link rel=icon type=image/png href=/img/favicon/favicon_hu2a60c33e6cc729e53465c846fe50d8b2_13867_32x32_fill_box_center_3.png><link rel=apple-touch-icon type=image/png href=/img/favicon/favicon_hu2a60c33e6cc729e53465c846fe50d8b2_13867_192x192_fill_box_center_3.png><meta name=description content="This second blog post deals with native code obfuscation and RASP syscall interception"><meta name=keywords content="ios,reverse engineering,obfuscation"><meta property="og:type" content="article"><meta property="og:description" content="This second blog post deals with native code obfuscation and RASP syscall interception"><meta property="og:title" content="Part 2 – iOS Native Code Obfuscation and Syscall Hooking | Romain Thomas"><meta property="og:site_name" content="Romain Thomas"><meta property="og:image" content="https://www.romainthomas.fr/post/22-09-ios-obfuscation-syscall-hooking/featured.png"><meta property="og:url" content="https://www.romainthomas.fr/post/22-09-ios-obfuscation-syscall-hooking/"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2022-09-13T00:00:00+00:00"><meta property="article:modified_time" content="2022-09-12T04:54:16+02:00"><meta property="article:tag" content="ios"><meta property="article:tag" content="reverse engineering"><meta property="article:tag" content="obfuscation"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@rh0main"><meta name=twitter:creator content="@rh0main"><meta name=twitter:title content="Part 2 – iOS Native Code Obfuscation and Syscall Hooking | Romain Thomas"><meta name=twitter:description content="This second blog post deals with native code obfuscation and RASP syscall interception"><meta name=twitter:domain content="https://www.romainthomas.fr/post/22-09-ios-obfuscation-syscall-hooking/"><meta property="twitter:image" content="https://www.romainthomas.fr/post/22-09-ios-obfuscation-syscall-hooking/featured.png"><title>Romain Thomas</title><link rel=canonical href=https://www.romainthomas.fr/post/22-09-ios-obfuscation-syscall-hooking/><link rel=stylesheet href=/css/fa-all.min.css><link rel=stylesheet href=/vendor/@glidejs/glide/dist/css/glide.core.min.css><link rel=stylesheet href=/vendor/@glidejs/glide/dist/css/glide.theme.min.css><link rel=stylesheet href=/css/theme.bundle.css><link rel=stylesheet href=/post/22-09-ios-obfuscation-syscall-hooking/style.css><style>.hide{opacity:0}</style><noscript><style>.hide{opacity:1;!important}</style></noscript><style>.hero_background{position:relative;overflow:hidden}.hero_background:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:90%;z-index:1;opacity:.2;background-image:url(/img/bg_home.svg);background-repeat:repeat;background-position:50%;background-size:100%;transform:rotate(180deg)}.project_bg{position:relative;overflow:hidden}.project_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:.1;background-image:url(/img/bg_project.svg);background-repeat:repeat;background-position:50%;background-size:100%;transform:rotate(180deg)}.experience_bg{position:relative;overflow:hidden}.experience_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:.1;background-image:url(/img/bg_experience.svg);background-position:0 0;background-size:100%}.post_bg{position:relative;overflow:hidden}.post_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:80%;z-index:1;opacity:.6;background-image:url(/img/bg_post.svg);background-position:0 0;background-size:100%}.contact_bg{position:relative;overflow:hidden}.contact_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:80%;z-index:1;opacity:.2;background-image:url(/img/bg_contact.svg);background-position:0 0;background-size:100%}.footnotes p{margin-bottom:0}.highlight{padding-left:20px;border-left:1px solid rgba(0,0,0,.1);border-radius:2px 2px}</style></head><body><header class=header-global><nav id=navbar-main aria-label="Primary navigation" class="navbar navbar-main navbar-expand-lg navbar-theme-primary headroom navbar-dark"><div class="container position-relative"><a class="navbar-brand me-lg-5" href=https://www.romainthomas.fr/><span class="navbar-brand-dark ft-ananda">R. T</span>
<span class="navbar-brand-light ft-ananda">R. T</span></a><div class="navbar-collapse collapse me-auto" id=navbar_global><div class=navbar-collapse-header><div class=row><div class="col-6 collapse-close"><a href=#navbar_global class="fas fa-times" data-bs-toggle=collapse data-bs-target=#navbar_global aria-controls=navbar_global aria-expanded=false title=close aria-label="Toggle navigation"></a></div></div></div><ul class="navbar-nav navbar-nav-hover align-items-lg-center"><li class=nav-item><a href=https://www.romainthomas.fr/#about class="nav-link fw-bold"><span class="fa-regular fa-person-swimming"></span> About</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#posts class="nav-link fw-bold"><span class="fa-regular fa-blog"></span> Posts</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#projects class="nav-link fw-bold"><span class="fa-regular fa-terminal"></span> Projects</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#publications class="nav-link fw-bold"><span class="far fa-book-open-cover"></span> Publications</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#work-experience class="nav-link fw-bold"><span class="fa-regular fa-briefcase"></span> Work Experience</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#misc class="nav-link fw-bold"><span class="fa-regular fa-chart-network"></span> Misc</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#contact class="nav-link fw-bold"><span class="fa-regular fa-binary-lock"></span> Contact</a></li></ul></div><div class="d-flex align-items-center"><button class="navbar-toggler ms-2 collapsed" type=button data-bs-toggle=collapse data-bs-target=#navbar_global aria-controls=navbar_global aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button></div></div></nav></header><main><section class="section-header pb-5 pb-sm-7 bg-primary text-white post_bg"><div class=container><div class="row justify-content-center"><div class="col-12 col-lg-10 text-center"><div class=mb-4><a href=/categories/ios/><span class="me-2 badge alert-info text-uppercase px-3 btn-outline-primary">iOS</span>
</a><a href=/categories/reverse-engineering/><span class="me-2 badge alert-info text-uppercase px-3 btn-outline-primary">Reverse Engineering</span></a></div><h1 class="display-3 mb-4 px-lg-5">Part 2 – iOS Native Code Obfuscation and Syscall Hooking</h1><div class=post-meta><span class="fw-bold me-3">Romain Thomas</span>
<span class="post-date me-3">September 13, 2022</span>
<span class=fw-bold>13 min read</span></div></div></div></div><figure class="position-absolute bottom-0 left-0 w-100 d-none d-md-block mb-n2"><svg class="fill-white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 3e3 185.4"><path d="M3e3.0v185.4H0V0c496.4 115.6 996.4 173.4 15e2 173.4S2503.6 115.6 3e3.0z"/></svg></figure></section><section class="section section-lg pt-0 pb-0" id=featured><div class="container mt-n8 mt-lg-n10 z-2 pb-0"><div class="row mt-7 mx-10"><img src=/post/22-09-ios-obfuscation-syscall-hooking/featured.png class="rounded img-fluid" alt=featured.png></div></div></section><div class="section section-sm bg-white pt-4 pt-lg-4 text-black"><article class=container><div class="row justify-content-center"><div class="col-12 col-lg-9"><p><div class="alert alert-info" role=alert style=border:none!important;background-color:#f9f9f9;color:#4d4d4d><span class="fas fa-book" style=color:#4d4d4d>&#160;</span>
The first part is here: <a href=https://www.romainthomas.fr/post/22-08-singpass-rasp-analysis/>Part 1 &ndash; SingPass RASP Analysis</a></div><p>After SingPass, I had a look at another application protected with the same obfuscator but with
enhanced protections.</p><p>Compared to the previous application, this new application crashes immediately as soon as it is launched.</p><p>By checking the crash log, we don&rsquo;t get any meaningful information since the obfuscator trashes some registers like
<code>LR</code> before crashing. By trashing <code>LR</code>, the iOS crash analytics service is not able to correctly build the call stack
of the functions that led to the crash.</p><p>On the other hand, by tracing the libraries loaded by the application, we can identify in which loaded library
the application crashes, and thus, the library is likely in charge of checking the environment&rsquo;s integrity.</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-text data-lang=text><span style=display:flex><span>$ ijector.py --spawn ios.app
</span></span><span style=display:flex><span>iTrace started
</span></span><span style=display:flex><span>PID: 63969 | tid: 771
</span></span><span style=display:flex><span>Home: /private/var/mobile/Containers/Data/Application/A59541E1-106A-4C31-8188-0830E651449E
</span></span><span style=display:flex><span>...
</span></span><span style=display:flex><span>ImageLoader::containsAddress(0x1065f948c): cxxreact!1948c
</span></span><span style=display:flex><span>ImageLoader::containsAddress(0x10564e270): ReactCommon!1a270
</span></span><span style=display:flex><span>ImageLoader::containsAddress(0x103e5ed84): GRDB!12ed84
</span></span><span style=display:flex><span>ImageLoader::containsAddress(0x104407790): Intercom!1bb790
</span></span><span style=display:flex><span>ImageLoader::containsAddress(0x104c29d7c): KaaSLogging!9d7c
</span></span><span style=display:flex><span>ImageLoader::containsAddress(0x105871bb4): RxSwift!91bb4
</span></span><span style=display:flex><span>ImageLoader::containsAddress(0x1056f00cc): RxBluetoothKit!440cc
</span></span><span style=display:flex><span>ImageLoader::containsAddress(0x104633f50): KaaSBle!bbf50
</span></span><span style=display:flex><span>---&gt; CRASH!
</span></span></code></pre></div><p>So the application crashes when loading the <code>KaaSBle</code> library embedded as a third-party framework of the application.</p><p>Compared SingPass, the library does not leak symbols about the RASP checks nor about
the obfuscator. In addition, some functions are obfuscated with control-flow flattening and Mixed Boolean-Arithmetic
(MBA) expressions as we can observe in the following figure:</p><center><figure><img src=/post/22-09-ios-obfuscation-syscall-hooking/imgs/cfg_flat_macho_ctor.webp alt="iOS Control-Flow Flattening"><br><figcaption>Figure 1 - Control-Flow Flattening in the Constructor of KaaSBle</figure></figure><br></center><p>Based on the previous analysis of <code>SingPass</code>, we know that RASP checks related to jailbreak or debugger detection use
uncommon functions like <code>getpid</code>, <code>unmount</code> or <code>pathconf</code>. It turns out that, these functions are also imported
by <code>KaaSBle</code> which enables to identify where some of the RASP checks are located.</p><div class="alert alert-info" role=alert style=border:none!important;background-color:#fafcff;color:#084298><span class="fas fa-message-code" style=color:#084298>&#160;</span>
Uncommon imported functions like <code>unmount</code> are usually a good signature to identify potential RASP checks</div><p>For instance, the function <span class="dark-boxed dark-yellow">sub_EBDC</span> which uses <code>getpid</code> is likely involved in the debugger detection. This
function is obfuscated with an MBA and control-flow flattening and, its graph is represented in Figure 2<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup></p><div class=col-lg-0 id=fig-2><center><figure><svg xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" viewBox="0 0 1e3 420.68967" id="sub_ebdc" sodipodi:docname="graph.svg" width="1e3" height="420.68967"><sodipodi:namedview id="namedview6359" pagecolor="#ffffff" bordercolor="#000000" borderopacity=".25" showgrid="false"/><defs id="defs5857"><marker style="overflow:visible" id="greenarrow" refX="3" refY="0" orient="auto-start-reverse" markerWidth="6.1347523" markerHeight="5.9304948" viewBox="0 0 6.1347524 5.9304951" preserveAspectRatio="xMidYMid"><path transform="scale(0.7)" d="m-.21114562-4.1055728L6.2111456-.89442719a1 1 90 010 1.78885438L-.21114562 4.1055728A1.236068 1.236068 31.717474 01-2 3v-6a1.236068 1.236068 148.28253 011.78885438-1.1055728z" style="fill:#28a745;fill-rule:evenodd;stroke:none" id="path1367"/></marker><marker style="overflow:visible" id="redarrow" refX="3" refY="0" orient="auto-start-reverse" markerWidth="6.1347523" markerHeight="5.9304948" viewBox="0 0 6.1347524 5.9304951" preserveAspectRatio="xMidYMid"><path transform="scale(0.7)" d="m-.21114562-4.1055728L6.2111456-.89442719a1 1 90 010 1.78885438L-.21114562 4.1055728A1.236068 1.236068 31.717474 01-2 3v-6a1.236068 1.236068 148.28253 011.78885438-1.1055728z" style="fill:#dc3545;fill-rule:evenodd;stroke:none" id="path5851"/></marker><marker style="overflow:visible" id="defaultarrow" refX="3" refY="0" orient="auto-start-reverse" markerWidth="6.1347523" markerHeight="5.9304948" viewBox="0 0 6.1347524 5.9304951" preserveAspectRatio="xMidYMid"><path transform="scale(0.7)" d="m-.21114562-4.1055728L6.2111456-.89442719a1 1 90 010 1.78885438L-.21114562 4.1055728A1.236068 1.236068 31.717474 01-2 3v-6a1.236068 1.236068 148.28253 011.78885438-1.1055728z" style="fill:#5fbcd3;fill-rule:evenodd;stroke:none" id="path5854"/></marker></defs><g id="g8670" transform="scale(6.8965517)"><rect x="0" y="0" width="145" height="61" fill="#4c4c4c" id="rect5859"/><g id="graph"><g id="basic-block"><rect x="63" y="2" width="23" height="6" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect5861"/><g id="g5913"><text x="63.5" y="3.2" font-size="1" font-family="'Fira Code'" id="text5867"><tspan fill="#fdd418" id="tspan5863">sub_ebdc</tspan><tspan fill="#fff" id="tspan5865">:</tspan></text><text x="63.5" y="4.1999998" font-size="1" font-family="'Fira Code'" id="text5879"><tspan fill="#ababab" id="tspan5869">int64_t</tspan><tspan fill="#fff" id="tspan5871">* </tspan><tspan fill="#88b0f0" id="tspan5873">var_20</tspan><tspan fill="#fff" id="tspan5875"> = </tspan><tspan fill="#88b0f0" id="tspan5877">arg2</tspan></text><text x="63.5" y="5.1999998" font-size="1" font-family="'Fira Code'" id="text5891"><tspan fill="#ababab" id="tspan5881">void</tspan><tspan fill="#fff" id="tspan5883">* </tspan><tspan fill="#88b0f0" id="tspan5885">x20</tspan><tspan fill="#fff" id="tspan5887"> = *</tspan><tspan fill="#88b0f0" id="tspan5889">arg2</tspan></text><text x="63.5" y="6.1999998" font-size="1" font-family="'Fira Code'" id="text5899"><tspan fill="#ababab" id="tspan5893">int32_t</tspan><tspan fill="#fff" id="tspan5895"> </tspan><tspan fill="#88b0f0" id="tspan5897">pid_is_null</tspan></text><text x="63.5" y="7.1999998" font-size="1" font-family="'Fira Code'" id="text5911"><tspan fill="#fff" id="tspan5901">if (</tspan><tspan fill="#fdd418" id="tspan5903">_getpid</tspan><tspan fill="#fff" id="tspan5905">() == </tspan><tspan fill="#6dcff6" id="tspan5907">0</tspan><tspan fill="#fff" id="tspan5909">)</tspan></text></g></g><g id="g5928"><rect x="57" y="10" width="16" height="2" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect5916"/><g id="g5926"><text x="57.5" y="11.2" font-size="1" font-family="'Fira Code'" id="text5924"><tspan fill="#88b0f0" id="tspan5918">pid_is_null</tspan><tspan fill="#fff" id="tspan5920"> = </tspan><tspan fill="#6dcff6" id="tspan5922">1</tspan></text></g></g><g id="g5942"><rect x="76" y="10" width="16" height="2" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect5930"/><g id="g5940"><text x="76.5" y="11.2" font-size="1" font-family="'Fira Code'" id="text5938"><tspan fill="#88b0f0" id="tspan5932">pid_is_null</tspan><tspan fill="#fff" id="tspan5934"> = </tspan><tspan fill="#6dcff6" id="tspan5936">0</tspan></text></g></g><g id="g6012"><rect x="45" y="16" width="59" height="5" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect5944"/><g id="g6010"><text x="45.5" y="17.200001" font-size="1" font-family="'Fira Code'" id="text5958"><tspan fill="#ababab" id="tspan5946">int32_t</tspan><tspan fill="#fff" id="tspan5948"> </tspan><tspan fill="#88b0f0" id="tspan5950">CST</tspan><tspan fill="#fff" id="tspan5952"> = neg.d(</tspan><tspan fill="#af0" id="tspan5954">data_141b60</tspan><tspan fill="#fff" id="tspan5956">)</tspan></text><text x="45.5" y="18.200001" font-size="1" font-family="'Fira Code'" id="text5988"><tspan fill="#ababab" id="tspan5960">int32_t</tspan><tspan fill="#fff" id="tspan5962"> </tspan><tspan fill="#88b0f0" id="tspan5964">x22</tspan><tspan fill="#fff" id="tspan5966"> = (</tspan><tspan fill="#88b0f0" id="tspan5968">CST</tspan><tspan fill="#fff" id="tspan5970"> ^ </tspan><tspan fill="#6dcff6" id="tspan5972">0x80722d06</tspan><tspan fill="#fff" id="tspan5974">) + ((</tspan><tspan fill="#88b0f0" id="tspan5976">CST</tspan><tspan fill="#fff" id="tspan5978"> &amp; </tspan><tspan fill="#6dcff6" id="tspan5980">0x722d06</tspan><tspan fill="#fff" id="tspan5982">) &lt;&lt; </tspan><tspan fill="#6dcff6" id="tspan5984">1</tspan><tspan fill="#fff" id="tspan5986">)</tspan></text><text x="45.5" y="19.200001" font-size="1" font-family="'Fira Code'" id="text6000"><tspan fill="#ababab" id="tspan5990">int32_t</tspan><tspan fill="#fff" id="tspan5992"> </tspan><tspan fill="#88b0f0" id="tspan5994">state_variable</tspan><tspan fill="#fff" id="tspan5996"> = </tspan><tspan fill="#6dcff6" id="tspan5998">4</tspan></text><text x="45.5" y="20.200001" font-size="1" font-family="'Fira Code'" id="text6008"><tspan fill="#ababab" id="tspan6002">int64_t</tspan><tspan fill="#fff" id="tspan6004"> </tspan><tspan fill="#88b0f0" id="tspan6006">ret_val</tspan></text></g></g><g id="g6026"><rect x="68" y="25" width="13" height="2" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6014"/><g id="g6024"><text x="68.5" y="26.200001" font-size="1" font-family="'Fira Code'" id="text6022"><tspan fill="#fff" id="tspan6016">while (</tspan><tspan fill="#6dcff6" id="tspan6018">true</tspan><tspan fill="#fff" id="tspan6020">)</tspan></text></g></g><g id="g6058"><rect x="56" y="29" width="38" height="3" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6028"/><g id="g6056"><text x="56.5" y="30.200001" font-size="1" font-family="'Fira Code'" id="text6042"><tspan fill="#ababab" id="tspan6030">uint64_t</tspan><tspan fill="#fff" id="tspan6032"> </tspan><tspan fill="#88b0f0" id="tspan6034">state</tspan><tspan fill="#fff" id="tspan6036"> = zx.q(</tspan><tspan fill="#88b0f0" id="tspan6038">state_variable</tspan><tspan fill="#fff" id="tspan6040">)</tspan></text><text x="56.5" y="31.200001" font-size="1" font-family="'Fira Code'" id="text6054"><tspan fill="#fff" id="tspan6044">if (</tspan><tspan fill="#88b0f0" id="tspan6046">state</tspan><tspan fill="#fff" id="tspan6048">.d u&lt;= </tspan><tspan fill="#6dcff6" id="tspan6050">4</tspan><tspan fill="#fff" id="tspan6052">)</tspan></text></g></g><g id="g6072"><rect x="67" y="34" width="15" height="2" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6060"/><g id="g6070"><text x="67.5" y="35.200001" font-size="1" font-family="'Fira Code'" id="text6068"><tspan fill="#fff" id="tspan6062">switch (</tspan><tspan fill="#88b0f0" id="tspan6064">state</tspan><tspan fill="#fff" id="tspan6066">)</tspan></text></g></g><g id="g6088"><rect x="13" y="40" width="11.5" height="3" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6074"/><g id="g6086"><text x="13.5" y="41.200001" font-size="1" font-family="'Fira Code'" id="text6080"><tspan fill="#fff" id="tspan6076">case </tspan><tspan fill="#6dcff6" id="tspan6078">0 : loc_ECA4</tspan></text><text x="13.5" y="42.200001" font-size="1" font-family="'Fira Code'" id="text6084"><tspan fill="#fff" id="tspan6082">break</tspan></text></g></g><g id="g6100"><rect x="39" y="40" width="11.5" height="2" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6090"/><g id="g6098"><text x="39.5" y="41.200001" font-size="1" font-family="'Fira Code'" id="text6096"><tspan fill="#fff" id="tspan6092">case </tspan><tspan fill="#6dcff6" id="tspan6094">1 : loc_EC78</tspan></text></g></g><g id="g6136"><rect x="27" y="44" width="31" height="4" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6102"/><g id="g6134"><text x="27.5" y="45.200001" font-size="1" font-family="'Fira Code'" id="text6120"><tspan fill="#88b0f0" id="tspan6104">ret_val</tspan><tspan fill="#fff" id="tspan6106"> = </tspan><tspan fill="#fdd418" id="tspan6108">sub_968e0</tspan><tspan fill="#fff" id="tspan6110">(</tspan><tspan fill="#88b0f0" id="tspan6112">arg1</tspan><tspan fill="#fff" id="tspan6114">, </tspan><tspan fill="#88b0f0" id="tspan6116">x20</tspan><tspan fill="#fff" id="tspan6118">)</tspan></text><text x="27.5" y="46.200001" font-size="1" font-family="'Fira Code'" id="text6128"><tspan fill="#88b0f0" id="tspan6122">state_variable</tspan><tspan fill="#fff" id="tspan6124"> = </tspan><tspan fill="#6dcff6" id="tspan6126">3</tspan></text><text x="27.5" y="47.200001" font-size="1" font-family="'Fira Code'" id="text6132"><tspan fill="#fff" id="tspan6130">continue</tspan></text></g></g><g id="g6148"><rect x="68" y="40" width="11.5" height="2" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6138"/><g id="g6146"><text x="68.5" y="41.200001" font-size="1" font-family="'Fira Code'" id="text6144"><tspan fill="#fff" id="tspan6140">case </tspan><tspan fill="#6dcff6" id="tspan6142">2 : loc_EC8C</tspan></text></g></g><g id="g6180"><rect x="61" y="44" width="21" height="4" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6150"/><g id="g6178"><text x="61.5" y="45.200001" font-size="1" font-family="'Fira Code'" id="text6164"><tspan fill="#fdd418" id="tspan6152">sub_968e0</tspan><tspan fill="#fff" id="tspan6154">(</tspan><tspan fill="#88b0f0" id="tspan6156">arg1</tspan><tspan fill="#fff" id="tspan6158">, </tspan><tspan fill="#88b0f0" id="tspan6160">x20</tspan><tspan fill="#fff" id="tspan6162">)</tspan></text><text x="61.5" y="46.200001" font-size="1" font-family="'Fira Code'" id="text6172"><tspan fill="#88b0f0" id="tspan6166">state_variable</tspan><tspan fill="#fff" id="tspan6168"> = </tspan><tspan fill="#6dcff6" id="tspan6170">1</tspan></text><text x="61.5" y="47.200001" font-size="1" font-family="'Fira Code'" id="text6176"><tspan fill="#fff" id="tspan6174">continue</tspan></text></g></g><g id="g6192"><rect x="91" y="40" width="11.5" height="2" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6182"/><g id="g6190"><text x="91.5" y="41.200001" font-size="1" font-family="'Fira Code'" id="text6188"><tspan fill="#fff" id="tspan6184">case </tspan><tspan fill="#6dcff6" id="tspan6186">3 : loc_EC9C</tspan></text></g></g><g id="g6210"><rect x="85" y="44" width="19" height="3" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6194"/><g id="g6208"><text x="85.5" y="45.200001" font-size="1" font-family="'Fira Code'" id="text6202"><tspan fill="#88b0f0" id="tspan6196">state_variable</tspan><tspan fill="#fff" id="tspan6198"> = </tspan><tspan fill="#6dcff6" id="tspan6200">0</tspan></text><text x="85.5" y="46.200001" font-size="1" font-family="'Fira Code'" id="text6206"><tspan fill="#fff" id="tspan6204">continue</tspan></text></g></g><g id="g6222"><rect x="120" y="40" width="11.5" height="2" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6212"/><g id="g6220"><text x="120.5" y="41.200001" font-size="1" font-family="'Fira Code'" id="text6218"><tspan fill="#fff" id="tspan6214">case </tspan><tspan fill="#6dcff6" id="tspan6216">4 : loc_EC50</tspan></text></g></g><g id="g6248"><rect x="111" y="44" width="24" height="3" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6224"/><g id="g6246"><text x="111.5" y="45.200001" font-size="1" font-family="'Fira Code'" id="text6232"><tspan fill="#ababab" id="tspan6226">int32_t</tspan><tspan fill="#fff" id="tspan6228"> </tspan><tspan fill="#88b0f0" id="tspan6230">next_state</tspan></text><text x="111.5" y="46.200001" font-size="1" font-family="'Fira Code'" id="text6244"><tspan fill="#fff" id="tspan6234">if (</tspan><tspan fill="#88b0f0" id="tspan6236">pid_is_null</tspan><tspan fill="#fff" id="tspan6238"> != </tspan><tspan fill="#88b0f0" id="tspan6240">x22</tspan><tspan fill="#fff" id="tspan6242">)</tspan></text></g></g><g id="g6262"><rect x="107" y="49" width="15" height="2" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6250"/><g id="g6260"><text x="107.5" y="50.200001" font-size="1" font-family="'Fira Code'" id="text6258"><tspan fill="#88b0f0" id="tspan6252">next_state</tspan><tspan fill="#fff" id="tspan6254"> = </tspan><tspan fill="#6dcff6" id="tspan6256">2</tspan></text></g></g><g id="g6276"><rect x="125" y="49" width="15" height="2" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6264"/><g id="g6274"><text x="125.5" y="50.200001" font-size="1" font-family="'Fira Code'" id="text6272"><tspan fill="#88b0f0" id="tspan6266">next_state</tspan><tspan fill="#fff" id="tspan6268"> = </tspan><tspan fill="#6dcff6" id="tspan6270">1</tspan></text></g></g><g id="g6290"><rect x="109" y="55" width="28" height="2" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6278"/><g id="g6288"><text x="109.5" y="56.200001" font-size="1" font-family="'Fira Code'" id="text6286"><tspan fill="#88b0f0" id="tspan6280">state_variable</tspan><tspan fill="#fff" id="tspan6282"> = </tspan><tspan fill="#88b0f0" id="tspan6284">next_state</tspan></text></g></g><g id="g6302"><rect x="9" y="45" width="15" height="2" fill="#2d2d2d" stroke-width=".1" stroke="#6dcff6" id="rect6292"/><g id="g6300"><text x="9.5" y="46.200001" font-size="1" font-family="'Fira Code'" id="text6298"><tspan fill="#fff" id="tspan6294">return </tspan><tspan fill="#88b0f0" id="tspan6296">ret_val</tspan></text></g></g><g id="edges"><path stroke-width=".1" stroke="#28a745" fill="none" d="m73 8v.5.0.0H64V10" style="marker-end:url(#greenarrow)" id="path6304"/><path stroke-width=".1" stroke="#dc3545" fill="none" d="m74 8v1 0 0h9v1" style="marker-end:url(#redarrow)" id="path6306"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m64 12v1 1.5.0h9V16" style="marker-end:url(#defaultarrow)" id="path6308"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m83 12v1 2 0h-9v1" style="marker-end:url(#defaultarrow)" id="path6310"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m71 21v.5.0.0.0V25" style="marker-end:url(#defaultarrow)" id="path6312"/><path stroke-width=".1" stroke="#28a745" fill="none" d="m73.5 27v1 0 0H74v1" style="marker-end:url(#greenarrow)" id="path6314"/><path stroke-width=".1" stroke="#28a745" fill="none" d="m73.5 32v.5.0.0.0V34" style="marker-end:url(#greenarrow)" id="path6316"/><path stroke-width=".1" stroke="#dc3545" fill="none" d="m74.5 32v1 0H3V22v0h69v3" style="marker-end:url(#redarrow)" id="path6318"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m71.5 36v1 0 0h-56v3" style="marker-end:url(#defaultarrow)" id="path6320"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m72.5 36v1.5.0.0h-31V40" style="marker-end:url(#defaultarrow)" id="path6322"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m73.5 36v2 0 0h-3v2" style="marker-end:url(#defaultarrow)" id="path6324"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m74.5 36v2.5.0.0h19V40" style="marker-end:url(#defaultarrow)" id="path6326"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m75.5 36v3 0 0h47v1" style="marker-end:url(#defaultarrow)" id="path6328"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m15.5 43v1 0 0 0 1" style="marker-end:url(#defaultarrow)" id="path6330"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m41.5 42v1 0 0 0 1" style="marker-end:url(#defaultarrow)" id="path6332"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m41.5 48v1 10H4V22.5v0H73V25" style="marker-end:url(#defaultarrow)" id="path6334"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m70.5 42v1 0 0 0 1" style="marker-end:url(#defaultarrow)" id="path6336"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m70.5 48v1 10.5H5V23v0h69v2" style="marker-end:url(#defaultarrow)" id="path6338"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m93.5 42v1 0 0 0 1" style="marker-end:url(#defaultarrow)" id="path6340"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m93.5 47v1 12H6V23.5v0H75V25" style="marker-end:url(#defaultarrow)" id="path6342"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m122.5 42v1 0 0H122v1" style="marker-end:url(#defaultarrow)" id="path6344"/><path stroke-width=".1" stroke="#28a745" fill="none" d="m121.5 47v.5.0.0h-8V49" style="marker-end:url(#greenarrow)" id="path6346"/><path stroke-width=".1" stroke="#dc3545" fill="none" d="m122.5 47v1 0 0h9v1" style="marker-end:url(#redarrow)" id="path6348"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m113.5 51v1 1.5.0h8V55" style="marker-end:url(#defaultarrow)" id="path6350"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m131.5 51v1 2 0h-9v1" style="marker-end:url(#defaultarrow)" id="path6352"/><path stroke-width=".1" stroke="#5fbcd3" fill="none" d="m122 57v1 0h21V24v0H76v1" style="marker-end:url(#defaultarrow)" id="path6354"/></g></g></g></svg><br><br><figcaption>Figure 2 - BinaryNinja HLIL Graph of <code>sub_EBDC</code></figure></figure><br></center></div><h2 id=control-flow-flattening>Control-Flow Flattening</h2><p>I won&rsquo;t detail how generally control-flow flattening works as it already exists a good bunch of articles on this topic:</p><ul><li><a href=https://blog.quarkslab.com/deobfuscation-recovering-an-ollvm-protected-program.html>Deobfuscation: recovering an OLLVM-protected program</a> by <a href=https://www.quarkslab.com/>Quarkslab</a></li><li><a href=https://synthesis.to/2021/03/03/flattening_detection.html>Automated Detection of Control-flow Flattening</a> by <a href=https://twitter.com/mr_phrazer>Tim Blazytko</a></li><li><a href=https://eshard.com/posts/D810-a-journey-into-control-flow-unflattening>D810: A journey into control flow unflattening</a> by <a href=https://eshard.com>eShard</a></li></ul><p>Nevertheless, we can notice that the state variable that is used to drive the execution through the flattened
blocks is linear and not encoded:</p><div class="admonition caution"><p><center><p><b>The state variable set at the end of the basic block exactly defines the next basic block to execute.</b></p></center></p></div><p>This means that given:</p><ol><li>A state value</li><li>The switch table</li><li>The <em>switch base address</em></li></ol><p>It is possible to easily compute the targeted basic block:</p><center><figure class=mb-4><img class=lightense data-lightense-background=#949494 src=/post/22-09-ios-obfuscation-syscall-hooking/imgs/cfg-flat.webp alt="Design of Graph Flattening"><figcaption>Fig 3. Computation of the Basic Block from a State Variable</figcaption></figure></center><center><figure class=mb-4><svg xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="825" height="400" viewBox="0 0 218.28125 105.83333" id="svg5" sodipodi:docname="cfg_flat_overview.svg"><sodipodi:namedview id="namedview7" pagecolor="#ffffff" bordercolor="#000000" borderopacity=".25" showgrid="true"><inkscape:grid type="xygrid" id="grid6790" spacingx="1.3229166" spacingy="1.3229166" empspacing="5"/></sodipodi:namedview><defs id="defs2"><rect x="76.030545" y="164.26145" width="192.08597" height="88.142442" id="rect105171"/><rect x="76.048523" y="71.00267" width="178.979" height="109.99996" id="rect104319"/><marker style="overflow:visible" id="RoundedArrow" refX="0" refY="0" orient="auto-start-reverse" markerWidth="4.1350002" markerHeight="3.9973249" viewBox="0 0 6.1347524 5.9304951" preserveAspectRatio="xMidYMid"><path transform="scale(0.7)" d="m-.21114562-4.1055728L6.2111456-.89442719a1 1 90 010 1.78885438L-.21114562 4.1055728A1.236068 1.236068 31.717474 01-2 3v-6a1.236068 1.236068 148.28253 011.78885438-1.1055728z" style="fill:context-stroke;fill-rule:evenodd;stroke:none" id="path1367"/></marker><marker style="overflow:visible" id="marker102507" refX="0" refY="0" orient="auto" markerWidth="5.6666665" markerHeight="5.6666665" viewBox="0 0 5.6666667 5.6666667" preserveAspectRatio="xMidYMid"><path transform="scale(0.5)" style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt" d="M5 0C5 2.76 2.76 5 0 5S-5 2.76-5 0s2.3-5 5-5c2.76.0 5 2.24 5 5z" id="path102505" sodipodi:nodetypes="sssss"/></marker><marker style="overflow:visible" id="marker102352" refX="0" refY="0" orient="auto" markerWidth="5.6666665" markerHeight="5.6666665" viewBox="0 0 5.6666667 5.6666667" preserveAspectRatio="xMidYMid"><path transform="scale(0.5)" style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt" d="M5 0C5 2.76 2.76 5 0 5S-5 2.76-5 0s2.3-5 5-5c2.76.0 5 2.24 5 5z" id="path102350" sodipodi:nodetypes="sssss"/></marker><marker style="overflow:visible" id="Dot" refX="0" refY="0" orient="auto" markerWidth="5.6666665" markerHeight="5.6666665" viewBox="0 0 5.6666667 5.6666667" preserveAspectRatio="xMidYMid"><path transform="scale(0.5)" style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt" d="M5 0C5 2.76 2.76 5 0 5S-5 2.76-5 0s2.3-5 5-5c2.76.0 5 2.24 5 5z" id="Dot1" sodipodi:nodetypes="sssss"/></marker><rect x="274.99999" y="49.999997" width="69.999996" height="24.999999" id="rect95241"/><rect x="324.99998" y="264.99999" width="119.99999" height="64.999997" id="rect93856"/><rect x="475" y="275.00001" width="20" height="49.999992" id="rect86923"/><rect x="475" y="275.00001" width="20" height="49.999992" id="rect91835"/><rect x="475" y="275.00001" width="20" height="49.999992" id="rect91841"/><rect x="475" y="275" width="20" height="49.999992" id="rect86923-1"/><rect x="475" y="275" width="20" height="49.999992" id="rect91841-9"/><rect x="475" y="275" width="68.360672" height="21.425254" id="rect91841-9-9"/><rect x="275" y="49.999996" width="69.999992" height="24.999998" id="rect95241-0"/><rect x="275" y="49.999996" width="69.999992" height="24.999998" id="rect95241-0-2"/><rect x="475" y="275" width="68.360672" height="21.425255" id="rect91841-9-9-9"/><rect x="475" y="275" width="68.360672" height="21.425255" id="rect91841-9-9-9-8"/></defs><g id="layer1"><g id="g93053" transform="translate(10.14754)"><rect style="fill:#353333;fill-opacity:1;stroke:#6dcff6;stroke-width:3;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" id="rect8369" width="150" height="300" x="25" y="50" transform="scale(0.26458333)"/><g id="g79195" transform="translate(19.524713,31.454402)" style="display:inline"><rect style="display:inline;fill:#353333;fill-opacity:1;stroke:#6dcff6;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="rect79189" width="75.000023" height="50" x="525" y="50" transform="matrix(0.26458333,0,0,0.26458333,13.229161,-7.5e-7)"/><rect style="display:inline;fill:#fdd418;fill-opacity:1;stroke:#6dcff6;stroke-width:2;stroke-linecap:square;stroke-linejoin:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:stroke markers fill" id="rect79191" width="20.000021" height="49.999992" x="555" y="50" transform="scale(0.26458333)"/><rect style="display:inline;fill:#5c92ea;fill-opacity:1;stroke:#6dcff6;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="rect79193" width="74.009033" height="14.033815" x="575.99097" y="100.96619" transform="scale(0.26458333)"/><text transform="matrix(0.26458333,0,0,0.26458333,31.470793,-46.02575)" id="text91839-0-1-0-1" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:10.6667px;font-family:furamono nerd font;-inkscape-font-specification:'FuraMono Nerd Font, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect91841-9-9-9-8);display:inline;fill:#353333;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="475" y="284.7067" id="tspan105598">var_4c</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,22.248995,-56.108595)" id="text91833" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:21.3333px;font-family:furamono nerd font;-inkscape-font-specification:'FuraMono Nerd Font, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect91835);display:inline;fill:#353333;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="475" y="294.4133" id="tspan105600">2</tspan></text><g id="g101859" style="display:inline"><path style="fill:#5c92ea;fill-opacity:1;stroke-width:14.8655" d="M22 11A2.0023 2.0023.0 0120 9V6A3.0033 3.0033.0 0017 3h-2a1 1 0 000 2h2a1.0009 1.0009.0 011 1V9a3.99 3.99.0 001.3574 3A3.99 3.99.0 0018 15v3a1.0009 1.0009.0 01-1 1h-2a1 1 0 000 2h2a3.0033 3.0033.0 003-3v-3a2.0023 2.0023.0 012-2 1 1 0 000-2z" transform="matrix(0.37970023,0,0,0.37970023,157.50088,15.287346)" id="path101855"/><path style="fill:#fdd418;fill-opacity:1;stroke-width:14.8655" d="M1 12a1 1 0 011-1A2.0023 2.0023.0 004 9V6A3.0033 3.0033.0 017 3H9A1 1 0 019 5H7A1.0009 1.0009.0 006 6V9A3.99 3.99.0 014.6426 12 3.99 3.99.0 016 15v3a1.0009 1.0009.0 001 1h2a1 1 0 010 2H7A3.0033 3.0033.0 014 18V15A2.0023 2.0023.0 002 13 1 1 0 011 12z" transform="matrix(0.37970023,0,0,0.37970023,157.50088,15.287346)" id="path101857"/></g></g><g id="g79203" transform="translate(19.524713,57.912736)" style="display:inline"><rect style="fill:#353333;fill-opacity:1;stroke:#6dcff6;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="rect79197" width="75.000023" height="50" x="525" y="50" transform="matrix(0.26458333,0,0,0.26458333,13.229161,-7.5e-7)"/><rect style="fill:#c364fc;fill-opacity:1;stroke:#6dcff6;stroke-width:2;stroke-linecap:square;stroke-linejoin:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:stroke markers fill" id="rect79199" width="20.000021" height="49.999992" x="555" y="50" transform="scale(0.26458333)"/><rect style="fill:#4c4949;fill-opacity:1;stroke:#6dcff6;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="rect79201" width="74.009033" height="14.033815" x="575.99097" y="100.96619" transform="scale(0.26458333)"/><text transform="matrix(0.26458333,0,0,0.26458333,31.435531,-45.802797)" id="text91839-0-1" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:10.6667px;font-family:furamono nerd font;-inkscape-font-specification:'FuraMono Nerd Font, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect91841-9-9);display:inline;fill:#6dcff6;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="475" y="284.7067" id="tspan105602">Return</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,22.082483,-56.111417)" id="text86921" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:21.3333px;font-family:furamono nerd font;-inkscape-font-specification:'FuraMono Nerd Font, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect86923);display:inline;fill:#353333;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="475" y="294.4133" id="tspan105604">3</tspan></text><g id="g101859-1" style="display:inline"><path style="fill:#4c4949;fill-opacity:1;stroke-width:14.8655" d="M22 11A2.0023 2.0023.0 0120 9V6A3.0033 3.0033.0 0017 3h-2a1 1 0 000 2h2a1.0009 1.0009.0 011 1V9a3.99 3.99.0 001.3574 3A3.99 3.99.0 0018 15v3a1.0009 1.0009.0 01-1 1h-2a1 1 0 000 2h2a3.0033 3.0033.0 003-3v-3a2.0023 2.0023.0 012-2 1 1 0 000-2z" transform="matrix(0.37970023,0,0,0.37970023,157.50088,15.287346)" id="path101855-0"/><path style="fill:#c364fc;fill-opacity:1;stroke-width:14.8655" d="M1 12a1 1 0 011-1A2.0023 2.0023.0 004 9V6A3.0033 3.0033.0 017 3H9A1 1 0 019 5H7A1.0009 1.0009.0 006 6V9A3.99 3.99.0 014.6426 12 3.99 3.99.0 016 15v3a1.0009 1.0009.0 001 1h2a1 1 0 010 2H7A3.0033 3.0033.0 014 18V15A2.0023 2.0023.0 002 13 1 1 0 011 12z" transform="matrix(0.37970023,0,0,0.37970023,157.50088,15.287346)" id="path101857-3"/></g></g><g id="g32984" transform="translate(19.524713,-0.29560073)" style="display:inline"><rect style="fill:#353333;fill-opacity:1;stroke:#6dcff6;stroke-width:2;stroke-linecap:butt;stroke-linejoin:miter;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="rect8375" width="75.000023" height="50" x="525" y="50" transform="matrix(0.26458333,0,0,0.26458333,13.229161,-7.5e-7)"/><rect style="fill:#5c92ea;fill-opacity:1;stroke:#6dcff6;stroke-width:2;stroke-linecap:square;stroke-linejoin:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:stroke markers fill" id="rect32980" width="20.000021" height="49.999992" x="555" y="50" transform="scale(0.26458333)"/><rect style="fill:#c364fc;fill-opacity:1;stroke:#6dcff6;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="rect34492" width="74.009033" height="14.033815" x="575.99097" y="100.96619" transform="scale(0.26458333)"/><text transform="matrix(0.26458333,0,0,0.26458333,31.470793,-46.02575)" id="text91839-0-1-0" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:10.6667px;font-family:furamono nerd font;-inkscape-font-specification:'FuraMono Nerd Font, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect91841-9-9-9);display:inline;fill:#353333;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="475" y="284.7067" id="tspan105606">var_4c</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,22.248994,-56.108595)" id="text91839" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:21.3333px;font-family:furamono nerd font;-inkscape-font-specification:'FuraMono Nerd Font, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect91841);display:inline;fill:#353333;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="475" y="294.4133" id="tspan105608">1</tspan></text><g id="g101508"><path style="stroke-width:14.8655;fill:#c364fc;fill-opacity:1" d="M22 11A2.0023 2.0023.0 0120 9V6A3.0033 3.0033.0 0017 3h-2a1 1 0 000 2h2a1.0009 1.0009.0 011 1V9a3.99 3.99.0 001.3574 3A3.99 3.99.0 0018 15v3a1.0009 1.0009.0 01-1 1h-2a1 1 0 000 2h2a3.0033 3.0033.0 003-3v-3a2.0023 2.0023.0 012-2 1 1 0 000-2z" transform="matrix(0.37970023,0,0,0.37970023,157.50088,15.287346)" id="path101504"/><path style="stroke-width:14.8655;fill:#5c92ea;fill-opacity:1" d="M1 12a1 1 0 011-1A2.0023 2.0023.0 004 9V6A3.0033 3.0033.0 017 3H9A1 1 0 019 5H7A1.0009 1.0009.0 006 6V9A3.99 3.99.0 014.6426 12 3.99 3.99.0 016 15v3a1.0009 1.0009.0 001 1h2a1 1 0 010 2H7A3.0033 3.0033.0 014 18V15A2.0023 2.0023.0 002 13 1 1 0 011 12z" transform="matrix(0.37970023,0,0,0.37970023,157.50088,15.287346)" id="path101129"/></g></g><g id="Flat" transform="matrix(0.1431512,0,0,0.1431512,69.922066,19.891827)" style="stroke-width:1.84828"><path d="m88 32h336c13.25483.0 23.98984 10.74517 24 24l.27613 360.09725S192.09204 416 64 416V56c0-13.254834 10.745166-24 24-24z" fill="#ccdce5" id="path59273" style="display:inline;fill:#353333;fill-opacity:1;stroke-width:5.47472" sodipodi:nodetypes="sssccss"/><path d="m88 32h336a24 24 0 0124 24V96H64V56A24 24 0 0188 32z" fill="#0093ba" id="path59275" style="display:inline;fill:#6dcff6;fill-opacity:1;stroke-width:5.47472"/><path d="m256 32h168c13.25483.0 24 10.745166 24 24V96H256z" fill="#047fa7" id="path59279" style="display:inline;fill:#6dcff6;fill-opacity:1;stroke-width:5.47472" sodipodi:nodetypes="cssccc"/><path d="m88 56h16V72H88z" fill="#ffc119" id="path59281" style="display:inline;fill:#0b81b2;fill-opacity:1;stroke-width:5.47472"/><path d="m120 56h16v16h-16z" fill="#ffc119" id="path59283" style="display:inline;fill:#0b81b2;fill-opacity:1;stroke-width:5.47472"/><path d="m376 56h48v16h-48z" fill="#06687f" id="path59289" style="display:inline;fill:#0b81b2;fill-opacity:1;stroke-width:5.47472"/><g fill="#abbac2" id="g59311" style="display:inline;stroke-width:5.47472"><g id="g86015" transform="translate(0,94.096666)" style="display:inline;stroke-width:5.47472"><path d="M260.10385 96H448v64H232.37967z" id="path86011" style="fill:#4e4b4b;fill-opacity:1;stroke-width:1.84828" sodipodi:nodetypes="ccccc"/><path d="m255.19083 96h186.86246l-27.72418 64H255.19083z" id="path86013" style="fill:#5c92ea;fill-opacity:1;stroke-width:1.84828" sodipodi:nodetypes="ccccc" transform="translate(-191.19083)"/><text transform="matrix(1.8482788,0,0,1.8482788,-215.79192,16.745353)" id="text95239" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:20px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect95241);display:inline;fill:#e0e0e0;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="275" y="67.254197" id="tspan105610">ID: 1</tspan></text></g><g id="g94315" transform="translate(0,172.64852)" style="stroke-width:5.47472"><path d="M260.10385 96H448v64H232.37967z" id="path94311" style="fill:#4e4b4b;fill-opacity:1;stroke-width:1.84828" sodipodi:nodetypes="ccccc"/><path d="m255.19083 96h186.86246l-27.72418 64H255.19083z" id="path94313" style="fill:#fdd418;fill-opacity:1;stroke-width:1.84828" sodipodi:nodetypes="ccccc" transform="translate(-191.19083)"/><text transform="matrix(1.8482788,0,0,1.8482788,-215.79192,16.745353)" id="text95239-6" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:20px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect95241-0);display:inline;fill:#e0e0e0;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="275" y="67.254197" id="tspan105612">ID: 2</tspan></text></g><g id="g94321" transform="translate(0,15.544812)" style="stroke-width:5.47472"><path d="M260.10385 96H448v64H232.37967z" id="path94317" style="fill:#4e4b4b;fill-opacity:1;stroke-width:1.84828" sodipodi:nodetypes="ccccc"/><path d="m255.19083 96h186.86246l-27.72418 64H255.19083z" id="path94319" style="fill:#c364fc;fill-opacity:1;stroke-width:1.84828" sodipodi:nodetypes="ccccc" transform="translate(-191.19083)"/><text transform="matrix(1.8482788,0,0,1.8482788,-215.18726,16.943899)" id="text95239-6-9" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:20px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect95241-0-2);display:inline;fill:#e0e0e0;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="275" y="67.254197" id="tspan105614">ID: 3</tspan></text></g><path style="fill:none;fill-opacity:1;stroke:#c364fc;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#Dot);paint-order:markers stroke fill" d="m765.03548 106.86586h10l-.0355-71.865862h-450V149.99999h10" id="path97596" transform="matrix(1.8482788,0,0,1.8482788,-559.3359,-138.95676)" sodipodi:nodetypes="cccccc"/><path style="fill:none;fill-opacity:1;stroke:#5c92ea;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#marker102352);paint-order:markers stroke fill" d="m764.99996 226.57451h20V24.999999H314.99998V199.99999h20" id="path97598" transform="matrix(1.8482788,0,0,1.8482788,-559.3359,-138.95676)" sodipodi:nodetypes="cccccc"/><path style="fill:none;fill-opacity:1;stroke:#c364fc;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#RoundedArrow);paint-order:markers stroke fill" d="m549.01296 152.84576h35.99511l-.008 147.15422h73" id="path97600" transform="matrix(1.8482788,0,0,1.8482788,-559.3359,-138.95676)" sodipodi:nodetypes="cccc"/><path style="fill:none;fill-opacity:1;stroke:#5c92ea;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#RoundedArrow);paint-order:markers stroke fill" d="m549.01296 195.34576 75.98701-.002V74.999996h33" id="path97602" transform="matrix(1.8482788,0,0,1.8482788,-559.3359,-138.95676)" sodipodi:nodetypes="cccc"/><path style="fill:none;fill-opacity:1;stroke:#fdd418;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;marker-end:url(#RoundedArrow);paint-order:markers stroke fill" d="m549.01296 237.84576 100.98701-.0333v-52.8125h8" id="path97604" transform="matrix(1.8482788,0,0,1.8482788,-559.3359,-138.95676)" sodipodi:nodetypes="cccc"/><path style="fill:none;fill-opacity:1;stroke:#fdd418;stroke-width:2.00000004;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill;marker-end:url(#marker102507)" d="m219.99999 234.99999h115" id="path97606" transform="matrix(1.8482788,0,0,1.8482788,-559.3359,-138.95676)" sodipodi:nodetypes="cc"/></g><g id="g94120"><path d="M248 480H56c-13.254834.0-24-10.74517-24-24v-88c0-13.25483 10.745166-24 24-24H96h16.91334H128 248c13.25483.0 24 10.74517 24 24v88c0 13.25483-10.74517 24-24 24z" fill="#88bf40" id="path59313" style="fill:#858282;fill-opacity:1;stroke:#2b2a2a;stroke-width:5.47472;stroke-opacity:1" sodipodi:nodetypes="ssssscccssss"/><text transform="matrix(1.8482788,0,0,1.8482788,-531.44634,-102.71633)" id="text93854" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:22.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect93856);display:inline;fill:#fff;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:square;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="325" y="284.55479" id="tspan105616">jpt_ec74</tspan></text></g></g><text transform="matrix(0.26458333,0,0,0.26458333,-10.708761,-0.9073807)" id="text104317" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:22.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect104319);display:inline;fill:#6dcff6;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="76.048828" y="90.556738" id="tspan105618">Entry Block</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,-11.840476,15.290513)" id="text105169" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:22.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect105171);display:inline;fill:#6dcff6;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="76.03125" y="183.8165" id="tspan105620">var_4c :=</tspan></text><circle style="fill:#fdd418;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="path105251" cx="184.12276" cy="237.85802" r="8.524704" transform="matrix(0.26458333,0,0,0.26458333,-10.651999,-0.75618674)"/></g></g></svg><figcaption>Fig 4. Simplified Overview</figcaption></figure></center><p>Since there is no encoding, we can determine the next states of a basic block by looking at the constant
written in the local stack variable <span class="dark-boxed text-white">[<span class=dark-clear-blue>sp</span>, <span class=dark-red>0x50</span>+<span class=dark-orange>var_4c</span>]</span>
or the <span class="dark-boxed dark-blue">state_variable</span> of the BinaryNinja High Level IL representation (<a href=#fig-2>Figure 2</a>).</p><p>From a graph recovery perspective, this design <strong>completely fits</strong> in the case of the Quarkslab&rsquo;s blog:
<a href=https://blog.quarkslab.com/deobfuscation-recovering-an-ollvm-protected-program.html>recovering an OLLVM-protected program </a>,
thus the original graph could be completely recovered.</p><div class="alert alert-info" role=alert style=border:none!important;background-color:#ffefef;color:#8a1919><span class="fas fa-circle-exclamation" style=color:#8a1919>&#160;</span>
I also checked other large control-flow-flattened functions in the binary and they follow the same design with
the same weakness.</div><h3 id=improvements>Improvements</h3><div class="admonition hint"><p><b>Spoiler</b>: <em>This example comes from an on-going larger project: <a href=https://github.com/open-obfuscator>open-obfuscator</a>.</em></p></div><p>Actually we can enhance the protections of the control-flow flattening by encoding the state variable and by identifying the
basic blocks of the switch table with random numbers (instead of 1, 2, 3 etc).</p><p>The following figure outlines this design:</p><center><figure class=mb-4><svg xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="825" height="400" viewBox="0 0 218.28125 105.83333" id="svg5" sodipodi:docname="cfg_flat_overview_new.svg"><sodipodi:namedview id="namedview7" pagecolor="#ffffff" bordercolor="#000000" borderopacity=".25" showgrid="true"><inkscape:grid type="xygrid" id="grid6790" spacingx="1.3229166" spacingy="1.3229166" empspacing="5"/></sodipodi:namedview><defs id="defs2"><rect x="34.999998" y="124.99999" width="74.999996" height="49.999997" id="rect163262"/><marker style="overflow:visible" id="TriangleStart" refX="0" refY="0" orient="auto-start-reverse" markerWidth="2.3239999" markerHeight="2.6867051" viewBox="0 0 5.3244081 6.1553851" preserveAspectRatio="xMidYMid"><path transform="scale(0.5)" style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt" d="M5.77.0-2.88 5V-5z" id="path135"/></marker><marker style="overflow:visible" id="Dot" refX="0" refY="0" orient="auto" markerWidth="2.6670001" markerHeight="2.6670001" viewBox="0 0 5.6666667 5.6666667" preserveAspectRatio="xMidYMid"><path transform="scale(0.5)" style="fill:context-stroke;fill-rule:evenodd;stroke:context-stroke;stroke-width:1pt" d="M5 0C5 2.76 2.76 5 0 5S-5 2.76-5 0s2.3-5 5-5c2.76.0 5 2.24 5 5z" id="Dot1" sodipodi:nodetypes="sssss"/></marker><rect x="299.99998" y="234.99999" width="260" height="105" id="rect144728"/><rect x="539.99997" y="119.99999" width="104.99999" height="89.999995" id="rect133017"/><meshgradient id="meshgradient129956" gradientUnits="userSpaceOnUse" x="5.9115825" y="5.9385824"><meshrow id="meshrow129958"><meshpatch id="meshpatch129960"><stop path="c 81.3743,0 162.749,0 244.123,0" style="stop-color:#5c92ea;stop-opacity:1" id="stop129962"/><stop path="c 0,81.3743 0,162.749 0,244.123" style="stop-color:#353333;stop-opacity:1" id="stop129964"/><stop path="c -81.3743,0 -162.749,0 -244.123,0" style="stop-color:#ffffff;stop-opacity:1" id="stop129966"/><stop path="c 0,-81.3743 0,-162.749 0,-244.123" style="stop-color:#353333;stop-opacity:1" id="stop129968"/></meshpatch></meshrow></meshgradient><meshgradient id="meshgradient130409" gradientUnits="userSpaceOnUse" x="5.9031706" y="5.9031706"><meshrow id="meshrow130423"><meshpatch id="meshpatch130425"><stop path="c 81.3979,0 159.194,-41.8262 244.194,0" style="stop-color:#5c92ea;stop-opacity:1" id="stop130427"/><stop path="c 0,81.3979 0,162.796 0,244.194" style="stop-color:#5c92ea;stop-opacity:1" id="stop130429"/><stop path="c -81.3979,0 -162.796,0 -244.194,0" style="stop-color:#fdd418;stop-opacity:1" id="stop130431"/><stop path="c 0,-81.3979 0,-162.796 0,-244.194" style="stop-color:#c364fc;stop-opacity:1" id="stop130433"/></meshpatch></meshrow></meshgradient><rect x="76.048523" y="71.00267" width="178.979" height="109.99996" id="rect104319"/><meshgradient id="meshgradient129956-9" gradientUnits="userSpaceOnUse" x="5.9115825" y="5.9385824"><meshrow id="meshrow129958-8"><meshpatch id="meshpatch129960-9"><stop path="c 81.3743,0 162.749,0 244.123,0" style="stop-color:#5c92ea;stop-opacity:1" id="stop129962-8"/><stop path="c 0,81.3743 0,162.749 0,244.123" style="stop-color:#353333;stop-opacity:1" id="stop129964-3"/><stop path="c -81.3743,0 -162.749,0 -244.123,0" style="stop-color:#ffffff;stop-opacity:1" id="stop129966-8"/><stop path="c 0,-81.3743 0,-162.749 0,-244.123" style="stop-color:#353333;stop-opacity:1" id="stop129968-0"/></meshpatch></meshrow></meshgradient><meshgradient id="meshgradient130409-4" gradientUnits="userSpaceOnUse" x="5.9031706" y="5.9031706"><meshrow id="meshrow130423-1"><meshpatch id="meshpatch130425-5"><stop path="c 81.3979,0 159.194,-41.8262 244.194,0" style="stop-color:#5c92ea;stop-opacity:1" id="stop130427-1"/><stop path="c 0,81.3979 0,162.796 0,244.194" style="stop-color:#5c92ea;stop-opacity:1" id="stop130429-9"/><stop path="c -81.3979,0 -162.796,0 -244.194,0" style="stop-color:#fdd418;stop-opacity:1" id="stop130431-6"/><stop path="c 0,-81.3979 0,-162.796 0,-244.194" style="stop-color:#c364fc;stop-opacity:1" id="stop130433-2"/></meshpatch></meshrow></meshgradient></defs><g id="layer1"><g id="g32984" transform="translate(-1.3411901,-0.03441181)"><rect style="fill:#353333;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2" id="rect8375" width="75.000023" height="50" x="525" y="50" transform="matrix(0.26458333,0,0,0.26458333,13.229161,-7.5e-7)"/><g id="g101508" style="display:inline"><path style="fill:#d3d3d3;fill-opacity:1;stroke-width:14.8655" d="M22 11A2.0023 2.0023.0 0120 9V6A3.0033 3.0033.0 0017 3h-2a1 1 0 000 2h2a1.0009 1.0009.0 011 1V9a3.99 3.99.0 001.3574 3A3.99 3.99.0 0018 15v3a1.0009 1.0009.0 01-1 1h-2a1 1 0 000 2h2a3.0033 3.0033.0 003-3v-3a2.0023 2.0023.0 012-2 1 1 0 000-2z" transform="matrix(0.37970023,0,0,0.37970023,157.50088,15.287346)" id="path101504"/><path style="fill:#5c92ea;fill-opacity:1;stroke-width:14.8655" d="M1 12a1 1 0 011-1A2.0023 2.0023.0 004 9V6A3.0033 3.0033.0 017 3H9A1 1 0 019 5H7A1.0009 1.0009.0 006 6V9A3.99 3.99.0 014.6426 12 3.99 3.99.0 016 15v3a1.0009 1.0009.0 001 1h2a1 1 0 010 2H7A3.0033 3.0033.0 014 18V15A2.0023 2.0023.0 002 13 1 1 0 011 12z" transform="matrix(0.37970023,0,0,0.37970023,157.50088,15.287346)" id="path101129"/></g><rect style="fill:#5c92ea;fill-opacity:1;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2" id="rect32980" width="20.000021" height="49.999992" x="555" y="50" transform="scale(0.26458333)"/><rect style="fill:#d3d3d3;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2" id="rect34492" width="75" height="14.999999" x="575" y="99.999992" transform="scale(0.26458333)"/></g><rect style="fill:#353333;fill-opacity:1;stroke:#6dcff6;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-opacity:1" id="rect37123" width="245.00002" height="300" x="275" y="50" transform="scale(0.26458333)"/><g id="g136220" style="display:inline;isolation:isolate;stroke-width:1.69711" transform="matrix(0.20787186,0,0,0.20786737,-36.766768,-24.176343)"><g id="g136004" style="stroke-width:1.69711"><path d="m564 311h44c1.656.0 3 1.344 3 3v54c0 1.656-1.344 3-3 3h-44c-1.656.0-3-1.344-3-3v-54c0-1.656 1.344-3 3-3z" style="fill:#727070;stroke:none;stroke-width:1.69711;stroke-miterlimit:10" id="path135944"/><path d="m564 311h44c1.656.0 3 1.344 3 3v54c0 1.656-1.344 3-3 3h-44c-1.656.0-3-1.344-3-3v-54c0-1.656 1.344-3 3-3z" style="fill:none;stroke:#000;stroke-width:3.39422;stroke-linecap:square;stroke-miterlimit:2" id="path135946"/><path d="m563.25 310h43.5c1.794.0 3.25 1.456 3.25 3.25v53.5c0 1.794-1.456 3.25-3.25 3.25h-43.5c-1.794.0-3.25-1.456-3.25-3.25v-53.5c0-1.794 1.456-3.25 3.25-3.25z" style="fill:#5d5c5c;stroke:none;stroke-width:1.69711;stroke-miterlimit:10" id="path135948"/><g id="g135958" style="stroke-width:1.69711"><g id="g135954" style="stroke-width:1.69711"><line x1="575" y1="360" x2="590" y2="360" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#003f74" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line135950"/><line x1="595" y1="360" x2="606" y2="360" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line135952"/></g><circle vector-effect="non-scaling-stroke" cx="570" cy="360" r="2" fill="#aeaeae" id="circle135956" style="stroke-width:2.40535"/></g><g id="g135970" style="stroke-width:1.69711"><g id="g135966" style="stroke-width:1.69711"><line x1="575" y1="350" x2="580" y2="350" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line135960"/><line x1="584" y1="350" x2="600" y2="350" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line135962"/><line x1="603" y1="350" x2="606" y2="350" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line135964"/></g><circle vector-effect="non-scaling-stroke" cx="570" cy="350" r="2" fill="#aeaeae" id="circle135968" style="stroke-width:2.40535"/></g><g id="g135980" style="stroke-width:1.69711"><g id="g135976" style="stroke-width:1.69711"><line x1="575" y1="340" x2="595" y2="340" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#003f74" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line135972"/><line x1="599" y1="340" x2="606" y2="340" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line135974"/></g><circle vector-effect="non-scaling-stroke" cx="570" cy="340" r="2" fill="#aeaeae" id="circle135978" style="stroke-width:2.40535"/></g><g id="g135992" style="stroke-width:1.69711"><g id="g135988" style="stroke-width:1.69711"><line x1="575" y1="330" x2="580" y2="330" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line135982"/><line x1="584" y1="330" x2="595.26599" y2="330" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#003f74" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line135984"/><line x1="599" y1="330" x2="606" y2="330" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line135986"/></g><circle vector-effect="non-scaling-stroke" cx="570" cy="330" r="2" fill="#aeaeae" id="circle135990" style="stroke-width:2.40535"/></g><g id="g136002" style="stroke-width:1.69711"><g id="g135998" style="stroke-width:1.69711"><line x1="575" y1="320" x2="582" y2="320" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line135994"/><line x1="586" y1="320" x2="606" y2="320" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line135996"/></g><circle vector-effect="non-scaling-stroke" cx="570" cy="320" r="2" fill="#aeaeae" id="circle136000" style="stroke-width:2.40535"/></g></g><g id="g136066" style="stroke-width:1.69711"><path d="m764 311h44c1.656.0 3 1.344 3 3v54c0 1.656-1.344 3-3 3h-44c-1.656.0-3-1.344-3-3v-54c0-1.656 1.344-3 3-3z" style="fill:#727070;stroke:none;stroke-width:1.69711;stroke-miterlimit:10" id="path136006"/><path d="m764 311h44c1.656.0 3 1.344 3 3v54c0 1.656-1.344 3-3 3h-44c-1.656.0-3-1.344-3-3v-54c0-1.656 1.344-3 3-3z" style="display:inline;fill:#5b9bb5;fill-opacity:1;stroke:#000;stroke-width:3.39422;stroke-linecap:square;stroke-miterlimit:2" id="path136008"/><path d="m763.25 310h43.5c1.794.0 3.25 1.456 3.25 3.25v53.5c0 1.794-1.456 3.25-3.25 3.25h-43.5c-1.794.0-3.25-1.456-3.25-3.25v-53.5c0-1.794 1.456-3.25 3.25-3.25z" style="fill:#5d5c5c;stroke:none;stroke-width:1.69711;stroke-miterlimit:10" id="path136010"/><g id="g136020" style="stroke-width:1.69711"><g id="g136016" style="stroke-width:1.69711"><line x1="775" y1="360" x2="790" y2="360" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#003f74" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136012"/><line x1="795" y1="360" x2="806" y2="360" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136014"/></g><circle vector-effect="non-scaling-stroke" cx="770" cy="360" r="2" fill="#aeaeae" id="circle136018" style="stroke-width:2.40535"/></g><g id="g136032" style="stroke-width:1.69711"><g id="g136028" style="stroke-width:1.69711"><line x1="775" y1="350" x2="780" y2="350" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136022"/><line x1="784" y1="350" x2="800" y2="350" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136024"/><line x1="803" y1="350" x2="806" y2="350" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136026"/></g><circle vector-effect="non-scaling-stroke" cx="770" cy="350" r="2" fill="#aeaeae" id="circle136030" style="stroke-width:2.40535"/></g><g id="g136042" style="stroke-width:1.69711"><g id="g136038" style="stroke-width:1.69711"><line x1="775" y1="340" x2="795" y2="340" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#003f74" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136034"/><line x1="799" y1="340" x2="806" y2="340" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136036"/></g><circle vector-effect="non-scaling-stroke" cx="770" cy="340" r="2" fill="#aeaeae" id="circle136040" style="stroke-width:2.40535"/></g><g id="g136054" style="stroke-width:1.69711"><g id="g136050" style="stroke-width:1.69711"><line x1="775" y1="330" x2="780" y2="330" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136044"/><line x1="784" y1="330" x2="795.26599" y2="330" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#003f74" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136046"/><line x1="799" y1="330" x2="806" y2="330" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136048"/></g><circle vector-effect="non-scaling-stroke" cx="770" cy="330" r="2" fill="#aeaeae" id="circle136052" style="stroke-width:2.40535"/></g><g id="g136064" style="stroke-width:1.69711"><g id="g136060" style="stroke-width:1.69711"><line x1="775" y1="320" x2="782" y2="320" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136056"/><line x1="786" y1="320" x2="806" y2="320" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136058"/></g><circle vector-effect="non-scaling-stroke" cx="770" cy="320" r="2" fill="#aeaeae" id="circle136062" style="stroke-width:2.40535"/></g></g><g id="g136128" style="stroke-width:1.69711"><path d="m664 341h44c1.656.0 3 1.344 3 3v54c0 1.656-1.344 3-3 3h-44c-1.656.0-3-1.344-3-3v-54c0-1.656 1.344-3 3-3z" style="fill:#727070;stroke:none;stroke-width:1.69711;stroke-miterlimit:10" id="path136068"/><path d="m664 341h44c1.656.0 3 1.344 3 3v54c0 1.656-1.344 3-3 3h-44c-1.656.0-3-1.344-3-3v-54c0-1.656 1.344-3 3-3z" style="fill:none;stroke:#000;stroke-width:3.39422;stroke-linecap:square;stroke-miterlimit:2" id="path136070"/><path d="m663.25 340h43.5c1.794.0 3.25 1.456 3.25 3.25v53.5c0 1.794-1.456 3.25-3.25 3.25h-43.5c-1.794.0-3.25-1.456-3.25-3.25v-53.5c0-1.794 1.456-3.25 3.25-3.25z" style="fill:#5d5c5c;stroke:none;stroke-width:1.69711;stroke-miterlimit:10" id="path136072"/><g id="g136082" style="stroke-width:1.69711"><g id="g136078" style="stroke-width:1.69711"><line x1="675" y1="390" x2="690" y2="390" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#003f74" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136074"/><line x1="695" y1="390" x2="706" y2="390" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136076"/></g><circle vector-effect="non-scaling-stroke" cx="670" cy="390" r="2" fill="#aeaeae" id="circle136080" style="stroke-width:2.40535"/></g><g id="g136094" style="stroke-width:1.69711"><g id="g136090" style="stroke-width:1.69711"><line x1="675" y1="380" x2="680" y2="380" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136084"/><line x1="684" y1="380" x2="700" y2="380" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136086"/><line x1="703" y1="380" x2="706" y2="380" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136088"/></g><circle vector-effect="non-scaling-stroke" cx="670" cy="380" r="2" fill="#aeaeae" id="circle136092" style="stroke-width:2.40535"/></g><g id="g136104" style="stroke-width:1.69711"><g id="g136100" style="stroke-width:1.69711"><line x1="675" y1="370" x2="695" y2="370" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#003f74" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136096"/><line x1="699" y1="370" x2="706" y2="370" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136098"/></g><circle vector-effect="non-scaling-stroke" cx="670" cy="370" r="2" fill="#aeaeae" id="circle136102" style="stroke-width:2.40535"/></g><g id="g136116" style="stroke-width:1.69711"><g id="g136112" style="stroke-width:1.69711"><line x1="675" y1="360" x2="680" y2="360" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136106"/><line x1="684" y1="360" x2="695.26599" y2="360" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#003f74" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136108"/><line x1="699" y1="360" x2="706" y2="360" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136110"/></g><circle vector-effect="non-scaling-stroke" cx="670" cy="360" r="2" fill="#aeaeae" id="circle136114" style="stroke-width:2.40535"/></g><g id="g136126" style="stroke-width:1.69711"><g id="g136122" style="stroke-width:1.69711"><line x1="675" y1="350" x2="682" y2="350" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136118"/><line x1="686" y1="350" x2="706" y2="350" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136120"/></g><circle vector-effect="non-scaling-stroke" cx="670" cy="350" r="2" fill="#aeaeae" id="circle136124" style="stroke-width:2.40535"/></g></g><g id="g136142" style="stroke-width:1.69711"><path d="m662.876 291h46.248c1.035.0 1.876.841 1.876 1.876v16.248c0 1.035-.841 1.876-1.876 1.876H662.876C661.841 311 661 310.159 661 309.124v-16.248c0-1.035.841-1.876 1.876-1.876z" style="fill:#6dcff6;stroke:none;stroke-width:1.69711;stroke-miterlimit:10" id="path136130"/><path d="m661.876 290h46.248c1.035.0 1.876.841 1.876 1.876v16.248c0 1.035-.841 1.876-1.876 1.876H661.876C660.841 310 660 309.159 660 308.124v-16.248c0-1.035.841-1.876 1.876-1.876z" style="fill:#5d5c5c;stroke:none;stroke-width:1.69711;stroke-miterlimit:10" id="path136132"/><g id="g136140" style="stroke-width:1.69711"><g id="g136136" style="stroke-width:1.69711"><line x1="675" y1="300" x2="706" y2="300" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136134"/></g><circle vector-effect="non-scaling-stroke" cx="670" cy="300" r="2" fill="#aeaeae" id="circle136138" style="stroke-width:2.40535"/></g></g><g id="g136202" style="stroke-width:1.69711"><path d="m664.51 211h42.98c1.937.0 3.51 1.573 3.51 3.51v62.98c0 1.937-1.573 3.51-3.51 3.51h-42.98c-1.937.0-3.51-1.573-3.51-3.51v-62.98c0-1.937 1.573-3.51 3.51-3.51z" style="fill:#6dcff6;stroke:none;stroke-width:1.69711;stroke-miterlimit:10" id="path136144"/><path d="m663.51 210h42.98c1.937.0 3.51 1.573 3.51 3.51v62.98c0 1.937-1.573 3.51-3.51 3.51h-42.98c-1.937.0-3.51-1.573-3.51-3.51v-62.98c0-1.937 1.573-3.51 3.51-3.51z" style="fill:#5d5c5c;stroke:none;stroke-width:1.69711;stroke-miterlimit:10" id="path136146"/><g id="g136154" style="stroke-width:1.69711"><g id="g136150" style="stroke-width:1.69711"><line x1="675" y1="270" x2="706.21899" y2="270" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#003f74" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136148"/></g><circle vector-effect="non-scaling-stroke" cx="670" cy="270" r="2" fill="#aeaeae" id="circle136152" style="stroke-width:2.40535"/></g><g id="g136164" style="stroke-width:1.69711"><g id="g136160" style="stroke-width:1.69711"><line x1="675" y1="260" x2="690" y2="260" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136156"/><line x1="695" y1="260" x2="706" y2="260" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136158"/></g><circle vector-effect="non-scaling-stroke" cx="670" cy="260" r="2" fill="#aeaeae" id="circle136162" style="stroke-width:2.40535"/></g><g id="g136174" style="stroke-width:1.69711"><g id="g136170" style="stroke-width:1.69711"><line x1="675" y1="250" x2="680" y2="250" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136166"/><line x1="684" y1="250" x2="705" y2="250" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#003f74" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136168"/></g><circle vector-effect="non-scaling-stroke" cx="670" cy="250" r="2" fill="#aeaeae" id="circle136172" style="stroke-width:2.40535"/></g><g id="g136184" style="stroke-width:1.69711"><g id="g136180" style="stroke-width:1.69711"><line x1="675" y1="240" x2="695" y2="240" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#003f74" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136176"/><line x1="699" y1="240" x2="706" y2="240" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136178"/></g><circle vector-effect="non-scaling-stroke" cx="670" cy="240" r="2" fill="#aeaeae" id="circle136182" style="stroke-width:2.40535"/></g><g id="g136192" style="stroke-width:1.69711"><g id="g136188" style="stroke-width:1.69711"><line x1="675" y1="230" x2="706.03101" y2="230" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136186"/></g><circle vector-effect="non-scaling-stroke" cx="670" cy="230" r="2" fill="#aeaeae" id="circle136190" style="stroke-width:2.40535"/></g><g id="g136200" style="stroke-width:1.69711"><g id="g136196" style="stroke-width:1.69711"><line x1="675" y1="220" x2="706" y2="220" vector-effect="non-scaling-stroke" stroke-width="3.39422" stroke="#a90911" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136194"/></g><circle vector-effect="non-scaling-stroke" cx="670" cy="220" r="2" fill="#aeaeae" id="circle136198" style="stroke-width:2.40535"/></g></g><line x1="685.5" y1="282" x2="685.5" y2="288" vector-effect="non-scaling-stroke" stroke-width="1.69711" stroke="#aeaeae" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136204"/><path d="m684.5 288.125c0-.552.448-1 1-1s1 .448 1 1-.448 1-1 1-1-.448-1-1z" fill="#aeaeae" stroke="none" id="path136206" style="stroke-width:2.40535"/><line x1="685.5" y1="312" x2="685.5" y2="338" vector-effect="non-scaling-stroke" stroke-width="1.69711" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="line136208"/><path d="m684.5 338.125c0-.552.448-1 1-1s1 .448 1 1-.448 1-1 1-1-.448-1-1z" fill="#6dcff6" stroke="none" id="path136210" style="stroke-width:2.40535"/><path d="m712 3e2h73v8" fill="none" vector-effect="non-scaling-stroke" stroke-width="1.69711" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="path136212"/><path d="m784 308.125c0-.552.448-1 1-1s1 .448 1 1-.448 1-1 1-1-.448-1-1z" fill="#6dcff6" stroke="none" id="path136214" style="stroke-width:2.40535"/><path d="m659 3e2h-75v8" fill="none" vector-effect="non-scaling-stroke" stroke-width="1.69711" stroke="#6dcff6" stroke-linejoin="round" stroke-linecap="round" stroke-miterlimit="3" id="path136216"/><path d="m583 308.125c0-.552.448-1 1-1s1 .448 1 1-.448 1-1 1-1-.448-1-1z" fill="#6dcff6" stroke="none" id="path136218" style="stroke-width:2.40535"/></g><g id="g40144" transform="translate(-1.3411901,31.036863)"><rect style="fill:#353333;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2" id="rect40138" width="75.000023" height="50" x="525" y="50" transform="matrix(0.26458333,0,0,0.26458333,13.229161,-7.5e-7)"/><g id="g101508-2" style="display:inline"><path style="fill:#ff8639;fill-opacity:1;stroke-width:14.8655" d="M22 11A2.0023 2.0023.0 0120 9V6A3.0033 3.0033.0 0017 3h-2a1 1 0 000 2h2a1.0009 1.0009.0 011 1V9a3.99 3.99.0 001.3574 3A3.99 3.99.0 0018 15v3a1.0009 1.0009.0 01-1 1h-2a1 1 0 000 2h2a3.0033 3.0033.0 003-3v-3a2.0023 2.0023.0 012-2 1 1 0 000-2z" transform="matrix(0.37970023,0,0,0.37970023,157.50088,15.287346)" id="path101504-2"/><path style="fill:#fdd418;fill-opacity:1;stroke-width:14.8655" d="M1 12a1 1 0 011-1A2.0023 2.0023.0 004 9V6A3.0033 3.0033.0 017 3H9A1 1 0 019 5H7A1.0009 1.0009.0 006 6V9A3.99 3.99.0 014.6426 12 3.99 3.99.0 016 15v3a1.0009 1.0009.0 001 1h2a1 1 0 010 2H7A3.0033 3.0033.0 014 18V15A2.0023 2.0023.0 002 13 1 1 0 011 12z" transform="matrix(0.37970023,0,0,0.37970023,157.50088,15.287346)" id="path101129-0"/></g><rect style="fill:#fdd418;fill-opacity:1;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2" id="rect40140" width="20.000021" height="49.999992" x="555" y="50" transform="scale(0.26458333)"/><rect style="fill:#ff8639;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2" id="rect40142" width="75" height="14.999999" x="575" y="99.999992" transform="scale(0.26458333)"/></g><g id="g40152" transform="translate(-1.3411901,62.108138)"><rect style="fill:#353333;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2" id="rect40146" width="75.000023" height="50" x="525" y="50" transform="matrix(0.26458333,0,0,0.26458333,13.229161,-7.5e-7)"/><g id="g101508-2-5" style="display:inline"><path style="fill:#00b8d4;fill-opacity:.98039216;stroke-width:14.8655" d="M22 11A2.0023 2.0023.0 0120 9V6A3.0033 3.0033.0 0017 3h-2a1 1 0 000 2h2a1.0009 1.0009.0 011 1V9a3.99 3.99.0 001.3574 3A3.99 3.99.0 0018 15v3a1.0009 1.0009.0 01-1 1h-2a1 1 0 000 2h2a3.0033 3.0033.0 003-3v-3a2.0023 2.0023.0 012-2 1 1 0 000-2z" transform="matrix(0.37970023,0,0,0.37970023,157.50088,15.287346)" id="path101504-2-5"/><path style="fill:#c364fc;fill-opacity:1;stroke-width:14.8655" d="M1 12a1 1 0 011-1A2.0023 2.0023.0 004 9V6A3.0033 3.0033.0 017 3H9A1 1 0 019 5H7A1.0009 1.0009.0 006 6V9A3.99 3.99.0 014.6426 12 3.99 3.99.0 016 15v3a1.0009 1.0009.0 001 1h2a1 1 0 010 2H7A3.0033 3.0033.0 014 18V15A2.0023 2.0023.0 002 13 1 1 0 011 12z" transform="matrix(0.37970023,0,0,0.37970023,157.50088,15.287346)" id="path101129-0-2"/></g><rect style="fill:#c364fc;fill-opacity:1;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2" id="rect40148" width="20.000021" height="49.999992" x="555" y="50" transform="scale(0.26458333)"/><rect style="fill:#00b7d4;fill-opacity:.980392;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2" id="rect40150" width="75" height="14.999999" x="575" y="99.999992" transform="scale(0.26458333)"/></g><g id="g48230" transform="matrix(0.09812392,0,0,0.09812392,183.01035,40.356805)" style="stroke-width:5.39287"><g id="g48048" style="display:inline;stroke-width:5.39287"><g id="g48046" style="fill:#353333;fill-opacity:1;stroke:url(#meshgradient129956);stroke-width:5.39284;stroke-dasharray:none;stroke-opacity:1"><circle cx="128" cy="128" fill="#382b73" transform="matrix(0.707,-0.707,0.707,0.707,-53.019,128)" id="ellipse48044" r="119.4" style="fill:#353333;fill-opacity:1;stroke:url(#meshgradient130409);stroke-width:5.39366;stroke-dasharray:none;stroke-opacity:1"/></g></g><g id="g48078" style="stroke-width:5.39287"><g id="g48052" style="stroke-width:5.39287"><path d="m183.399 185.561h-19.794v-19.795c0-1.381-1.119-2.5-2.5-2.5H141.31v-19.795c0-1.381-1.119-2.5-2.5-2.5h-19.795v-19.795c0-1.381-1.119-2.5-2.5-2.5H96.72V98.882c0-1.381-1.119-2.5-2.5-2.5H74.425V76.587c0-1.381-1.119-2.5-2.5-2.5H49.63c-1.381.0-2.5 1.119-2.5 2.5v133.769c0 1.381 1.119 2.5 2.5 2.5h133.769c1.381.0 2.5-1.119 2.5-2.5v-22.294c0-1.382-1.119-2.501-2.5-2.501zM69.425 207.855H52.13v-17.294h17.295zm0-22.294H52.13v-17.295h17.295zm0-22.295H52.13v-17.295h17.295zm0-22.295H52.13v-17.295h17.295zm0-22.295H52.13v-17.294h17.295zm0-22.294H52.13V79.087H69.425zM91.72 207.855H74.425V190.561H91.72zm0-22.294H74.425V168.266H91.72zm0-22.295H74.425V145.971H91.72zm0-22.295H74.425V123.676H91.72zm0-22.295H74.425V101.382H91.72zm22.295 89.179H96.72v-17.294h17.295zm0-22.294H96.72v-17.295h17.295zm0-22.295H96.72v-17.295h17.295zm0-22.295H96.72v-17.295h17.295zm22.295 66.884h-17.295v-17.294h17.295zm0-22.294h-17.295v-17.295h17.295zm0-22.295h-17.295v-17.295h17.295zm22.294 44.589H141.31v-17.294h17.295v17.294zm0-22.294H141.31v-17.295h17.295v17.295zm22.295 22.294h-17.294v-17.294h17.294z" fill="#291b4a" id="path48050" style="stroke-width:62.7565"/></g><g id="g48056" style="stroke-width:5.39287"><path d="M165.22 114.561H145.425V94.766c0-1.381-1.119-2.5-2.5-2.5h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h19.794v19.795c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm-24.795.0H123.131V97.266h17.294zm22.295 22.294H145.425V119.56h17.295z" fill="#291b4a" id="path48054" style="stroke-width:62.7565"/></g><g id="g48060" style="stroke-width:5.39287"><path d="m143.097 47.848h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V50.348c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H123.302V52.848h17.295z" fill="#291b4a" id="path48058" style="stroke-width:62.7565"/></g><g id="g48064" style="stroke-width:5.39287"><path d="M98.507 47.848H76.212c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V50.348c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H78.712V52.848h17.295z" fill="#291b4a" id="path48062" style="stroke-width:62.7565"/></g><g id="g48068" style="stroke-width:5.39287"><path d="m209.81 114.561h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.294H190.016V119.56h17.294z" fill="#291b4a" id="path48066" style="stroke-width:62.7565"/></g><g id="g48072" style="stroke-width:5.39287"><path d="m209.81 159.15h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V161.65c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.295H190.016V164.15h17.294z" fill="#291b4a" id="path48070" style="stroke-width:62.7565"/></g><g id="g48076" style="stroke-width:5.39287"><path d="M209.81 69.971H190.187V50.348c0-1.381-1.119-2.5-2.5-2.5h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h19.624v19.623c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V72.471c0-1.381-1.12-2.5-2.5-2.5zm-24.623.172H167.892V52.848h17.295zM207.31 92.266H190.016V74.971h17.294z" fill="#291b4a" id="path48074" style="stroke-width:62.7565"/></g></g><g id="g48228" style="stroke-width:5.39287"><g id="g48082" style="stroke-width:5.39287"><path d="M71.925 181.561H49.63c-1.381.0-2.5 1.119-2.5 2.5v22.294c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.294c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.294H52.13v-17.294h17.295z" fill="#f9b087" id="path48080" style="stroke-width:62.7565"/></g><g id="g48086" style="stroke-width:5.39287"><path d="M116.515 181.561H94.22c-1.381.0-2.5 1.119-2.5 2.5v22.294c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.294c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.294H96.72v-17.294h17.295z" fill="#f9b087" id="path48084" style="stroke-width:62.7565"/></g><g id="g48090" style="stroke-width:5.39287"><path d="M161.104 181.561H138.81c-1.381.0-2.5 1.119-2.5 2.5v22.294c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.294c-.001-1.381-1.12-2.5-2.501-2.5zm-2.5 22.294H141.31v-17.294h17.295v17.294z" fill="#f9b087" id="path48088" style="stroke-width:62.7565"/></g><g id="g48094" style="stroke-width:5.39287"><path d="M94.22 159.266H71.925c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5H94.22c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H74.425V164.266H91.72z" fill="#f9b087" id="path48092" style="stroke-width:62.7565"/></g><g id="g48098" style="stroke-width:5.39287"><path d="m138.81 159.266h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.295h-17.295v-17.295h17.295z" fill="#f9b087" id="path48096" style="stroke-width:62.7565"/></g><g id="g48102" style="stroke-width:5.39287"><path d="M71.925 136.971H49.63c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H52.13v-17.295h17.295z" fill="#f9b087" id="path48100" style="stroke-width:62.7565"/></g><g id="g48106" style="stroke-width:5.39287"><path d="M116.515 136.971H94.22c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H96.72v-17.295h17.295z" fill="#f9b087" id="path48104" style="stroke-width:62.7565"/></g><g id="g48110" style="stroke-width:5.39287"><path d="M94.22 114.676H71.925c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5H94.22c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H74.425V119.676H91.72z" fill="#f9b087" id="path48108" style="stroke-width:62.7565"/></g><g id="g48114" style="stroke-width:5.39287"><path d="M71.925 92.382H49.63c-1.381.0-2.5 1.119-2.5 2.5v22.294c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V94.882c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.294H52.13V97.382h17.295z" fill="#f9b087" id="path48112" style="stroke-width:62.7565"/></g><g fill="#ff8639" id="g48140" style="stroke-width:62.7565"><path d="M69.425 95.882H52.13c-.828.0-1.5.672-1.5 1.5v17.294c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5V97.382c0-.829-.671-1.5-1.5-1.5zm0 18.794H52.13V97.382h17.295z" id="path48116" style="stroke-width:5.39287"/><path d="M161.104 181.561H141.31v-19.795c0-1.381-1.119-2.5-2.5-2.5h-19.795v-19.795c0-1.381-1.119-2.5-2.5-2.5H96.72v-19.795c0-1.381-1.119-2.5-2.5-2.5H74.425V94.882c0-1.381-1.119-2.5-2.5-2.5H49.63c-1.381.0-2.5 1.119-2.5 2.5v22.294c0 1.381 1.119 2.5 2.5 2.5h19.795v17.295H49.63c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h19.795v17.295H49.63c-1.381.0-2.5 1.119-2.5 2.5v22.294c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V186.561H91.72v19.794c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-19.794h17.295v19.794c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.294c-.001-1.381-1.12-2.5-2.501-2.5zm1 24.794c0 .552-.449 1-1 1H138.81c-.551.0-1-.448-1-1v-19.794c0-.828-.672-1.5-1.5-1.5h-17.295c-.828.0-1.5.672-1.5 1.5v19.794c0 .552-.449 1-1 1H94.22c-.551.0-1-.448-1-1v-19.794c0-.828-.672-1.5-1.5-1.5H74.425c-.828.0-1.5.672-1.5 1.5v19.794c0 .552-.449 1-1 1H49.63c-.551.0-1-.448-1-1v-22.294c0-.552.449-1 1-1h19.795c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5H49.63c-.551.0-1-.448-1-1v-22.295c0-.552.449-1 1-1h19.795c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5H49.63c-.551.0-1-.448-1-1V94.882c0-.552.449-1 1-1h22.295c.551.0 1 .448 1 1v19.794c0 .828.672 1.5 1.5 1.5H94.22c.551.0 1 .448 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .448 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .448 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .448 1 1v22.294z" id="path48118" style="stroke-width:5.39287"/><path d="M69.425 140.471H52.13c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.671-1.5-1.5-1.5zm0 18.795H52.13v-17.295h17.295z" id="path48120" style="stroke-width:5.39287"/><path d="M69.425 185.061H52.13c-.828.0-1.5.672-1.5 1.5v17.294c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.294c0-.828-.671-1.5-1.5-1.5zm0 18.794H52.13v-17.294h17.295z" id="path48122" style="stroke-width:5.39287"/><path d="M114.015 162.766H96.72c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5zm0 18.795H96.72v-17.295h17.295z" id="path48124" style="stroke-width:5.39287"/><path d="M114.015 185.061H96.72c-.828.0-1.5.672-1.5 1.5v17.294c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.294c0-.828-.672-1.5-1.5-1.5zm0 18.794H96.72v-17.294h17.295z" id="path48126" style="stroke-width:5.39287"/><path d="M114.015 140.471H96.72c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5zm0 18.795H96.72v-17.295h17.295z" id="path48128" style="stroke-width:5.39287"/><path d="M91.72 140.471H74.425c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5H91.72c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5zm0 18.795H74.425V141.971H91.72z" id="path48130" style="stroke-width:5.39287"/><path d="M91.72 118.176H74.425c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5H91.72c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5zm0 18.795H74.425V119.676H91.72z" id="path48132" style="stroke-width:5.39287"/><path d="M91.72 162.766H74.425c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5H91.72c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5zm0 18.795H74.425V164.266H91.72z" id="path48134" style="stroke-width:5.39287"/><path d="m136.31 162.766h-17.295c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5zm0 18.795h-17.295v-17.295h17.295z" id="path48136" style="stroke-width:5.39287"/><path d="M158.604 185.061H141.31c-.828.0-1.5.672-1.5 1.5v17.294c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.294c-.001-.828-.672-1.5-1.501-1.5zm0 18.794H141.31v-17.294h17.295v17.294z" id="path48138" style="stroke-width:5.39287"/></g><g id="g48144" style="stroke-width:5.39287"><path d="m183.399 181.561h-19.794v-19.795c0-1.381-1.119-2.5-2.5-2.5H141.31v-19.795c0-1.381-1.119-2.5-2.5-2.5h-19.795v-19.795c0-1.381-1.119-2.5-2.5-2.5H96.72V94.882c0-1.381-1.119-2.5-2.5-2.5H74.425V72.587c0-1.381-1.119-2.5-2.5-2.5H49.63c-1.381.0-2.5 1.119-2.5 2.5v133.769c0 1.381 1.119 2.5 2.5 2.5h133.769c1.381.0 2.5-1.119 2.5-2.5v-22.294c0-1.382-1.119-2.501-2.5-2.501zm-2.5 22.294H52.13V75.087h17.295v19.795c0 1.381 1.119 2.5 2.5 2.5H91.72v19.794c0 1.381 1.119 2.5 2.5 2.5h19.795v19.795c0 1.381 1.119 2.5 2.5 2.5h19.795v19.795c0 1.381 1.119 2.5 2.5 2.5h19.795v19.795c0 1.381 1.119 2.5 2.5 2.5h19.794z" fill="#d3d3d3" id="path48142" style="stroke-width:62.7565"/></g><g id="g48152" style="stroke-width:5.39287"><g fill="#ebe7f2" id="g48150" style="stroke-width:62.7565"><path d="m183.399 181.561h-19.794v-19.795c0-1.381-1.119-2.5-2.5-2.5H141.31v-19.795c0-1.381-1.119-2.5-2.5-2.5h-19.795v-19.795c0-1.381-1.119-2.5-2.5-2.5H96.72V94.882c0-1.381-1.119-2.5-2.5-2.5H74.425V72.587c0-1.381-1.119-2.5-2.5-2.5H49.63c-1.381.0-2.5 1.119-2.5 2.5v133.769c0 1.381 1.119 2.5 2.5 2.5h133.769c1.381.0 2.5-1.119 2.5-2.5v-22.294c0-1.382-1.119-2.501-2.5-2.501zm1 24.794c0 .551-.449 1-1 1H49.63c-.551.0-1-.449-1-1V72.587c0-.551.449-1 1-1h22.295c.551.0 1 .449 1 1v19.795c0 .828.672 1.5 1.5 1.5H94.22c.551.0 1 .448 1 1v19.794c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .449 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .448 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .448 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.794c.551.0 1 .449 1 1z" id="path48146" style="stroke-width:5.39287"/><path d="m180.899 185.061h-19.794c-.551.0-1-.448-1-1v-19.795c0-.828-.672-1.5-1.5-1.5H138.81c-.551.0-1-.449-1-1v-19.795c0-.828-.672-1.5-1.5-1.5h-19.795c-.551.0-1-.448-1-1v-19.795c0-.828-.672-1.5-1.5-1.5H94.22c-.551.0-1-.448-1-1V97.382c0-.828-.672-1.5-1.5-1.5H71.925c-.551.0-1-.448-1-1V75.087c0-.828-.672-1.5-1.5-1.5H52.13c-.828.0-1.5.672-1.5 1.5v128.769c0 .828.672 1.5 1.5 1.5h128.769c.828.0 1.5-.672 1.5-1.5v-17.294c0-.829-.672-1.501-1.5-1.501zm0 18.794H52.13V75.087h17.295v19.795c0 1.381 1.119 2.5 2.5 2.5H91.72v19.794c0 1.381 1.119 2.5 2.5 2.5h19.795v19.795c0 1.381 1.119 2.5 2.5 2.5h19.795v19.795c0 1.381 1.119 2.5 2.5 2.5h19.795v19.795c0 1.381 1.119 2.5 2.5 2.5h19.794z" id="path48148" style="stroke-width:5.39287"/></g></g><g id="g48156" style="stroke-width:5.39287"><path d="m142.925 88.266h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V90.766c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H123.131V93.266h17.294z" fill="#65c1d6" id="path48154" style="stroke-width:62.7565"/></g><g id="g48160" style="stroke-width:5.39287"><path d="m143.097 43.848h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V46.348c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H123.302V48.848h17.295z" fill="#65c1d6" id="path48158" style="stroke-width:62.7565"/></g><g id="g48164" style="stroke-width:5.39287"><path d="M98.507 43.848H76.212c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V46.348c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H78.712V48.848h17.295z" fill="#65c1d6" id="path48162" style="stroke-width:62.7565"/></g><g id="g48168" style="stroke-width:5.39287"><path d="m165.22 110.561h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.294H145.425V115.56h17.295z" fill="#65c1d6" id="path48166" style="stroke-width:62.7565"/></g><g id="g48172" style="stroke-width:5.39287"><path d="m209.81 110.561h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.294H190.016V115.56h17.294z" fill="#65c1d6" id="path48170" style="stroke-width:62.7565"/></g><g id="g48176" style="stroke-width:5.39287"><path d="m209.81 155.15h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V157.65c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.295H190.016V160.15h17.294z" fill="#65c1d6" id="path48174" style="stroke-width:62.7565"/></g><g id="g48180" style="stroke-width:5.39287"><path d="m187.687 43.848h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V46.348c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.295H167.892V48.848h17.295z" fill="#65c1d6" id="path48178" style="stroke-width:62.7565"/></g><g id="g48184" style="stroke-width:5.39287"><path d="m209.81 65.971h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V68.471c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.295H190.016V70.971h17.294z" fill="#65c1d6" id="path48182" style="stroke-width:62.7565"/></g><g fill="#149cb2" id="g48226" style="fill:#149cb2;fill-opacity:1;stroke-width:62.7565"><g id="g48190" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"><path d="m143.097 43.848h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V46.348c0-1.381-1.119-2.5-2.5-2.5zm1 24.795c0 .552-.449 1-1 1h-22.295c-.551.0-1-.448-1-1V46.348c0-.552.449-1 1-1h22.295c.551.0 1 .448 1 1z" id="path48186" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/><path d="m140.597 47.348h-17.295c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5V48.848c0-.829-.671-1.5-1.5-1.5zm0 18.795H123.302V48.848h17.295z" id="path48188" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/></g><g id="g48196" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"><path d="M98.507 43.848H76.212c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V46.348c0-1.381-1.119-2.5-2.5-2.5zm1 24.795c0 .552-.449 1-1 1H76.212c-.551.0-1-.448-1-1V46.348c0-.552.449-1 1-1h22.295c.551.0 1 .448 1 1z" id="path48192" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/><path d="M96.007 47.348H78.712c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5V48.848c0-.829-.671-1.5-1.5-1.5zm0 18.795H78.712V48.848h17.295z" id="path48194" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/></g><g id="g48204" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"><path d="m140.425 91.766h-17.294c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.294c.828.0 1.5-.672 1.5-1.5V93.266c0-.829-.671-1.5-1.5-1.5zm0 18.795H123.131V93.266h17.294z" id="path48198" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/><path d="M165.22 110.561H145.425V90.766c0-1.381-1.119-2.5-2.5-2.5h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h19.794v19.795c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm1 24.794c0 .552-.449 1-1 1h-22.295c-.551.0-1-.448-1-1V115.56c0-.828-.672-1.5-1.5-1.5h-19.794c-.551.0-1-.448-1-1V90.766c0-.552.449-1 1-1h22.294c.551.0 1 .448 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .448 1 1z" id="path48200" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/><path d="m162.72 114.061h-17.295c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.295c0-.829-.671-1.5-1.5-1.5zm0 18.794H145.425V115.56h17.295z" id="path48202" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/></g><g id="g48210" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"><path d="m207.31 114.061h-17.294c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.294c.828.0 1.5-.672 1.5-1.5v-17.295c0-.829-.672-1.5-1.5-1.5zm0 18.794H190.016V115.56h17.294z" id="path48206" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/><path d="m209.81 110.561h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.12-2.5-2.5-2.5zm1 24.794c0 .552-.449 1-1 1h-22.294c-.551.0-1-.448-1-1V113.06c0-.552.449-1 1-1h22.294c.551.0 1 .448 1 1z" id="path48208" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/></g><g id="g48216" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"><path d="m207.31 158.65h-17.294c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.294c.828.0 1.5-.672 1.5-1.5V160.15c0-.828-.672-1.5-1.5-1.5zm0 18.795H190.016V160.15h17.294z" id="path48212" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/><path d="m209.81 155.15h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V157.65c0-1.381-1.12-2.5-2.5-2.5zm1 24.795c0 .552-.449 1-1 1h-22.294c-.551.0-1-.448-1-1V157.65c0-.552.449-1 1-1h22.294c.551.0 1 .448 1 1z" id="path48214" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/></g><g id="g48224" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"><path d="m185.187 47.348h-17.295c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5V48.848c0-.829-.672-1.5-1.5-1.5zm0 18.795H167.892V48.848h17.295z" id="path48218" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/><path d="m207.31 69.471h-17.294c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.294c.828.0 1.5-.672 1.5-1.5V70.971c0-.829-.672-1.5-1.5-1.5zm0 18.795H190.016V70.971h17.294z" id="path48220" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/><path d="M209.81 65.971H190.187V46.348c0-1.381-1.119-2.5-2.5-2.5h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h19.624v19.623c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V68.471c0-1.381-1.12-2.5-2.5-2.5zm1 24.795c0 .552-.449 1-1 1h-22.294c-.551.0-1-.448-1-1V71.143c0-.828-.672-1.5-1.5-1.5h-19.624c-.551.0-1-.448-1-1V46.348c0-.552.449-1 1-1h22.295c.551.0 1 .448 1 1v19.623c0 .828.672 1.5 1.5 1.5h19.623c.551.0 1 .448 1 1z" id="path48222" style="fill:#149cb2;fill-opacity:1;stroke-width:5.39287"/></g></g></g></g><g id="Array" transform="matrix(0.68332411,0,0,0.68332411,37.156478,35.059357)" style="stroke-width:4.13014"><path d="M29.99 4.42 24 1 18.01 4.42 24 7.85z" id="path50702" style="stroke-width:4.13014;fill:#5c92ea;fill-opacity:1"/><path d="m21 15.29 2 1.14V9.58L17 6.16v4.4l4 2.28z" id="path50704" style="stroke-width:4.13014;fill:#6f9fed;fill-opacity:1"/><path d="m25 16.43 2-1.14v-2.45l4-2.28v-4.4l-6 3.42z" id="path50706" style="stroke-width:4.13014;fill:#3679e5;fill-opacity:1"/><path d="M17.99 13.42 12 10 6.01 13.42 12 16.85z" id="path50708" style="stroke-width:4.13014;fill:#c364fc;fill-opacity:1"/><path d="M11 18.58 5 15.16V22l6 3.43z" id="path50710" style="stroke-width:4.13014;fill:#cd7efc;fill-opacity:1"/><path d="m19 15.16-6 3.42v6.85l2-1.14v-3.45l4-2.28z" id="path50712" style="stroke-width:4.13014;fill:#b540fb;fill-opacity:1"/><path d="M15 26.59 12 28.3 7.36 25.65 6.01 26.42 12 29.85l3-1.72z" id="path50714" style="stroke-width:4.13014;fill:#214478;fill-opacity:1"/><path d="m5 35 6 3.43V31.58L5 28.16z" id="path50716" style="stroke-width:4.13014;fill:#2c5a9f;fill-opacity:1"/><path d="m15 31.16v-.72l-2 1.14v6.85l2-1.14v-3.45l2.35-1.34z" id="path50718" style="stroke-width:4.13014;fill:#162d50;fill-opacity:1"/><path d="M29.99 21.42 24 18l-5.99 3.42L24 24.85z" id="path50720" style="stroke-width:4.13014;fill:#37abc8"/><path d="M23 26.58l-6-3.42V30l6 3.43z" id="path50722" style="stroke-width:4.13014;fill:#63bed4;fill-opacity:1"/><path d="m31 23.16-6 3.42v6.85L31 30z" id="path50724" style="stroke-width:4.13014;fill:#37abc8;fill-opacity:1"/><path d="M29.99 34.42 29 33.85 28.64 33.65 24 36.3l-4.64-2.65L19 33.85l-.99.57.99.57 5 2.86 5-2.86z" id="path50726" style="stroke-width:4.13014;fill:#800066;fill-opacity:1"/><path d="m17 43 6 3.43v-6.85l-6-3.42z" id="path50728" style="stroke-width:4.13014;fill:#ad008a;fill-opacity:1"/><path d="M25 46.43 31 43v-6.84l-6 3.42z" id="path50730" style="stroke-width:4.13014;fill:#590047;fill-opacity:1"/><path d="M36 16.85l5.99-3.43L36 10l-5.99 3.42z" id="path50732" style="stroke-width:4.13014;fill:#fdd418;fill-opacity:1"/><path d="m35 25.43v-6.85l-6-3.42v3.4l4 2.28v3.45z" id="path50734" style="stroke-width:4.13014;fill:#fdd933;fill-opacity:1"/><path d="m37 18.58v6.85L43 22v-6.84z" id="path50736" style="stroke-width:4.13014;fill:#e2ba02;fill-opacity:1"/><path d="M40.64 25.65 36 28.3l-3-1.71v1.54l3 1.72 5.99-3.43z" id="path50738" style="stroke-width:4.13014;fill:#00bf99;fill-opacity:1"/><path d="M33 31.16 30.65 32.5 33 33.84v3.45l2 1.14v-6.85l-2-1.14z" id="path50740" style="stroke-width:4.13014;fill:#00ddb1;fill-opacity:1"/><path d="M37 38.43 43 35v-6.84l-6 3.42z" id="path50742" style="stroke-width:4.13014;fill:#0a8;fill-opacity:1"/></g><path style="fill:none;fill-opacity:1;stroke:#d3d3d3;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m649.99997 74.999996h89.99999V149.2357" id="path131173" transform="scale(0.26458333)" sodipodi:nodetypes="ccc"/><path style="fill:none;fill-opacity:1;stroke:#ff8639;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m649.99997 199.99999h40" id="path131229" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#00b8d4;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:.98039216" d="m649.99997 314.99998h89.99999v-64.99999" id="path131231" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#fdd418;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m789.99996 189.99999h15V29.999998H199.99999v94.999992" id="path131541" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#c364fc;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m789.99996 199.99999h25V19.999999H189.99999V124.99999" id="path131543" transform="scale(0.26458333)" sodipodi:nodetypes="ccccc"/><path style="display:inline;fill:none;fill-opacity:1;stroke:#00b8d4;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:.980392" d="m789.99996 209.99999h15V374.99998H199.99999V259.99999" id="path131545" transform="scale(0.26458333)"/><path style="display:none;fill:none;stroke:#ea645c;stroke-width:5.39366" d="M28.17762 27.844689C53.75376 2.3530377 89.036546-13.405777 128-13.405777c39.57951.0 75.36104 16.2610798 101.02823 42.466888" transform="matrix(0.06937361,-0.06937361,0.06937361,0.06937361,177.80792,52.916667)" id="path133127"/><text transform="matrix(0.26458333,0,0,0.26458333,-8.8712915,3.4878636)" id="text144726" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:20px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-align:center;direction:ltr;white-space:pre;shape-inside:url(#rect144728);display:inline;fill:#6dcff6;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" x="59.859188" y="0"><tspan x="314.32617" y="252.2542" id="tspan166599">Computation of the next</tspan><tspan x="323.64746" y="277.2542" id="tspan166601">state without a lookup</tspan><tspan x="405.38086" y="302.2542" id="tspan166603">table</tspan></text><path style="fill:none;fill-opacity:1;stroke:#5c92ea;stroke-width:2.00000003;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot);marker-end:url(#TriangleStart)" d="m519.99997 74.999996h25" id="path145611" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#fdd418;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot);marker-end:url(#TriangleStart)" d="m519.99997 74.999996h25" id="path145955" transform="matrix(0.26458333,0,0,0.26458333,2.7374997e-6,31.749999)"/><path style="fill:none;fill-opacity:1;stroke:#c364fc;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;marker-start:url(#Dot);marker-end:url(#TriangleStart)" d="m519.99997 74.999996h25" id="path145977" transform="matrix(0.26458333,0,0,0.26458333,2.7374958e-6,62.177081)"/><g id="g163140"><rect style="fill:#353333;fill-opacity:1;stroke:#6dcff6;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" id="rect146355" width="99.999992" height="300" x="24.999998" y="49.999996" transform="scale(0.26458333)"/><g id="g48230-5" transform="matrix(0.05148792,0,0,0.05148792,13.254685,58.630087)" style="stroke-width:10.2775"><g id="g48048-4" style="display:inline;stroke-width:10.2775"><g id="g48046-4" style="fill:#353333;fill-opacity:1;stroke:url(#meshgradient129956-9);stroke-width:10.2775;stroke-dasharray:none;stroke-opacity:1"><circle cx="128" cy="128" fill="#382b73" transform="matrix(0.707,-0.707,0.707,0.707,-53.019,128)" id="ellipse48044-9" r="119.4" style="fill:#353333;fill-opacity:1;stroke:url(#meshgradient130409-4);stroke-width:10.2791;stroke-dasharray:none;stroke-opacity:1"/></g></g><g id="g48078-9" style="stroke-width:10.2775"><g id="g48052-3" style="stroke-width:10.2775"><path d="m183.399 185.561h-19.794v-19.795c0-1.381-1.119-2.5-2.5-2.5H141.31v-19.795c0-1.381-1.119-2.5-2.5-2.5h-19.795v-19.795c0-1.381-1.119-2.5-2.5-2.5H96.72V98.882c0-1.381-1.119-2.5-2.5-2.5H74.425V76.587c0-1.381-1.119-2.5-2.5-2.5H49.63c-1.381.0-2.5 1.119-2.5 2.5v133.769c0 1.381 1.119 2.5 2.5 2.5h133.769c1.381.0 2.5-1.119 2.5-2.5v-22.294c0-1.382-1.119-2.501-2.5-2.501zM69.425 207.855H52.13v-17.294h17.295zm0-22.294H52.13v-17.295h17.295zm0-22.295H52.13v-17.295h17.295zm0-22.295H52.13v-17.295h17.295zm0-22.295H52.13v-17.294h17.295zm0-22.294H52.13V79.087H69.425zM91.72 207.855H74.425V190.561H91.72zm0-22.294H74.425V168.266H91.72zm0-22.295H74.425V145.971H91.72zm0-22.295H74.425V123.676H91.72zm0-22.295H74.425V101.382H91.72zm22.295 89.179H96.72v-17.294h17.295zm0-22.294H96.72v-17.295h17.295zm0-22.295H96.72v-17.295h17.295zm0-22.295H96.72v-17.295h17.295zm22.295 66.884h-17.295v-17.294h17.295zm0-22.294h-17.295v-17.295h17.295zm0-22.295h-17.295v-17.295h17.295zm22.294 44.589H141.31v-17.294h17.295v17.294zm0-22.294H141.31v-17.295h17.295v17.295zm22.295 22.294h-17.294v-17.294h17.294z" fill="#291b4a" id="path48050-6" style="stroke-width:119.599"/></g><g id="g48056-0" style="stroke-width:10.2775"><path d="M165.22 114.561H145.425V94.766c0-1.381-1.119-2.5-2.5-2.5h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h19.794v19.795c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm-24.795.0H123.131V97.266h17.294zm22.295 22.294H145.425V119.56h17.295z" fill="#291b4a" id="path48054-5" style="stroke-width:119.599"/></g><g id="g48060-0" style="stroke-width:10.2775"><path d="m143.097 47.848h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V50.348c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H123.302V52.848h17.295z" fill="#291b4a" id="path48058-2" style="stroke-width:119.599"/></g><g id="g48064-9" style="stroke-width:10.2775"><path d="M98.507 47.848H76.212c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V50.348c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H78.712V52.848h17.295z" fill="#291b4a" id="path48062-4" style="stroke-width:119.599"/></g><g id="g48068-3" style="stroke-width:10.2775"><path d="m209.81 114.561h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.294H190.016V119.56h17.294z" fill="#291b4a" id="path48066-5" style="stroke-width:119.599"/></g><g id="g48072-1" style="stroke-width:10.2775"><path d="m209.81 159.15h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V161.65c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.295H190.016V164.15h17.294z" fill="#291b4a" id="path48070-7" style="stroke-width:119.599"/></g><g id="g48076-4" style="stroke-width:10.2775"><path d="M209.81 69.971H190.187V50.348c0-1.381-1.119-2.5-2.5-2.5h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h19.624v19.623c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V72.471c0-1.381-1.12-2.5-2.5-2.5zm-24.623.172H167.892V52.848h17.295zM207.31 92.266H190.016V74.971h17.294z" fill="#291b4a" id="path48074-3" style="stroke-width:119.599"/></g></g><g id="g48228-1" style="stroke-width:10.2775"><g id="g48082-4" style="stroke-width:10.2775"><path d="M71.925 181.561H49.63c-1.381.0-2.5 1.119-2.5 2.5v22.294c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.294c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.294H52.13v-17.294h17.295z" fill="#f9b087" id="path48080-6" style="stroke-width:119.599"/></g><g id="g48086-9" style="stroke-width:10.2775"><path d="M116.515 181.561H94.22c-1.381.0-2.5 1.119-2.5 2.5v22.294c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.294c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.294H96.72v-17.294h17.295z" fill="#f9b087" id="path48084-4" style="stroke-width:119.599"/></g><g id="g48090-2" style="stroke-width:10.2775"><path d="M161.104 181.561H138.81c-1.381.0-2.5 1.119-2.5 2.5v22.294c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.294c-.001-1.381-1.12-2.5-2.501-2.5zm-2.5 22.294H141.31v-17.294h17.295v17.294z" fill="#f9b087" id="path48088-2" style="stroke-width:119.599"/></g><g id="g48094-6" style="stroke-width:10.2775"><path d="M94.22 159.266H71.925c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5H94.22c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H74.425V164.266H91.72z" fill="#f9b087" id="path48092-4" style="stroke-width:119.599"/></g><g id="g48098-1" style="stroke-width:10.2775"><path d="m138.81 159.266h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.295h-17.295v-17.295h17.295z" fill="#f9b087" id="path48096-2" style="stroke-width:119.599"/></g><g id="g48102-8" style="stroke-width:10.2775"><path d="M71.925 136.971H49.63c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H52.13v-17.295h17.295z" fill="#f9b087" id="path48100-8" style="stroke-width:119.599"/></g><g id="g48106-9" style="stroke-width:10.2775"><path d="M116.515 136.971H94.22c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H96.72v-17.295h17.295z" fill="#f9b087" id="path48104-2" style="stroke-width:119.599"/></g><g id="g48110-8" style="stroke-width:10.2775"><path d="M94.22 114.676H71.925c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5H94.22c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H74.425V119.676H91.72z" fill="#f9b087" id="path48108-8" style="stroke-width:119.599"/></g><g id="g48114-8" style="stroke-width:10.2775"><path d="M71.925 92.382H49.63c-1.381.0-2.5 1.119-2.5 2.5v22.294c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V94.882c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.294H52.13V97.382h17.295z" fill="#f9b087" id="path48112-6" style="stroke-width:119.599"/></g><g fill="#ff8639" id="g48140-8" style="stroke-width:119.599"><path d="M69.425 95.882H52.13c-.828.0-1.5.672-1.5 1.5v17.294c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5V97.382c0-.829-.671-1.5-1.5-1.5zm0 18.794H52.13V97.382h17.295z" id="path48116-3" style="stroke-width:10.2775"/><path d="M161.104 181.561H141.31v-19.795c0-1.381-1.119-2.5-2.5-2.5h-19.795v-19.795c0-1.381-1.119-2.5-2.5-2.5H96.72v-19.795c0-1.381-1.119-2.5-2.5-2.5H74.425V94.882c0-1.381-1.119-2.5-2.5-2.5H49.63c-1.381.0-2.5 1.119-2.5 2.5v22.294c0 1.381 1.119 2.5 2.5 2.5h19.795v17.295H49.63c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h19.795v17.295H49.63c-1.381.0-2.5 1.119-2.5 2.5v22.294c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V186.561H91.72v19.794c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-19.794h17.295v19.794c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.294c-.001-1.381-1.12-2.5-2.501-2.5zm1 24.794c0 .552-.449 1-1 1H138.81c-.551.0-1-.448-1-1v-19.794c0-.828-.672-1.5-1.5-1.5h-17.295c-.828.0-1.5.672-1.5 1.5v19.794c0 .552-.449 1-1 1H94.22c-.551.0-1-.448-1-1v-19.794c0-.828-.672-1.5-1.5-1.5H74.425c-.828.0-1.5.672-1.5 1.5v19.794c0 .552-.449 1-1 1H49.63c-.551.0-1-.448-1-1v-22.294c0-.552.449-1 1-1h19.795c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5H49.63c-.551.0-1-.448-1-1v-22.295c0-.552.449-1 1-1h19.795c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5H49.63c-.551.0-1-.448-1-1V94.882c0-.552.449-1 1-1h22.295c.551.0 1 .448 1 1v19.794c0 .828.672 1.5 1.5 1.5H94.22c.551.0 1 .448 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .448 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .448 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .448 1 1v22.294z" id="path48118-8" style="stroke-width:10.2775"/><path d="M69.425 140.471H52.13c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.671-1.5-1.5-1.5zm0 18.795H52.13v-17.295h17.295z" id="path48120-3" style="stroke-width:10.2775"/><path d="M69.425 185.061H52.13c-.828.0-1.5.672-1.5 1.5v17.294c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.294c0-.828-.671-1.5-1.5-1.5zm0 18.794H52.13v-17.294h17.295z" id="path48122-3" style="stroke-width:10.2775"/><path d="M114.015 162.766H96.72c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5zm0 18.795H96.72v-17.295h17.295z" id="path48124-3" style="stroke-width:10.2775"/><path d="M114.015 185.061H96.72c-.828.0-1.5.672-1.5 1.5v17.294c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.294c0-.828-.672-1.5-1.5-1.5zm0 18.794H96.72v-17.294h17.295z" id="path48126-8" style="stroke-width:10.2775"/><path d="M114.015 140.471H96.72c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5zm0 18.795H96.72v-17.295h17.295z" id="path48128-0" style="stroke-width:10.2775"/><path d="M91.72 140.471H74.425c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5H91.72c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5zm0 18.795H74.425V141.971H91.72z" id="path48130-4" style="stroke-width:10.2775"/><path d="M91.72 118.176H74.425c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5H91.72c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5zm0 18.795H74.425V119.676H91.72z" id="path48132-7" style="stroke-width:10.2775"/><path d="M91.72 162.766H74.425c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5H91.72c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5zm0 18.795H74.425V164.266H91.72z" id="path48134-6" style="stroke-width:10.2775"/><path d="m136.31 162.766h-17.295c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.295c0-.828-.672-1.5-1.5-1.5zm0 18.795h-17.295v-17.295h17.295z" id="path48136-8" style="stroke-width:10.2775"/><path d="M158.604 185.061H141.31c-.828.0-1.5.672-1.5 1.5v17.294c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.294c-.001-.828-.672-1.5-1.501-1.5zm0 18.794H141.31v-17.294h17.295v17.294z" id="path48138-9" style="stroke-width:10.2775"/></g><g id="g48144-0" style="stroke-width:10.2775"><path d="m183.399 181.561h-19.794v-19.795c0-1.381-1.119-2.5-2.5-2.5H141.31v-19.795c0-1.381-1.119-2.5-2.5-2.5h-19.795v-19.795c0-1.381-1.119-2.5-2.5-2.5H96.72V94.882c0-1.381-1.119-2.5-2.5-2.5H74.425V72.587c0-1.381-1.119-2.5-2.5-2.5H49.63c-1.381.0-2.5 1.119-2.5 2.5v133.769c0 1.381 1.119 2.5 2.5 2.5h133.769c1.381.0 2.5-1.119 2.5-2.5v-22.294c0-1.382-1.119-2.501-2.5-2.501zm-2.5 22.294H52.13V75.087h17.295v19.795c0 1.381 1.119 2.5 2.5 2.5H91.72v19.794c0 1.381 1.119 2.5 2.5 2.5h19.795v19.795c0 1.381 1.119 2.5 2.5 2.5h19.795v19.795c0 1.381 1.119 2.5 2.5 2.5h19.795v19.795c0 1.381 1.119 2.5 2.5 2.5h19.794z" fill="#d3d3d3" id="path48142-6" style="stroke-width:119.599"/></g><g id="g48152-8" style="stroke-width:10.2775"><g fill="#ebe7f2" id="g48150-7" style="stroke-width:119.599"><path d="m183.399 181.561h-19.794v-19.795c0-1.381-1.119-2.5-2.5-2.5H141.31v-19.795c0-1.381-1.119-2.5-2.5-2.5h-19.795v-19.795c0-1.381-1.119-2.5-2.5-2.5H96.72V94.882c0-1.381-1.119-2.5-2.5-2.5H74.425V72.587c0-1.381-1.119-2.5-2.5-2.5H49.63c-1.381.0-2.5 1.119-2.5 2.5v133.769c0 1.381 1.119 2.5 2.5 2.5h133.769c1.381.0 2.5-1.119 2.5-2.5v-22.294c0-1.382-1.119-2.501-2.5-2.501zm1 24.794c0 .551-.449 1-1 1H49.63c-.551.0-1-.449-1-1V72.587c0-.551.449-1 1-1h22.295c.551.0 1 .449 1 1v19.795c0 .828.672 1.5 1.5 1.5H94.22c.551.0 1 .448 1 1v19.794c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .449 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .448 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .448 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.794c.551.0 1 .449 1 1z" id="path48146-9" style="stroke-width:10.2775"/><path d="m180.899 185.061h-19.794c-.551.0-1-.448-1-1v-19.795c0-.828-.672-1.5-1.5-1.5H138.81c-.551.0-1-.449-1-1v-19.795c0-.828-.672-1.5-1.5-1.5h-19.795c-.551.0-1-.448-1-1v-19.795c0-.828-.672-1.5-1.5-1.5H94.22c-.551.0-1-.448-1-1V97.382c0-.828-.672-1.5-1.5-1.5H71.925c-.551.0-1-.448-1-1V75.087c0-.828-.672-1.5-1.5-1.5H52.13c-.828.0-1.5.672-1.5 1.5v128.769c0 .828.672 1.5 1.5 1.5h128.769c.828.0 1.5-.672 1.5-1.5v-17.294c0-.829-.672-1.501-1.5-1.501zm0 18.794H52.13V75.087h17.295v19.795c0 1.381 1.119 2.5 2.5 2.5H91.72v19.794c0 1.381 1.119 2.5 2.5 2.5h19.795v19.795c0 1.381 1.119 2.5 2.5 2.5h19.795v19.795c0 1.381 1.119 2.5 2.5 2.5h19.795v19.795c0 1.381 1.119 2.5 2.5 2.5h19.794z" id="path48148-0" style="stroke-width:10.2775"/></g></g><g id="g48156-3" style="stroke-width:10.2775"><path d="m142.925 88.266h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V90.766c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H123.131V93.266h17.294z" fill="#65c1d6" id="path48154-3" style="stroke-width:119.599"/></g><g id="g48160-3" style="stroke-width:10.2775"><path d="m143.097 43.848h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V46.348c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H123.302V48.848h17.295z" fill="#65c1d6" id="path48158-7" style="stroke-width:119.599"/></g><g id="g48164-3" style="stroke-width:10.2775"><path d="M98.507 43.848H76.212c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V46.348c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.295H78.712V48.848h17.295z" fill="#65c1d6" id="path48162-2" style="stroke-width:119.599"/></g><g id="g48168-6" style="stroke-width:10.2775"><path d="m165.22 110.561h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm-2.5 22.294H145.425V115.56h17.295z" fill="#65c1d6" id="path48166-5" style="stroke-width:119.599"/></g><g id="g48172-2" style="stroke-width:10.2775"><path d="m209.81 110.561h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.294H190.016V115.56h17.294z" fill="#65c1d6" id="path48170-6" style="stroke-width:119.599"/></g><g id="g48176-5" style="stroke-width:10.2775"><path d="m209.81 155.15h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V157.65c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.295H190.016V160.15h17.294z" fill="#65c1d6" id="path48174-8" style="stroke-width:119.599"/></g><g id="g48180-7" style="stroke-width:10.2775"><path d="m187.687 43.848h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V46.348c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.295H167.892V48.848h17.295z" fill="#65c1d6" id="path48178-9" style="stroke-width:119.599"/></g><g id="g48184-6" style="stroke-width:10.2775"><path d="m209.81 65.971h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V68.471c0-1.381-1.12-2.5-2.5-2.5zm-2.5 22.295H190.016V70.971h17.294z" fill="#65c1d6" id="path48182-0" style="stroke-width:119.599"/></g><g fill="#149cb2" id="g48226-4" style="fill:#149cb2;fill-opacity:1;stroke-width:119.599"><g id="g48190-1" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"><path d="m143.097 43.848h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V46.348c0-1.381-1.119-2.5-2.5-2.5zm1 24.795c0 .552-.449 1-1 1h-22.295c-.551.0-1-.448-1-1V46.348c0-.552.449-1 1-1h22.295c.551.0 1 .448 1 1z" id="path48186-0" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/><path d="m140.597 47.348h-17.295c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5V48.848c0-.829-.671-1.5-1.5-1.5zm0 18.795H123.302V48.848h17.295z" id="path48188-4" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/></g><g id="g48196-8" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"><path d="M98.507 43.848H76.212c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5V46.348c0-1.381-1.119-2.5-2.5-2.5zm1 24.795c0 .552-.449 1-1 1H76.212c-.551.0-1-.448-1-1V46.348c0-.552.449-1 1-1h22.295c.551.0 1 .448 1 1z" id="path48192-7" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/><path d="M96.007 47.348H78.712c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5V48.848c0-.829-.671-1.5-1.5-1.5zm0 18.795H78.712V48.848h17.295z" id="path48194-0" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/></g><g id="g48204-8" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"><path d="m140.425 91.766h-17.294c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.294c.828.0 1.5-.672 1.5-1.5V93.266c0-.829-.671-1.5-1.5-1.5zm0 18.795H123.131V93.266h17.294z" id="path48198-6" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/><path d="M165.22 110.561H145.425V90.766c0-1.381-1.119-2.5-2.5-2.5h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h19.794v19.795c0 1.381 1.119 2.5 2.5 2.5h22.295c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.119-2.5-2.5-2.5zm1 24.794c0 .552-.449 1-1 1h-22.295c-.551.0-1-.448-1-1V115.56c0-.828-.672-1.5-1.5-1.5h-19.794c-.551.0-1-.448-1-1V90.766c0-.552.449-1 1-1h22.294c.551.0 1 .448 1 1v19.795c0 .828.672 1.5 1.5 1.5h19.795c.551.0 1 .448 1 1z" id="path48200-2" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/><path d="m162.72 114.061h-17.295c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5v-17.295c0-.829-.671-1.5-1.5-1.5zm0 18.794H145.425V115.56h17.295z" id="path48202-4" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/></g><g id="g48210-7" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"><path d="m207.31 114.061h-17.294c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.294c.828.0 1.5-.672 1.5-1.5v-17.295c0-.829-.672-1.5-1.5-1.5zm0 18.794H190.016V115.56h17.294z" id="path48206-9" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/><path d="m209.81 110.561h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5v-22.295c0-1.381-1.12-2.5-2.5-2.5zm1 24.794c0 .552-.449 1-1 1h-22.294c-.551.0-1-.448-1-1V113.06c0-.552.449-1 1-1h22.294c.551.0 1 .448 1 1z" id="path48208-3" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/></g><g id="g48216-9" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"><path d="m207.31 158.65h-17.294c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.294c.828.0 1.5-.672 1.5-1.5V160.15c0-.828-.672-1.5-1.5-1.5zm0 18.795H190.016V160.15h17.294z" id="path48212-2" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/><path d="m209.81 155.15h-22.294c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V157.65c0-1.381-1.12-2.5-2.5-2.5zm1 24.795c0 .552-.449 1-1 1h-22.294c-.551.0-1-.448-1-1V157.65c0-.552.449-1 1-1h22.294c.551.0 1 .448 1 1z" id="path48214-8" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/></g><g id="g48224-3" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"><path d="m185.187 47.348h-17.295c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.295c.828.0 1.5-.672 1.5-1.5V48.848c0-.829-.672-1.5-1.5-1.5zm0 18.795H167.892V48.848h17.295z" id="path48218-0" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/><path d="m207.31 69.471h-17.294c-.828.0-1.5.672-1.5 1.5v17.295c0 .828.672 1.5 1.5 1.5h17.294c.828.0 1.5-.672 1.5-1.5V70.971c0-.829-.672-1.5-1.5-1.5zm0 18.795H190.016V70.971h17.294z" id="path48220-1" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/><path d="M209.81 65.971H190.187V46.348c0-1.381-1.119-2.5-2.5-2.5h-22.295c-1.381.0-2.5 1.119-2.5 2.5v22.295c0 1.381 1.119 2.5 2.5 2.5h19.624v19.623c0 1.381 1.119 2.5 2.5 2.5h22.294c1.381.0 2.5-1.119 2.5-2.5V68.471c0-1.381-1.12-2.5-2.5-2.5zm1 24.795c0 .552-.449 1-1 1h-22.294c-.551.0-1-.448-1-1V71.143c0-.828-.672-1.5-1.5-1.5h-19.624c-.551.0-1-.448-1-1V46.348c0-.552.449-1 1-1h22.295c.551.0 1 .448 1 1v19.623c0 .828.672 1.5 1.5 1.5h19.623c.551.0 1 .448 1 1z" id="path48222-7" style="fill:#149cb2;fill-opacity:1;stroke-width:10.2775"/></g></g></g></g></g><script id="mesh_polyfill" type="text/javascript">!function(){const t="http://www.w3.org/2000/svg",e="http://www.w3.org/1999/xlink",s="http://www.w3.org/1999/xhtml",r=2;if(document.createElementNS(t,"meshgradient").x)return;const n=(t,e,s,r)=>{let n=new x(.5*(e.x+s.x),.5*(e.y+s.y)),o=new x(.5*(t.x+e.x),.5*(t.y+e.y)),i=new x(.5*(s.x+r.x),.5*(s.y+r.y)),a=new x(.5*(n.x+o.x),.5*(n.y+o.y)),h=new x(.5*(n.x+i.x),.5*(n.y+i.y)),l=new x(.5*(a.x+h.x),.5*(a.y+h.y));return[[t,o,a,l],[l,h,i,r]]},o=t=>{let e=t[0].distSquared(t[1]),s=t[2].distSquared(t[3]),r=.25*t[0].distSquared(t[2]),n=.25*t[1].distSquared(t[3]),o=e>s?e:s,i=r>n?r:n;return 18*(o>i?o:i)},i=(t,e)=>Math.sqrt(t.distSquared(e)),a=(t,e)=>t.scale(2/3).add(e.scale(1/3)),h=t=>{let e,s,r,n,o,i,a,h=new g;return t.match(/(\w+\(\s*[^)]+\))+/g).forEach(t=>{let l=t.match(/[\w.-]+/g),d=l.shift();switch(d){case"translate":2===l.length?e=new g(1,0,0,1,l[0],l[1]):(console.error("mesh.js: translate does not have 2 arguments!"),e=new g(1,0,0,1,0,0)),h=h.append(e);break;case"scale":1===l.length?s=new g(l[0],0,0,l[0],0,0):2===l.length?s=new g(l[0],0,0,l[1],0,0):(console.error("mesh.js: scale does not have 1 or 2 arguments!"),s=new g(1,0,0,1,0,0)),h=h.append(s);break;case"rotate":if(3===l.length&amp;&amp;(e=new g(1,0,0,1,l[1],l[2]),h=h.append(e)),l[0]){r=l[0]*Math.PI/180;let t=Math.cos(r),e=Math.sin(r);Math.abs(t)&lt;1e-16&amp;&amp;(t=0),Math.abs(e)&lt;1e-16&amp;&amp;(e=0),a=new g(t,e,-e,t,0,0),h=h.append(a)}else console.error("math.js: No argument to rotate transform!");3===l.length&amp;&amp;(e=new g(1,0,0,1,-l[1],-l[2]),h=h.append(e));break;case"skewX":l[0]?(r=l[0]*Math.PI/180,n=Math.tan(r),o=new g(1,0,n,1,0,0),h=h.append(o)):console.error("math.js: No argument to skewX transform!");break;case"skewY":l[0]?(r=l[0]*Math.PI/180,n=Math.tan(r),i=new g(1,n,0,1,0,0),h=h.append(i)):console.error("math.js: No argument to skewY transform!");break;case"matrix":6===l.length?h=h.append(new g(...l)):console.error("math.js: Incorrect number of arguments for matrix!");break;default:console.error("mesh.js: Unhandled transform type: "+d)}}),h},l=t=>{let e=[],s=t.split(/[ ,]+/);for(let t=0,r=s.length-1;t&lt;r;t+=2)e.push(new x(parseFloat(s[t]),parseFloat(s[t+1])));return e},d=(t,e)=>{for(let s in e)t.setAttribute(s,e[s])},c=(t,e,s,r,n)=>{let o,i,a=[0,0,0,0];for(let h=0;h&lt;3;++h)e[h]&lt;t[h]&amp;&amp;e[h]&lt;s[h]||t[h]&lt;e[h]&amp;&amp;s[h]&lt;e[h]?a[h]=0:(a[h]=.5*((e[h]-t[h])/r+(s[h]-e[h])/n),o=Math.abs(3*(e[h]-t[h])/r),i=Math.abs(3*(s[h]-e[h])/n),a[h]>o?a[h]=o:a[h]>i&amp;&amp;(a[h]=i));return a},u=[[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],[-3,3,0,0,-2,-1,0,0,0,0,0,0,0,0,0,0],[2,-2,0,0,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0,-3,3,0,0,-2,-1,0,0],[0,0,0,0,0,0,0,0,2,-2,0,0,1,1,0,0],[-3,0,3,0,0,0,0,0,-2,0,-1,0,0,0,0,0],[0,0,0,0,-3,0,3,0,0,0,0,0,-2,0,-1,0],[9,-9,-9,9,6,3,-6,-3,6,-6,3,-3,4,2,2,1],[-6,6,6,-6,-3,-3,3,3,-4,4,-2,2,-2,-2,-1,-1],[2,0,-2,0,0,0,0,0,1,0,1,0,0,0,0,0],[0,0,0,0,2,0,-2,0,0,0,0,0,1,0,1,0],[-6,6,6,-6,-4,-2,4,2,-3,3,-3,3,-2,-1,-2,-1],[4,-4,-4,4,2,2,-2,-2,2,-2,2,-2,1,1,1,1]],f=t=>{let e=[];for(let s=0;s&lt;16;++s){e[s]=0;for(let r=0;r&lt;16;++r)e[s]+=u[s][r]*t[r]}return e},p=(t,e,s)=>{const r=e*e,n=s*s,o=e*e*e,i=s*s*s;return t[0]+t[1]*e+t[2]*r+t[3]*o+t[4]*s+t[5]*s*e+t[6]*s*r+t[7]*s*o+t[8]*n+t[9]*n*e+t[10]*n*r+t[11]*n*o+t[12]*i+t[13]*i*e+t[14]*i*r+t[15]*i*o},y=t=>{let e=[],s=[],r=[];for(let s=0;s&lt;4;++s)e[s]=[],e[s][0]=n(t[0][s],t[1][s],t[2][s],t[3][s]),e[s][1]=[],e[s][1].push(...n(...e[s][0][0])),e[s][1].push(...n(...e[s][0][1])),e[s][2]=[],e[s][2].push(...n(...e[s][1][0])),e[s][2].push(...n(...e[s][1][1])),e[s][2].push(...n(...e[s][1][2])),e[s][2].push(...n(...e[s][1][3]));for(let t=0;t&lt;8;++t){s[t]=[];for(let r=0;r&lt;4;++r)s[t][r]=[],s[t][r][0]=n(e[0][2][t][r],e[1][2][t][r],e[2][2][t][r],e[3][2][t][r]),s[t][r][1]=[],s[t][r][1].push(...n(...s[t][r][0][0])),s[t][r][1].push(...n(...s[t][r][0][1])),s[t][r][2]=[],s[t][r][2].push(...n(...s[t][r][1][0])),s[t][r][2].push(...n(...s[t][r][1][1])),s[t][r][2].push(...n(...s[t][r][1][2])),s[t][r][2].push(...n(...s[t][r][1][3]))}for(let t=0;t&lt;8;++t){r[t]=[];for(let e=0;e&lt;8;++e)r[t][e]=[],r[t][e][0]=s[t][0][2][e],r[t][e][1]=s[t][1][2][e],r[t][e][2]=s[t][2][2][e],r[t][e][3]=s[t][3][2][e]}return r};class x{constructor(t,e){this.x=t||0,this.y=e||0}toString(){return`(x=${this.x}, y=${this.y})`}clone(){return new x(this.x,this.y)}add(t){return new x(this.x+t.x,this.y+t.y)}scale(t){return void 0===t.x?new x(this.x*t,this.y*t):new x(this.x*t.x,this.y*t.y)}distSquared(t){let e=this.x-t.x,s=this.y-t.y;return e*e+s*s}transform(t){let e=this.x*t.a+this.y*t.c+t.e,s=this.x*t.b+this.y*t.d+t.f;return new x(e,s)}}class g{constructor(t,e,s,r,n,o){void 0===t?(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0):(this.a=t,this.b=e,this.c=s,this.d=r,this.e=n,this.f=o)}toString(){return`affine: ${this.a} ${this.c} ${this.e} \n ${this.b} ${this.d} ${this.f}`}append(t){t instanceof g||console.error("mesh.js: argument to Affine.append is not affine!");let e=this.a*t.a+this.c*t.b,s=this.b*t.a+this.d*t.b,r=this.a*t.c+this.c*t.d,n=this.b*t.c+this.d*t.d,o=this.a*t.e+this.c*t.f+this.e,i=this.b*t.e+this.d*t.f+this.f;return new g(e,s,r,n,o,i)}}class w{constructor(t,e){this.nodes=t,this.colors=e}paintCurve(t,e){if(o(this.nodes)>r){const s=n(...this.nodes);let r=[[],[]],o=[[],[]];for(let t=0;t&lt;4;++t)r[0][t]=this.colors[0][t],r[1][t]=(this.colors[0][t]+this.colors[1][t])/2,o[0][t]=r[1][t],o[1][t]=this.colors[1][t];let i=new w(s[0],r),a=new w(s[1],o);i.paintCurve(t,e),a.paintCurve(t,e)}else{let s=Math.round(this.nodes[0].x);if(s>=0&amp;&amp;s&lt;e){let r=4*(~~this.nodes[0].y*e+s);t[r]=Math.round(this.colors[0][0]),t[r+1]=Math.round(this.colors[0][1]),t[r+2]=Math.round(this.colors[0][2]),t[r+3]=Math.round(this.colors[0][3])}}}}class m{constructor(t,e){this.nodes=t,this.colors=e}split(){let t=[[],[],[],[]],e=[[],[],[],[]],s=[[[],[]],[[],[]]],r=[[[],[]],[[],[]]];for(let s=0;s&lt;4;++s){const r=n(this.nodes[0][s],this.nodes[1][s],this.nodes[2][s],this.nodes[3][s]);t[0][s]=r[0][0],t[1][s]=r[0][1],t[2][s]=r[0][2],t[3][s]=r[0][3],e[0][s]=r[1][0],e[1][s]=r[1][1],e[2][s]=r[1][2],e[3][s]=r[1][3]}for(let t=0;t&lt;4;++t)s[0][0][t]=this.colors[0][0][t],s[0][1][t]=this.colors[0][1][t],s[1][0][t]=(this.colors[0][0][t]+this.colors[1][0][t])/2,s[1][1][t]=(this.colors[0][1][t]+this.colors[1][1][t])/2,r[0][0][t]=s[1][0][t],r[0][1][t]=s[1][1][t],r[1][0][t]=this.colors[1][0][t],r[1][1][t]=this.colors[1][1][t];return[new m(t,s),new m(e,r)]}paint(t,e){let s,n=!1;for(let t=0;t&lt;4;++t)if((s=o([this.nodes[0][t],this.nodes[1][t],this.nodes[2][t],this.nodes[3][t]]))>r){n=!0;break}if(n){let s=this.split();s[0].paint(t,e),s[1].paint(t,e)}else{new w([...this.nodes[0]],[...this.colors[0]]).paintCurve(t,e)}}}class b{constructor(t){this.readMesh(t),this.type=t.getAttribute("type")||"bilinear"}readMesh(t){let e=[[]],s=[[]],r=Number(t.getAttribute("x")),n=Number(t.getAttribute("y"));e[0][0]=new x(r,n);let o=t.children;for(let t=0,r=o.length;t&lt;r;++t){e[3*t+1]=[],e[3*t+2]=[],e[3*t+3]=[],s[t+1]=[];let r=o[t].children;for(let n=0,o=r.length;n&lt;o;++n){let o=r[n].children;for(let r=0,i=o.length;r&lt;i;++r){let i=r;0!==t&amp;&amp;++i;let h,d=o[r].getAttribute("path"),c="l";null!=d&amp;&amp;(c=(h=d.match(/\s*([lLcC])\s*(.*)/))[1]);let u=l(h[2]);switch(c){case"l":0===i?(e[3*t][3*n+3]=u[0].add(e[3*t][3*n]),e[3*t][3*n+1]=a(e[3*t][3*n],e[3*t][3*n+3]),e[3*t][3*n+2]=a(e[3*t][3*n+3],e[3*t][3*n])):1===i?(e[3*t+3][3*n+3]=u[0].add(e[3*t][3*n+3]),e[3*t+1][3*n+3]=a(e[3*t][3*n+3],e[3*t+3][3*n+3]),e[3*t+2][3*n+3]=a(e[3*t+3][3*n+3],e[3*t][3*n+3])):2===i?(0===n&amp;&amp;(e[3*t+3][3*n+0]=u[0].add(e[3*t+3][3*n+3])),e[3*t+3][3*n+1]=a(e[3*t+3][3*n],e[3*t+3][3*n+3]),e[3*t+3][3*n+2]=a(e[3*t+3][3*n+3],e[3*t+3][3*n])):(e[3*t+1][3*n]=a(e[3*t][3*n],e[3*t+3][3*n]),e[3*t+2][3*n]=a(e[3*t+3][3*n],e[3*t][3*n]));break;case"L":0===i?(e[3*t][3*n+3]=u[0],e[3*t][3*n+1]=a(e[3*t][3*n],e[3*t][3*n+3]),e[3*t][3*n+2]=a(e[3*t][3*n+3],e[3*t][3*n])):1===i?(e[3*t+3][3*n+3]=u[0],e[3*t+1][3*n+3]=a(e[3*t][3*n+3],e[3*t+3][3*n+3]),e[3*t+2][3*n+3]=a(e[3*t+3][3*n+3],e[3*t][3*n+3])):2===i?(0===n&amp;&amp;(e[3*t+3][3*n+0]=u[0]),e[3*t+3][3*n+1]=a(e[3*t+3][3*n],e[3*t+3][3*n+3]),e[3*t+3][3*n+2]=a(e[3*t+3][3*n+3],e[3*t+3][3*n])):(e[3*t+1][3*n]=a(e[3*t][3*n],e[3*t+3][3*n]),e[3*t+2][3*n]=a(e[3*t+3][3*n],e[3*t][3*n]));break;case"c":0===i?(e[3*t][3*n+1]=u[0].add(e[3*t][3*n]),e[3*t][3*n+2]=u[1].add(e[3*t][3*n]),e[3*t][3*n+3]=u[2].add(e[3*t][3*n])):1===i?(e[3*t+1][3*n+3]=u[0].add(e[3*t][3*n+3]),e[3*t+2][3*n+3]=u[1].add(e[3*t][3*n+3]),e[3*t+3][3*n+3]=u[2].add(e[3*t][3*n+3])):2===i?(e[3*t+3][3*n+2]=u[0].add(e[3*t+3][3*n+3]),e[3*t+3][3*n+1]=u[1].add(e[3*t+3][3*n+3]),0===n&amp;&amp;(e[3*t+3][3*n+0]=u[2].add(e[3*t+3][3*n+3]))):(e[3*t+2][3*n]=u[0].add(e[3*t+3][3*n]),e[3*t+1][3*n]=u[1].add(e[3*t+3][3*n]));break;case"C":0===i?(e[3*t][3*n+1]=u[0],e[3*t][3*n+2]=u[1],e[3*t][3*n+3]=u[2]):1===i?(e[3*t+1][3*n+3]=u[0],e[3*t+2][3*n+3]=u[1],e[3*t+3][3*n+3]=u[2]):2===i?(e[3*t+3][3*n+2]=u[0],e[3*t+3][3*n+1]=u[1],0===n&amp;&amp;(e[3*t+3][3*n+0]=u[2])):(e[3*t+2][3*n]=u[0],e[3*t+1][3*n]=u[1]);break;default:console.error("mesh.js: "+c+" invalid path type.")}if(0===t&amp;&amp;0===n||r>0){let e=window.getComputedStyle(o[r]).stopColor.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i),a=window.getComputedStyle(o[r]).stopOpacity,h=255;a&amp;&amp;(h=Math.floor(255*a)),e&amp;&amp;(0===i?(s[t][n]=[],s[t][n][0]=Math.floor(e[1]),s[t][n][1]=Math.floor(e[2]),s[t][n][2]=Math.floor(e[3]),s[t][n][3]=h):1===i?(s[t][n+1]=[],s[t][n+1][0]=Math.floor(e[1]),s[t][n+1][1]=Math.floor(e[2]),s[t][n+1][2]=Math.floor(e[3]),s[t][n+1][3]=h):2===i?(s[t+1][n+1]=[],s[t+1][n+1][0]=Math.floor(e[1]),s[t+1][n+1][1]=Math.floor(e[2]),s[t+1][n+1][2]=Math.floor(e[3]),s[t+1][n+1][3]=h):3===i&amp;&amp;(s[t+1][n]=[],s[t+1][n][0]=Math.floor(e[1]),s[t+1][n][1]=Math.floor(e[2]),s[t+1][n][2]=Math.floor(e[3]),s[t+1][n][3]=h))}}e[3*t+1][3*n+1]=new x,e[3*t+1][3*n+2]=new x,e[3*t+2][3*n+1]=new x,e[3*t+2][3*n+2]=new x,e[3*t+1][3*n+1].x=(-4*e[3*t][3*n].x+6*(e[3*t][3*n+1].x+e[3*t+1][3*n].x)+-2*(e[3*t][3*n+3].x+e[3*t+3][3*n].x)+3*(e[3*t+3][3*n+1].x+e[3*t+1][3*n+3].x)+-1*e[3*t+3][3*n+3].x)/9,e[3*t+1][3*n+2].x=(-4*e[3*t][3*n+3].x+6*(e[3*t][3*n+2].x+e[3*t+1][3*n+3].x)+-2*(e[3*t][3*n].x+e[3*t+3][3*n+3].x)+3*(e[3*t+3][3*n+2].x+e[3*t+1][3*n].x)+-1*e[3*t+3][3*n].x)/9,e[3*t+2][3*n+1].x=(-4*e[3*t+3][3*n].x+6*(e[3*t+3][3*n+1].x+e[3*t+2][3*n].x)+-2*(e[3*t+3][3*n+3].x+e[3*t][3*n].x)+3*(e[3*t][3*n+1].x+e[3*t+2][3*n+3].x)+-1*e[3*t][3*n+3].x)/9,e[3*t+2][3*n+2].x=(-4*e[3*t+3][3*n+3].x+6*(e[3*t+3][3*n+2].x+e[3*t+2][3*n+3].x)+-2*(e[3*t+3][3*n].x+e[3*t][3*n+3].x)+3*(e[3*t][3*n+2].x+e[3*t+2][3*n].x)+-1*e[3*t][3*n].x)/9,e[3*t+1][3*n+1].y=(-4*e[3*t][3*n].y+6*(e[3*t][3*n+1].y+e[3*t+1][3*n].y)+-2*(e[3*t][3*n+3].y+e[3*t+3][3*n].y)+3*(e[3*t+3][3*n+1].y+e[3*t+1][3*n+3].y)+-1*e[3*t+3][3*n+3].y)/9,e[3*t+1][3*n+2].y=(-4*e[3*t][3*n+3].y+6*(e[3*t][3*n+2].y+e[3*t+1][3*n+3].y)+-2*(e[3*t][3*n].y+e[3*t+3][3*n+3].y)+3*(e[3*t+3][3*n+2].y+e[3*t+1][3*n].y)+-1*e[3*t+3][3*n].y)/9,e[3*t+2][3*n+1].y=(-4*e[3*t+3][3*n].y+6*(e[3*t+3][3*n+1].y+e[3*t+2][3*n].y)+-2*(e[3*t+3][3*n+3].y+e[3*t][3*n].y)+3*(e[3*t][3*n+1].y+e[3*t+2][3*n+3].y)+-1*e[3*t][3*n+3].y)/9,e[3*t+2][3*n+2].y=(-4*e[3*t+3][3*n+3].y+6*(e[3*t+3][3*n+2].y+e[3*t+2][3*n+3].y)+-2*(e[3*t+3][3*n].y+e[3*t][3*n+3].y)+3*(e[3*t][3*n+2].y+e[3*t+2][3*n].y)+-1*e[3*t][3*n].y)/9}}this.nodes=e,this.colors=s}paintMesh(t,e){let s=(this.nodes.length-1)/3,r=(this.nodes[0].length-1)/3;if("bilinear"===this.type||s&lt;2||r&lt;2){let n;for(let o=0;o&lt;s;++o)for(let s=0;s&lt;r;++s){let r=[];for(let t=3*o,e=3*o+4;t&lt;e;++t)r.push(this.nodes[t].slice(3*s,3*s+4));let i=[];i.push(this.colors[o].slice(s,s+2)),i.push(this.colors[o+1].slice(s,s+2)),(n=new m(r,i)).paint(t,e)}}else{let n,o,a,h,l,d,u;const x=s,g=r;s++,r++;let w=new Array(s);for(let t=0;t&lt;s;++t){w[t]=new Array(r);for(let e=0;e&lt;r;++e)w[t][e]=[],w[t][e][0]=this.nodes[3*t][3*e],w[t][e][1]=this.colors[t][e]}for(let t=0;t&lt;s;++t)for(let e=0;e&lt;r;++e)0!==t&amp;&amp;t!==x&amp;&amp;(n=i(w[t-1][e][0],w[t][e][0]),o=i(w[t+1][e][0],w[t][e][0]),w[t][e][2]=c(w[t-1][e][1],w[t][e][1],w[t+1][e][1],n,o)),0!==e&amp;&amp;e!==g&amp;&amp;(n=i(w[t][e-1][0],w[t][e][0]),o=i(w[t][e+1][0],w[t][e][0]),w[t][e][3]=c(w[t][e-1][1],w[t][e][1],w[t][e+1][1],n,o));for(let t=0;t&lt;r;++t){w[0][t][2]=[],w[x][t][2]=[];for(let e=0;e&lt;4;++e)n=i(w[1][t][0],w[0][t][0]),o=i(w[x][t][0],w[x-1][t][0]),w[0][t][2][e]=n>0?2*(w[1][t][1][e]-w[0][t][1][e])/n-w[1][t][2][e]:0,w[x][t][2][e]=o>0?2*(w[x][t][1][e]-w[x-1][t][1][e])/o-w[x-1][t][2][e]:0}for(let t=0;t&lt;s;++t){w[t][0][3]=[],w[t][g][3]=[];for(let e=0;e&lt;4;++e)n=i(w[t][1][0],w[t][0][0]),o=i(w[t][g][0],w[t][g-1][0]),w[t][0][3][e]=n>0?2*(w[t][1][1][e]-w[t][0][1][e])/n-w[t][1][3][e]:0,w[t][g][3][e]=o>0?2*(w[t][g][1][e]-w[t][g-1][1][e])/o-w[t][g-1][3][e]:0}for(let s=0;s&lt;x;++s)for(let r=0;r&lt;g;++r){let n=i(w[s][r][0],w[s+1][r][0]),o=i(w[s][r+1][0],w[s+1][r+1][0]),c=i(w[s][r][0],w[s][r+1][0]),x=i(w[s+1][r][0],w[s+1][r+1][0]),g=[[],[],[],[]];for(let t=0;t&lt;4;++t){(d=[])[0]=w[s][r][1][t],d[1]=w[s+1][r][1][t],d[2]=w[s][r+1][1][t],d[3]=w[s+1][r+1][1][t],d[4]=w[s][r][2][t]*n,d[5]=w[s+1][r][2][t]*n,d[6]=w[s][r+1][2][t]*o,d[7]=w[s+1][r+1][2][t]*o,d[8]=w[s][r][3][t]*c,d[9]=w[s+1][r][3][t]*x,d[10]=w[s][r+1][3][t]*c,d[11]=w[s+1][r+1][3][t]*x,d[12]=0,d[13]=0,d[14]=0,d[15]=0,u=f(d);for(let e=0;e&lt;9;++e){g[t][e]=[];for(let s=0;s&lt;9;++s)g[t][e][s]=p(u,e/8,s/8),g[t][e][s]>255?g[t][e][s]=255:g[t][e][s]&lt;0&amp;&amp;(g[t][e][s]=0)}}h=[];for(let t=3*s,e=3*s+4;t&lt;e;++t)h.push(this.nodes[t].slice(3*r,3*r+4));l=y(h);for(let s=0;s&lt;8;++s)for(let r=0;r&lt;8;++r)(a=new m(l[s][r],[[[g[0][s][r],g[1][s][r],g[2][s][r],g[3][s][r]],[g[0][s][r+1],g[1][s][r+1],g[2][s][r+1],g[3][s][r+1]]],[[g[0][s+1][r],g[1][s+1][r],g[2][s+1][r],g[3][s+1][r]],[g[0][s+1][r+1],g[1][s+1][r+1],g[2][s+1][r+1],g[3][s+1][r+1]]]])).paint(t,e)}}}transform(t){if(t instanceof x)for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].add(t);else if(t instanceof g)for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].transform(t)}scale(t){for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].scale(t)}}document.querySelectorAll("rect,circle,ellipse,path,text").forEach((r,n)=>{let o=r.getAttribute("id");o||(o="patchjs_shape"+n,r.setAttribute("id",o));const i=r.style.fill.match(/^url\(\s*"?\s*#([^\s"]+)"?\s*\)/),a=r.style.stroke.match(/^url\(\s*"?\s*#([^\s"]+)"?\s*\)/);if(i&amp;&amp;i[1]){const a=document.getElementById(i[1]);if(a&amp;&amp;"meshgradient"===a.nodeName){const i=r.getBBox();let l=document.createElementNS(s,"canvas");d(l,{width:i.width,height:i.height});const c=l.getContext("2d");let u=c.createImageData(i.width,i.height);const f=new b(a);"objectBoundingBox"===a.getAttribute("gradientUnits")&amp;&amp;f.scale(new x(i.width,i.height));const p=a.getAttribute("gradientTransform");null!=p&amp;&amp;f.transform(h(p)),"userSpaceOnUse"===a.getAttribute("gradientUnits")&amp;&amp;f.transform(new x(-i.x,-i.y)),f.paintMesh(u.data,l.width),c.putImageData(u,0,0);const y=document.createElementNS(t,"image");d(y,{width:i.width,height:i.height,x:i.x,y:i.y});let g=l.toDataURL();y.setAttributeNS(e,"xlink:href",g),r.parentNode.insertBefore(y,r),r.style.fill="none";const w=document.createElementNS(t,"use");w.setAttributeNS(e,"xlink:href","#"+o);const m="patchjs_clip"+n,M=document.createElementNS(t,"clipPath");M.setAttribute("id",m),M.appendChild(w),r.parentElement.insertBefore(M,r),y.setAttribute("clip-path","url(#"+m+")"),u=null,l=null,g=null}}if(a&amp;&amp;a[1]){const o=document.getElementById(a[1]);if(o&amp;&amp;"meshgradient"===o.nodeName){const i=parseFloat(r.style.strokeWidth.slice(0,-2))*(parseFloat(r.style.strokeMiterlimit)||parseFloat(r.getAttribute("stroke-miterlimit"))||1),a=r.getBBox(),l=Math.trunc(a.width+i),c=Math.trunc(a.height+i),u=Math.trunc(a.x-i/2),f=Math.trunc(a.y-i/2);let p=document.createElementNS(s,"canvas");d(p,{width:l,height:c});const y=p.getContext("2d");let g=y.createImageData(l,c);const w=new b(o);"objectBoundingBox"===o.getAttribute("gradientUnits")&amp;&amp;w.scale(new x(l,c));const m=o.getAttribute("gradientTransform");null!=m&amp;&amp;w.transform(h(m)),"userSpaceOnUse"===o.getAttribute("gradientUnits")&amp;&amp;w.transform(new x(-u,-f)),w.paintMesh(g.data,p.width),y.putImageData(g,0,0);const M=document.createElementNS(t,"image");d(M,{width:l,height:c,x:0,y:0});let S=p.toDataURL();M.setAttributeNS(e,"xlink:href",S);const k="pattern_clip"+n,A=document.createElementNS(t,"pattern");d(A,{id:k,patternUnits:"userSpaceOnUse",width:l,height:c,x:u,y:f}),A.appendChild(M),o.parentNode.appendChild(A),r.style.stroke="url(#"+k+")",g=null,p=null,S=null}}})}();</script><text transform="matrix(0.26458333,0,0,0.26458333,-17.323345,-14.512747)" id="text104317" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:22.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect104319);display:inline;fill:#353333;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:miter;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="76.048828" y="90.556738" id="tspan166605">Entry Block</tspan></text><path style="fill:none;fill-opacity:1;stroke:#3679e5;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m224.99999 144.99999h45" id="path160000" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#e2ba02;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m259.99999 189.99999h10" id="path160002" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#590047;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m224.99999 244.99999h45" id="path160004" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#b540fb;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m249.99999 159.99999h20" id="path161080" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#37abc8;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m254.99999 229.99999h15" id="path161082" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#162d50;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m259.99999 209.99999h10" id="path161869" transform="scale(0.26458333)"/><text transform="matrix(0.26458333,0,0,0.26458333,0.41599452,-0.67652257)" id="text163260" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:20px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-align:center;direction:ltr;white-space:pre;shape-inside:url(#rect163262);fill:#6dcff6;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1"><tspan x="41.982422" y="142.2542" id="tspan166607">Initial</tspan><tspan x="46.728516" y="167.2542" id="tspan166609">State</tspan></text><circle style="fill:#ff8639;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" id="path163639" cx="72.5" cy="187.49998" r="7.4999995" transform="matrix(0.26458333,0,0,0.26458333,0.66145758,1.9843771)"/><circle style="fill:#fdd418;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" id="circle163641" cx="72.5" cy="187.49998" r="7.4999995" transform="matrix(0.26458333,0,0,0.26458333,0.66145758,30.427084)"/><path style="fill:none;fill-opacity:1;stroke:#ff8639;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m74.999996 204.99999v15" id="path165773" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#fdd418;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m74.999996 204.99999v15" id="path166099" transform="matrix(0.26458333,0,0,0.26458333,3.0833295e-7,18.520833)"/><path style="fill:none;fill-opacity:1;stroke:#fdd418;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" d="m74.999996 302.49998h84.869524l-.0379-42.94367" id="path166155" transform="matrix(0.26458333,0,0,0.26458333,3.1826183,0)" sodipodi:nodetypes="ccc"/></g><script id="script166611" type="text/javascript">!function(){const t="http://www.w3.org/2000/svg",e="http://www.w3.org/1999/xlink",s="http://www.w3.org/1999/xhtml",r=2;if(document.createElementNS(t,"meshgradient").x)return;const n=(t,e,s,r)=>{let n=new x(.5*(e.x+s.x),.5*(e.y+s.y)),o=new x(.5*(t.x+e.x),.5*(t.y+e.y)),i=new x(.5*(s.x+r.x),.5*(s.y+r.y)),a=new x(.5*(n.x+o.x),.5*(n.y+o.y)),h=new x(.5*(n.x+i.x),.5*(n.y+i.y)),l=new x(.5*(a.x+h.x),.5*(a.y+h.y));return[[t,o,a,l],[l,h,i,r]]},o=t=>{let e=t[0].distSquared(t[1]),s=t[2].distSquared(t[3]),r=.25*t[0].distSquared(t[2]),n=.25*t[1].distSquared(t[3]),o=e>s?e:s,i=r>n?r:n;return 18*(o>i?o:i)},i=(t,e)=>Math.sqrt(t.distSquared(e)),a=(t,e)=>t.scale(2/3).add(e.scale(1/3)),h=t=>{let e,s,r,n,o,i,a,h=new g;return t.match(/(\w+\(\s*[^)]+\))+/g).forEach(t=>{let l=t.match(/[\w.-]+/g),d=l.shift();switch(d){case"translate":2===l.length?e=new g(1,0,0,1,l[0],l[1]):(console.error("mesh.js: translate does not have 2 arguments!"),e=new g(1,0,0,1,0,0)),h=h.append(e);break;case"scale":1===l.length?s=new g(l[0],0,0,l[0],0,0):2===l.length?s=new g(l[0],0,0,l[1],0,0):(console.error("mesh.js: scale does not have 1 or 2 arguments!"),s=new g(1,0,0,1,0,0)),h=h.append(s);break;case"rotate":if(3===l.length&amp;&amp;(e=new g(1,0,0,1,l[1],l[2]),h=h.append(e)),l[0]){r=l[0]*Math.PI/180;let t=Math.cos(r),e=Math.sin(r);Math.abs(t)&lt;1e-16&amp;&amp;(t=0),Math.abs(e)&lt;1e-16&amp;&amp;(e=0),a=new g(t,e,-e,t,0,0),h=h.append(a)}else console.error("math.js: No argument to rotate transform!");3===l.length&amp;&amp;(e=new g(1,0,0,1,-l[1],-l[2]),h=h.append(e));break;case"skewX":l[0]?(r=l[0]*Math.PI/180,n=Math.tan(r),o=new g(1,0,n,1,0,0),h=h.append(o)):console.error("math.js: No argument to skewX transform!");break;case"skewY":l[0]?(r=l[0]*Math.PI/180,n=Math.tan(r),i=new g(1,n,0,1,0,0),h=h.append(i)):console.error("math.js: No argument to skewY transform!");break;case"matrix":6===l.length?h=h.append(new g(...l)):console.error("math.js: Incorrect number of arguments for matrix!");break;default:console.error("mesh.js: Unhandled transform type: "+d)}}),h},l=t=>{let e=[],s=t.split(/[ ,]+/);for(let t=0,r=s.length-1;t&lt;r;t+=2)e.push(new x(parseFloat(s[t]),parseFloat(s[t+1])));return e},d=(t,e)=>{for(let s in e)t.setAttribute(s,e[s])},c=(t,e,s,r,n)=>{let o,i,a=[0,0,0,0];for(let h=0;h&lt;3;++h)e[h]&lt;t[h]&amp;&amp;e[h]&lt;s[h]||t[h]&lt;e[h]&amp;&amp;s[h]&lt;e[h]?a[h]=0:(a[h]=.5*((e[h]-t[h])/r+(s[h]-e[h])/n),o=Math.abs(3*(e[h]-t[h])/r),i=Math.abs(3*(s[h]-e[h])/n),a[h]>o?a[h]=o:a[h]>i&amp;&amp;(a[h]=i));return a},u=[[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],[-3,3,0,0,-2,-1,0,0,0,0,0,0,0,0,0,0],[2,-2,0,0,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0,-3,3,0,0,-2,-1,0,0],[0,0,0,0,0,0,0,0,2,-2,0,0,1,1,0,0],[-3,0,3,0,0,0,0,0,-2,0,-1,0,0,0,0,0],[0,0,0,0,-3,0,3,0,0,0,0,0,-2,0,-1,0],[9,-9,-9,9,6,3,-6,-3,6,-6,3,-3,4,2,2,1],[-6,6,6,-6,-3,-3,3,3,-4,4,-2,2,-2,-2,-1,-1],[2,0,-2,0,0,0,0,0,1,0,1,0,0,0,0,0],[0,0,0,0,2,0,-2,0,0,0,0,0,1,0,1,0],[-6,6,6,-6,-4,-2,4,2,-3,3,-3,3,-2,-1,-2,-1],[4,-4,-4,4,2,2,-2,-2,2,-2,2,-2,1,1,1,1]],f=t=>{let e=[];for(let s=0;s&lt;16;++s){e[s]=0;for(let r=0;r&lt;16;++r)e[s]+=u[s][r]*t[r]}return e},p=(t,e,s)=>{const r=e*e,n=s*s,o=e*e*e,i=s*s*s;return t[0]+t[1]*e+t[2]*r+t[3]*o+t[4]*s+t[5]*s*e+t[6]*s*r+t[7]*s*o+t[8]*n+t[9]*n*e+t[10]*n*r+t[11]*n*o+t[12]*i+t[13]*i*e+t[14]*i*r+t[15]*i*o},y=t=>{let e=[],s=[],r=[];for(let s=0;s&lt;4;++s)e[s]=[],e[s][0]=n(t[0][s],t[1][s],t[2][s],t[3][s]),e[s][1]=[],e[s][1].push(...n(...e[s][0][0])),e[s][1].push(...n(...e[s][0][1])),e[s][2]=[],e[s][2].push(...n(...e[s][1][0])),e[s][2].push(...n(...e[s][1][1])),e[s][2].push(...n(...e[s][1][2])),e[s][2].push(...n(...e[s][1][3]));for(let t=0;t&lt;8;++t){s[t]=[];for(let r=0;r&lt;4;++r)s[t][r]=[],s[t][r][0]=n(e[0][2][t][r],e[1][2][t][r],e[2][2][t][r],e[3][2][t][r]),s[t][r][1]=[],s[t][r][1].push(...n(...s[t][r][0][0])),s[t][r][1].push(...n(...s[t][r][0][1])),s[t][r][2]=[],s[t][r][2].push(...n(...s[t][r][1][0])),s[t][r][2].push(...n(...s[t][r][1][1])),s[t][r][2].push(...n(...s[t][r][1][2])),s[t][r][2].push(...n(...s[t][r][1][3]))}for(let t=0;t&lt;8;++t){r[t]=[];for(let e=0;e&lt;8;++e)r[t][e]=[],r[t][e][0]=s[t][0][2][e],r[t][e][1]=s[t][1][2][e],r[t][e][2]=s[t][2][2][e],r[t][e][3]=s[t][3][2][e]}return r};class x{constructor(t,e){this.x=t||0,this.y=e||0}toString(){return`(x=${this.x}, y=${this.y})`}clone(){return new x(this.x,this.y)}add(t){return new x(this.x+t.x,this.y+t.y)}scale(t){return void 0===t.x?new x(this.x*t,this.y*t):new x(this.x*t.x,this.y*t.y)}distSquared(t){let e=this.x-t.x,s=this.y-t.y;return e*e+s*s}transform(t){let e=this.x*t.a+this.y*t.c+t.e,s=this.x*t.b+this.y*t.d+t.f;return new x(e,s)}}class g{constructor(t,e,s,r,n,o){void 0===t?(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0):(this.a=t,this.b=e,this.c=s,this.d=r,this.e=n,this.f=o)}toString(){return`affine: ${this.a} ${this.c} ${this.e} \n ${this.b} ${this.d} ${this.f}`}append(t){t instanceof g||console.error("mesh.js: argument to Affine.append is not affine!");let e=this.a*t.a+this.c*t.b,s=this.b*t.a+this.d*t.b,r=this.a*t.c+this.c*t.d,n=this.b*t.c+this.d*t.d,o=this.a*t.e+this.c*t.f+this.e,i=this.b*t.e+this.d*t.f+this.f;return new g(e,s,r,n,o,i)}}class w{constructor(t,e){this.nodes=t,this.colors=e}paintCurve(t,e){if(o(this.nodes)>r){const s=n(...this.nodes);let r=[[],[]],o=[[],[]];for(let t=0;t&lt;4;++t)r[0][t]=this.colors[0][t],r[1][t]=(this.colors[0][t]+this.colors[1][t])/2,o[0][t]=r[1][t],o[1][t]=this.colors[1][t];let i=new w(s[0],r),a=new w(s[1],o);i.paintCurve(t,e),a.paintCurve(t,e)}else{let s=Math.round(this.nodes[0].x);if(s>=0&amp;&amp;s&lt;e){let r=4*(~~this.nodes[0].y*e+s);t[r]=Math.round(this.colors[0][0]),t[r+1]=Math.round(this.colors[0][1]),t[r+2]=Math.round(this.colors[0][2]),t[r+3]=Math.round(this.colors[0][3])}}}}class m{constructor(t,e){this.nodes=t,this.colors=e}split(){let t=[[],[],[],[]],e=[[],[],[],[]],s=[[[],[]],[[],[]]],r=[[[],[]],[[],[]]];for(let s=0;s&lt;4;++s){const r=n(this.nodes[0][s],this.nodes[1][s],this.nodes[2][s],this.nodes[3][s]);t[0][s]=r[0][0],t[1][s]=r[0][1],t[2][s]=r[0][2],t[3][s]=r[0][3],e[0][s]=r[1][0],e[1][s]=r[1][1],e[2][s]=r[1][2],e[3][s]=r[1][3]}for(let t=0;t&lt;4;++t)s[0][0][t]=this.colors[0][0][t],s[0][1][t]=this.colors[0][1][t],s[1][0][t]=(this.colors[0][0][t]+this.colors[1][0][t])/2,s[1][1][t]=(this.colors[0][1][t]+this.colors[1][1][t])/2,r[0][0][t]=s[1][0][t],r[0][1][t]=s[1][1][t],r[1][0][t]=this.colors[1][0][t],r[1][1][t]=this.colors[1][1][t];return[new m(t,s),new m(e,r)]}paint(t,e){let s,n=!1;for(let t=0;t&lt;4;++t)if((s=o([this.nodes[0][t],this.nodes[1][t],this.nodes[2][t],this.nodes[3][t]]))>r){n=!0;break}if(n){let s=this.split();s[0].paint(t,e),s[1].paint(t,e)}else{new w([...this.nodes[0]],[...this.colors[0]]).paintCurve(t,e)}}}class b{constructor(t){this.readMesh(t),this.type=t.getAttribute("type")||"bilinear"}readMesh(t){let e=[[]],s=[[]],r=Number(t.getAttribute("x")),n=Number(t.getAttribute("y"));e[0][0]=new x(r,n);let o=t.children;for(let t=0,r=o.length;t&lt;r;++t){e[3*t+1]=[],e[3*t+2]=[],e[3*t+3]=[],s[t+1]=[];let r=o[t].children;for(let n=0,o=r.length;n&lt;o;++n){let o=r[n].children;for(let r=0,i=o.length;r&lt;i;++r){let i=r;0!==t&amp;&amp;++i;let h,d=o[r].getAttribute("path"),c="l";null!=d&amp;&amp;(c=(h=d.match(/\s*([lLcC])\s*(.*)/))[1]);let u=l(h[2]);switch(c){case"l":0===i?(e[3*t][3*n+3]=u[0].add(e[3*t][3*n]),e[3*t][3*n+1]=a(e[3*t][3*n],e[3*t][3*n+3]),e[3*t][3*n+2]=a(e[3*t][3*n+3],e[3*t][3*n])):1===i?(e[3*t+3][3*n+3]=u[0].add(e[3*t][3*n+3]),e[3*t+1][3*n+3]=a(e[3*t][3*n+3],e[3*t+3][3*n+3]),e[3*t+2][3*n+3]=a(e[3*t+3][3*n+3],e[3*t][3*n+3])):2===i?(0===n&amp;&amp;(e[3*t+3][3*n+0]=u[0].add(e[3*t+3][3*n+3])),e[3*t+3][3*n+1]=a(e[3*t+3][3*n],e[3*t+3][3*n+3]),e[3*t+3][3*n+2]=a(e[3*t+3][3*n+3],e[3*t+3][3*n])):(e[3*t+1][3*n]=a(e[3*t][3*n],e[3*t+3][3*n]),e[3*t+2][3*n]=a(e[3*t+3][3*n],e[3*t][3*n]));break;case"L":0===i?(e[3*t][3*n+3]=u[0],e[3*t][3*n+1]=a(e[3*t][3*n],e[3*t][3*n+3]),e[3*t][3*n+2]=a(e[3*t][3*n+3],e[3*t][3*n])):1===i?(e[3*t+3][3*n+3]=u[0],e[3*t+1][3*n+3]=a(e[3*t][3*n+3],e[3*t+3][3*n+3]),e[3*t+2][3*n+3]=a(e[3*t+3][3*n+3],e[3*t][3*n+3])):2===i?(0===n&amp;&amp;(e[3*t+3][3*n+0]=u[0]),e[3*t+3][3*n+1]=a(e[3*t+3][3*n],e[3*t+3][3*n+3]),e[3*t+3][3*n+2]=a(e[3*t+3][3*n+3],e[3*t+3][3*n])):(e[3*t+1][3*n]=a(e[3*t][3*n],e[3*t+3][3*n]),e[3*t+2][3*n]=a(e[3*t+3][3*n],e[3*t][3*n]));break;case"c":0===i?(e[3*t][3*n+1]=u[0].add(e[3*t][3*n]),e[3*t][3*n+2]=u[1].add(e[3*t][3*n]),e[3*t][3*n+3]=u[2].add(e[3*t][3*n])):1===i?(e[3*t+1][3*n+3]=u[0].add(e[3*t][3*n+3]),e[3*t+2][3*n+3]=u[1].add(e[3*t][3*n+3]),e[3*t+3][3*n+3]=u[2].add(e[3*t][3*n+3])):2===i?(e[3*t+3][3*n+2]=u[0].add(e[3*t+3][3*n+3]),e[3*t+3][3*n+1]=u[1].add(e[3*t+3][3*n+3]),0===n&amp;&amp;(e[3*t+3][3*n+0]=u[2].add(e[3*t+3][3*n+3]))):(e[3*t+2][3*n]=u[0].add(e[3*t+3][3*n]),e[3*t+1][3*n]=u[1].add(e[3*t+3][3*n]));break;case"C":0===i?(e[3*t][3*n+1]=u[0],e[3*t][3*n+2]=u[1],e[3*t][3*n+3]=u[2]):1===i?(e[3*t+1][3*n+3]=u[0],e[3*t+2][3*n+3]=u[1],e[3*t+3][3*n+3]=u[2]):2===i?(e[3*t+3][3*n+2]=u[0],e[3*t+3][3*n+1]=u[1],0===n&amp;&amp;(e[3*t+3][3*n+0]=u[2])):(e[3*t+2][3*n]=u[0],e[3*t+1][3*n]=u[1]);break;default:console.error("mesh.js: "+c+" invalid path type.")}if(0===t&amp;&amp;0===n||r>0){let e=window.getComputedStyle(o[r]).stopColor.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i),a=window.getComputedStyle(o[r]).stopOpacity,h=255;a&amp;&amp;(h=Math.floor(255*a)),e&amp;&amp;(0===i?(s[t][n]=[],s[t][n][0]=Math.floor(e[1]),s[t][n][1]=Math.floor(e[2]),s[t][n][2]=Math.floor(e[3]),s[t][n][3]=h):1===i?(s[t][n+1]=[],s[t][n+1][0]=Math.floor(e[1]),s[t][n+1][1]=Math.floor(e[2]),s[t][n+1][2]=Math.floor(e[3]),s[t][n+1][3]=h):2===i?(s[t+1][n+1]=[],s[t+1][n+1][0]=Math.floor(e[1]),s[t+1][n+1][1]=Math.floor(e[2]),s[t+1][n+1][2]=Math.floor(e[3]),s[t+1][n+1][3]=h):3===i&amp;&amp;(s[t+1][n]=[],s[t+1][n][0]=Math.floor(e[1]),s[t+1][n][1]=Math.floor(e[2]),s[t+1][n][2]=Math.floor(e[3]),s[t+1][n][3]=h))}}e[3*t+1][3*n+1]=new x,e[3*t+1][3*n+2]=new x,e[3*t+2][3*n+1]=new x,e[3*t+2][3*n+2]=new x,e[3*t+1][3*n+1].x=(-4*e[3*t][3*n].x+6*(e[3*t][3*n+1].x+e[3*t+1][3*n].x)+-2*(e[3*t][3*n+3].x+e[3*t+3][3*n].x)+3*(e[3*t+3][3*n+1].x+e[3*t+1][3*n+3].x)+-1*e[3*t+3][3*n+3].x)/9,e[3*t+1][3*n+2].x=(-4*e[3*t][3*n+3].x+6*(e[3*t][3*n+2].x+e[3*t+1][3*n+3].x)+-2*(e[3*t][3*n].x+e[3*t+3][3*n+3].x)+3*(e[3*t+3][3*n+2].x+e[3*t+1][3*n].x)+-1*e[3*t+3][3*n].x)/9,e[3*t+2][3*n+1].x=(-4*e[3*t+3][3*n].x+6*(e[3*t+3][3*n+1].x+e[3*t+2][3*n].x)+-2*(e[3*t+3][3*n+3].x+e[3*t][3*n].x)+3*(e[3*t][3*n+1].x+e[3*t+2][3*n+3].x)+-1*e[3*t][3*n+3].x)/9,e[3*t+2][3*n+2].x=(-4*e[3*t+3][3*n+3].x+6*(e[3*t+3][3*n+2].x+e[3*t+2][3*n+3].x)+-2*(e[3*t+3][3*n].x+e[3*t][3*n+3].x)+3*(e[3*t][3*n+2].x+e[3*t+2][3*n].x)+-1*e[3*t][3*n].x)/9,e[3*t+1][3*n+1].y=(-4*e[3*t][3*n].y+6*(e[3*t][3*n+1].y+e[3*t+1][3*n].y)+-2*(e[3*t][3*n+3].y+e[3*t+3][3*n].y)+3*(e[3*t+3][3*n+1].y+e[3*t+1][3*n+3].y)+-1*e[3*t+3][3*n+3].y)/9,e[3*t+1][3*n+2].y=(-4*e[3*t][3*n+3].y+6*(e[3*t][3*n+2].y+e[3*t+1][3*n+3].y)+-2*(e[3*t][3*n].y+e[3*t+3][3*n+3].y)+3*(e[3*t+3][3*n+2].y+e[3*t+1][3*n].y)+-1*e[3*t+3][3*n].y)/9,e[3*t+2][3*n+1].y=(-4*e[3*t+3][3*n].y+6*(e[3*t+3][3*n+1].y+e[3*t+2][3*n].y)+-2*(e[3*t+3][3*n+3].y+e[3*t][3*n].y)+3*(e[3*t][3*n+1].y+e[3*t+2][3*n+3].y)+-1*e[3*t][3*n+3].y)/9,e[3*t+2][3*n+2].y=(-4*e[3*t+3][3*n+3].y+6*(e[3*t+3][3*n+2].y+e[3*t+2][3*n+3].y)+-2*(e[3*t+3][3*n].y+e[3*t][3*n+3].y)+3*(e[3*t][3*n+2].y+e[3*t+2][3*n].y)+-1*e[3*t][3*n].y)/9}}this.nodes=e,this.colors=s}paintMesh(t,e){let s=(this.nodes.length-1)/3,r=(this.nodes[0].length-1)/3;if("bilinear"===this.type||s&lt;2||r&lt;2){let n;for(let o=0;o&lt;s;++o)for(let s=0;s&lt;r;++s){let r=[];for(let t=3*o,e=3*o+4;t&lt;e;++t)r.push(this.nodes[t].slice(3*s,3*s+4));let i=[];i.push(this.colors[o].slice(s,s+2)),i.push(this.colors[o+1].slice(s,s+2)),(n=new m(r,i)).paint(t,e)}}else{let n,o,a,h,l,d,u;const x=s,g=r;s++,r++;let w=new Array(s);for(let t=0;t&lt;s;++t){w[t]=new Array(r);for(let e=0;e&lt;r;++e)w[t][e]=[],w[t][e][0]=this.nodes[3*t][3*e],w[t][e][1]=this.colors[t][e]}for(let t=0;t&lt;s;++t)for(let e=0;e&lt;r;++e)0!==t&amp;&amp;t!==x&amp;&amp;(n=i(w[t-1][e][0],w[t][e][0]),o=i(w[t+1][e][0],w[t][e][0]),w[t][e][2]=c(w[t-1][e][1],w[t][e][1],w[t+1][e][1],n,o)),0!==e&amp;&amp;e!==g&amp;&amp;(n=i(w[t][e-1][0],w[t][e][0]),o=i(w[t][e+1][0],w[t][e][0]),w[t][e][3]=c(w[t][e-1][1],w[t][e][1],w[t][e+1][1],n,o));for(let t=0;t&lt;r;++t){w[0][t][2]=[],w[x][t][2]=[];for(let e=0;e&lt;4;++e)n=i(w[1][t][0],w[0][t][0]),o=i(w[x][t][0],w[x-1][t][0]),w[0][t][2][e]=n>0?2*(w[1][t][1][e]-w[0][t][1][e])/n-w[1][t][2][e]:0,w[x][t][2][e]=o>0?2*(w[x][t][1][e]-w[x-1][t][1][e])/o-w[x-1][t][2][e]:0}for(let t=0;t&lt;s;++t){w[t][0][3]=[],w[t][g][3]=[];for(let e=0;e&lt;4;++e)n=i(w[t][1][0],w[t][0][0]),o=i(w[t][g][0],w[t][g-1][0]),w[t][0][3][e]=n>0?2*(w[t][1][1][e]-w[t][0][1][e])/n-w[t][1][3][e]:0,w[t][g][3][e]=o>0?2*(w[t][g][1][e]-w[t][g-1][1][e])/o-w[t][g-1][3][e]:0}for(let s=0;s&lt;x;++s)for(let r=0;r&lt;g;++r){let n=i(w[s][r][0],w[s+1][r][0]),o=i(w[s][r+1][0],w[s+1][r+1][0]),c=i(w[s][r][0],w[s][r+1][0]),x=i(w[s+1][r][0],w[s+1][r+1][0]),g=[[],[],[],[]];for(let t=0;t&lt;4;++t){(d=[])[0]=w[s][r][1][t],d[1]=w[s+1][r][1][t],d[2]=w[s][r+1][1][t],d[3]=w[s+1][r+1][1][t],d[4]=w[s][r][2][t]*n,d[5]=w[s+1][r][2][t]*n,d[6]=w[s][r+1][2][t]*o,d[7]=w[s+1][r+1][2][t]*o,d[8]=w[s][r][3][t]*c,d[9]=w[s+1][r][3][t]*x,d[10]=w[s][r+1][3][t]*c,d[11]=w[s+1][r+1][3][t]*x,d[12]=0,d[13]=0,d[14]=0,d[15]=0,u=f(d);for(let e=0;e&lt;9;++e){g[t][e]=[];for(let s=0;s&lt;9;++s)g[t][e][s]=p(u,e/8,s/8),g[t][e][s]>255?g[t][e][s]=255:g[t][e][s]&lt;0&amp;&amp;(g[t][e][s]=0)}}h=[];for(let t=3*s,e=3*s+4;t&lt;e;++t)h.push(this.nodes[t].slice(3*r,3*r+4));l=y(h);for(let s=0;s&lt;8;++s)for(let r=0;r&lt;8;++r)(a=new m(l[s][r],[[[g[0][s][r],g[1][s][r],g[2][s][r],g[3][s][r]],[g[0][s][r+1],g[1][s][r+1],g[2][s][r+1],g[3][s][r+1]]],[[g[0][s+1][r],g[1][s+1][r],g[2][s+1][r],g[3][s+1][r]],[g[0][s+1][r+1],g[1][s+1][r+1],g[2][s+1][r+1],g[3][s+1][r+1]]]])).paint(t,e)}}}transform(t){if(t instanceof x)for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].add(t);else if(t instanceof g)for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].transform(t)}scale(t){for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].scale(t)}}document.querySelectorAll("rect,circle,ellipse,path,text").forEach((r,n)=>{let o=r.getAttribute("id");o||(o="patchjs_shape"+n,r.setAttribute("id",o));const i=r.style.fill.match(/^url\(\s*"?\s*#([^\s"]+)"?\s*\)/),a=r.style.stroke.match(/^url\(\s*"?\s*#([^\s"]+)"?\s*\)/);if(i&amp;&amp;i[1]){const a=document.getElementById(i[1]);if(a&amp;&amp;"meshgradient"===a.nodeName){const i=r.getBBox();let l=document.createElementNS(s,"canvas");d(l,{width:i.width,height:i.height});const c=l.getContext("2d");let u=c.createImageData(i.width,i.height);const f=new b(a);"objectBoundingBox"===a.getAttribute("gradientUnits")&amp;&amp;f.scale(new x(i.width,i.height));const p=a.getAttribute("gradientTransform");null!=p&amp;&amp;f.transform(h(p)),"userSpaceOnUse"===a.getAttribute("gradientUnits")&amp;&amp;f.transform(new x(-i.x,-i.y)),f.paintMesh(u.data,l.width),c.putImageData(u,0,0);const y=document.createElementNS(t,"image");d(y,{width:i.width,height:i.height,x:i.x,y:i.y});let g=l.toDataURL();y.setAttributeNS(e,"xlink:href",g),r.parentNode.insertBefore(y,r),r.style.fill="none";const w=document.createElementNS(t,"use");w.setAttributeNS(e,"xlink:href","#"+o);const m="patchjs_clip"+n,M=document.createElementNS(t,"clipPath");M.setAttribute("id",m),M.appendChild(w),r.parentElement.insertBefore(M,r),y.setAttribute("clip-path","url(#"+m+")"),u=null,l=null,g=null}}if(a&amp;&amp;a[1]){const o=document.getElementById(a[1]);if(o&amp;&amp;"meshgradient"===o.nodeName){const i=parseFloat(r.style.strokeWidth.slice(0,-2))*(parseFloat(r.style.strokeMiterlimit)||parseFloat(r.getAttribute("stroke-miterlimit"))||1),a=r.getBBox(),l=Math.trunc(a.width+i),c=Math.trunc(a.height+i),u=Math.trunc(a.x-i/2),f=Math.trunc(a.y-i/2);let p=document.createElementNS(s,"canvas");d(p,{width:l,height:c});const y=p.getContext("2d");let g=y.createImageData(l,c);const w=new b(o);"objectBoundingBox"===o.getAttribute("gradientUnits")&amp;&amp;w.scale(new x(l,c));const m=o.getAttribute("gradientTransform");null!=m&amp;&amp;w.transform(h(m)),"userSpaceOnUse"===o.getAttribute("gradientUnits")&amp;&amp;w.transform(new x(-u,-f)),w.paintMesh(g.data,p.width),y.putImageData(g,0,0);const M=document.createElementNS(t,"image");d(M,{width:l,height:c,x:0,y:0});let S=p.toDataURL();M.setAttributeNS(e,"xlink:href",S);const k="pattern_clip"+n,A=document.createElementNS(t,"pattern");d(A,{id:k,patternUnits:"userSpaceOnUse",width:l,height:c,x:u,y:f}),A.appendChild(M),o.parentNode.appendChild(A),r.style.stroke="url(#"+k+")",g=null,p=null,S=null}}})}();</script></svg><figcaption>Fig 5. Control-Flow Flattening with Random ID and Encoding</figcaption></figure></center><p>Concretely, the code generated <strong>does not use a lookup-switch table</strong> and the dispatcher is a succession of conditions:</p><center><figure><img class=lightense data-lightense-background=#949494 src=/post/22-09-ios-obfuscation-syscall-hooking/imgs/cfg-flat-omvll-head.webp alt="Head of the O-MVLL flattened function"><br><figcaption>Figure 6 - Head of the Control-Flow Flattening</figure></figure><br></center><p>We can also observe the encoding block at the end of the graph:</p><center><figure><img class=lightense data-lightense-background=#949494 src=/post/22-09-ios-obfuscation-syscall-hooking/imgs/cfg-flat-omvll-tail.webp alt="Tail of the O-MVLL flattened function"><br><figcaption>Figure 7 - Tail of the Control-Flow Flattening</figure></figure><br></center><p>In this example, the encoding is simply $E(X) = X \oplus A + B$ but it could be protected with an MBA and
generated with different expressions, unique per function. Globally speaking, any injective (or bijective) function
should fit as an encoding.</p><p>In the end, it would increase the complexity of recovering the original graph <strong>at scale</strong>
(even though the design is known).</p><h2 id=mixed-boolean-arithmetic>Mixed-Boolean Arithmetic</h2><p>We can also observe in <a href=#fig-2>Figure 2</a> that the function uses an MBA as an opaque zero or more precisely
an opaque boolean.</p><p>Generally speaking, MBA are widely used by the obfuscator but they are usually represented under
their <em>simple</em> form like $(A \oplus B) + (A \& B) \times 2$.
In other words, we <strong>can&rsquo;t quickly</strong> identify the underlying arithmetic operation but with limited efforts, we can simplify the expression
using public tools.</p><p>If you want to dig more into MBA deobfuscation, I highly recommend this recent blog post <a href=https://secret.club/2022/08/08/eqsat-oracle-synthesis.html>Improving MBA Deobfuscation using Equality Saturation</a>
by <a href=https://twitter.com/mr_phrazer>Tim Blazytko</a> and <a href=https://twitter.com/fvrmatteo>Matteo</a>
which also lists open-source tools that can be used for simplifying MBA like:</p><ul><li><a href=https://github.com/quarkslab/sspam>sspam</a></li><li><a href=https://github.com/mrphrazer/msynth/>msynth</a> (Used for this binary)</li></ul><div class="alert alert-info" role=alert style=border:none!important;background-color:#f5fdf8;color:#002b11><span class="fas fa-rocket-launch" style=color:#002b11>&#160;</span>
<a href=https://triton-library.github.io/>Triton</a>
also supports program synthesis: <a href=https://github.com/JonathanSalwan/Triton/blob/96104b1a860dc7ddb9ab123859b2fd668e388f72/src/examples/python/synthesizing_obfuscated_expressions.py>synthesizing_obfuscated_expressions.py</a> :)</div><h2 id=strings-encoding>Strings Encoding</h2><p>Most of the strings used in the library are encoded which prevents identifying quickly sensitive functions.</p><p>These encoded strings are decoded <em>just-in-time</em> near the instruction that uses given the string.
In the blog post about <a href=https://www.romainthomas.fr/post/21-07-pokemongo-anti-frida-jailbreak-bypass/>PokemonGO</a>, <strong>all the
strings</strong> were decrypted at once in the Mach-O constructors which enabled to recover all of these strings without
caring about reverse engineering the decoding routines. For the current obfuscator, we can&rsquo;t exactly apply this
technique.</p><center><figure class=mb-4><svg xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="776.99988" height="354.00003" viewBox="0 0 205.58122 93.662505" id="svg5"><defs id="defs2"><rect x="374.99997" y="44.999996" width="295" height="105" id="rect208641"/><rect x="9.999999" y="4.9999995" width="154.99998" height="84.999992" id="rect199231"/><rect x="9.999999" y="4.9999995" width="154.99998" height="84.999992" id="rect199231-9"/><rect x="9.999999" y="4.9999995" width="154.99998" height="84.999992" id="rect207888"/><rect x="9.999999" y="4.9999995" width="154.99998" height="84.999992" id="rect208013"/></defs><g id="layer1" transform="translate(-6.0854163,-6.085416)"><g id="g208924" style="display:inline"><g id="g187977" style="display:inline"><g id="g187990"><rect style="fill:#353333;fill-opacity:1;stroke:#6dcff6;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="rect186383" width="175" height="300" x="29.999998" y="75" transform="matrix(0.26458333,0,0,0.26458333,-1.3229164,-7.5e-7)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 99.999995H134.99999" id="path199031" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m144.99999 99.999995h30" id="path199033" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 124.99999H59.999997" id="path199035" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M74.999996 124.99999H89.999995" id="path199037" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M99.999995 124.99999H154.99999" id="path199039" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m174.99999 124.99999h15" id="path199041" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M44.999998 149.99999H69.999996" id="path199043" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m109.99999 149.99999h80" id="path199045" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 174.99999H89.999995" id="path199047" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m94.999995 174.99999h5" id="path199049" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m104.99999 174.99999h55" id="path199051" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m34.999998 199.99999h5" id="path199053" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M54.999997 199.99999H104.99999" id="path199055" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m114.99999 199.99999h5" id="path199057" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M74.999996 224.99999H99.999995" id="path199059" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m59.999997 224.99999h-10" id="path199061" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m114.99999 224.99999h75" id="path199063" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 249.99999H149.99999" id="path199065" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M84.999996 274.99999H114.99999" id="path199067" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m149.99999 274.99999h20" id="path199069" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M189.99999 299.99998H49.999997" id="path199071" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 324.99998H74.999996" id="path199073" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m124.99999 324.99998h25" id="path199075" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m174.99999 324.99998h15" id="path199077" transform="scale(0.26458333)"/><path style="fill:#353333;fill-opacity:1;stroke:#c364fc;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 349.99998H149.99999" id="path199079" transform="scale(0.26458333)"/></g><g id="g199238"><rect style="fill:#353333;fill-opacity:1;stroke:#6dcff6;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="rect186391" width="175" height="25" x="29.999998" y="75" transform="matrix(0.26458333,0,0,0.26458333,-1.3229164,-13.229167)"/><text transform="matrix(0.26458333,0,0,0.26458333,-3.437517,6.4413019)" id="text199229" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-align:center;white-space:pre;shape-inside:url(#rect199231);display:inline;fill:#c364fc;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="42.140625" y="18.803357" id="tspan209430">Contrusctor</tspan></text></g><rect style="display:inline;fill:none;fill-opacity:1;stroke:#c364fc;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:1,2;stroke-dashoffset:0;stroke-opacity:1;paint-order:markers stroke fill" id="rect208474" width="165" height="270" x="29.999998" y="90" transform="scale(0.26458333)"/></g></g><g id="g208844" style="display:inline" transform="translate(7.4083325)"><g id="g199346" transform="translate(92.604164)" style="display:inline"><rect style="fill:#353333;fill-opacity:1;stroke:#6dcff6;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="rect199294" width="175" height="300" x="29.999998" y="75" transform="matrix(0.26458333,0,0,0.26458333,-1.3229164,-7.5e-7)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 99.999995H134.99999" id="path199296" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m144.99999 99.999995h30" id="path199298" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 124.99999H59.999997" id="path199300" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M74.999996 124.99999H89.999995" id="path199302" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M99.999995 124.99999H154.99999" id="path199304" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m174.99999 124.99999h15" id="path199306" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M44.999998 149.99999H69.999996" id="path199308" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m109.99999 149.99999h80" id="path199310" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 174.99999H89.999995" id="path199312" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m94.999995 174.99999h5" id="path199314" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m104.99999 174.99999h55" id="path199316" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m34.999998 199.99999h5" id="path199318" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M54.999997 199.99999H104.99999" id="path199320" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m114.99999 199.99999h5" id="path199322" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M74.999996 224.99999H99.999995" id="path199324" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m59.999997 224.99999h-10" id="path199326" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m114.99999 224.99999h75" id="path199328" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 249.99999H149.99999" id="path199330" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M84.999996 274.99999H114.99999" id="path199332" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m149.99999 274.99999h20" id="path199334" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M189.99999 299.99998H49.999997" id="path199336" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 324.99998H74.999996" id="path199338" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m124.99999 324.99998h25" id="path199340" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m174.99999 324.99998h15" id="path199342" transform="scale(0.26458333)"/><path style="fill:none;fill-opacity:1;stroke:#837e7e;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 349.99998H149.99999" id="path199344" transform="scale(0.26458333)"/></g><g id="g187937" transform="translate(35.718753,3.9687508)" style="display:inline"><rect style="fill:#353333;fill-opacity:1;stroke:#6dcff6;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="rect187932" width="194.99998" height="94.999992" x="439.99997" y="14.999999" transform="scale(0.26458333)"/><rect style="fill:#4e4b4b;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill" id="rect187928" width="175" height="25" x="29.999998" y="75" transform="matrix(0.26458333,0,0,0.26458333,111.12499,-13.229167)"/><text transform="matrix(0.26458333,0,0,0.26458333,110.4884,6.4413019)" id="text199229-7" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-align:center;white-space:pre;shape-inside:url(#rect199231-9);display:inline;fill:#fdd418;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="36.257812" y="18.803357" id="tspan209432">sub_01a34d()</tspan></text><rect style="fill:#4e4b4b;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill" id="rect187930" width="175" height="25" x="29.999998" y="75" transform="matrix(0.26458333,0,0,0.26458333,111.12499,-7.5e-7)"/><g id="g202268" transform="translate(29.104162,6.6145837)" style="fill:#6f0;stroke:#0a4"><path style="fill:#6f0;fill-opacity:1;stroke:#0a4;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 99.999995H134.99999" id="path199296-1" transform="matrix(0.26458333,0,0,0.26458333,82.02083,-10.583334)"/><path style="fill:#6f0;fill-opacity:1;stroke:#0a4;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m144.99999 99.999995h30" id="path199298-9" transform="matrix(0.26458333,0,0,0.26458333,82.02083,-10.583334)"/></g></g><g id="g207886" transform="translate(35.718753,37.041667)" style="display:inline"><rect style="fill:#353333;fill-opacity:1;stroke:#6dcff6;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="rect207870" width="194.99998" height="94.999992" x="439.99997" y="14.999999" transform="scale(0.26458333)"/><rect style="fill:#4e4b4b;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill" id="rect207872" width="175" height="25" x="29.999998" y="75" transform="matrix(0.26458333,0,0,0.26458333,111.12499,-13.229167)"/><text transform="matrix(0.26458333,0,0,0.26458333,117.44605,6.3214126)" id="text207876" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-align:start;white-space:pre;shape-inside:url(#rect207888);display:inline;fill:#fdd418;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" x="40.4375" y="0"><tspan x="10" y="18.803357" id="tspan209434">sub_f289()</tspan></text><rect style="fill:#4e4b4b;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill" id="rect207878" width="175" height="25" x="29.999998" y="75" transform="matrix(0.26458333,0,0,0.26458333,111.12499,-7.5e-7)"/><path style="fill:none;fill-opacity:1;stroke:#0a4;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M74.999996 224.99999H99.999995" id="path199324-8" transform="matrix(0.26458333,0,0,0.26458333,107.15624,-37.041666)"/><path style="fill:none;fill-opacity:1;stroke:#0a4;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m59.999997 224.99999h-10" id="path199326-2" transform="matrix(0.26458333,0,0,0.26458333,107.15624,-37.041666)"/><path style="fill:none;fill-opacity:1;stroke:#0a4;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m114.99999 224.99999h75" id="path199328-5" transform="matrix(0.26458333,0,0,0.26458333,107.15624,-37.041666)"/><g id="g207884" transform="translate(29.104162,6.6145837)" style="fill:#6f0;stroke:#0a4"/></g><g id="g208011" transform="translate(35.718752,70.114581)" style="display:inline"><rect style="fill:#353333;fill-opacity:1;stroke:#6dcff6;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="rect207993" width="194.99998" height="94.999992" x="439.99997" y="14.999999" transform="scale(0.26458333)"/><rect style="fill:#4e4b4b;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill" id="rect207995" width="175" height="25" x="29.999998" y="75" transform="matrix(0.26458333,0,0,0.26458333,111.12499,-13.229167)"/><text transform="matrix(0.26458333,0,0,0.26458333,117.44605,6.3214126)" id="text207999" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-align:start;white-space:pre;shape-inside:url(#rect208013);display:inline;fill:#fdd418;fill-opacity:1;stroke:none;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" x="40.4375" y="0"><tspan x="10" y="18.803357" id="tspan209436">sub_78f3()</tspan></text><rect style="fill:#4e4b4b;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill" id="rect208001" width="175" height="25" x="29.999998" y="75" transform="matrix(0.26458333,0,0,0.26458333,111.12499,-7.5e-7)"/><path style="display:inline;fill:none;fill-opacity:1;stroke:#0a4;stroke-width:3;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="M34.999998 349.99998H149.99999" id="path199344-3" transform="matrix(0.26458333,0,0,0.26458333,111.12499,-70.114579)"/><g id="g208009" transform="translate(29.104162,6.6145837)" style="fill:#6f0;stroke:#0a4"/><rect style="fill:none;fill-opacity:1;stroke:#0a4;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:1,2;stroke-dashoffset:0;stroke-opacity:1;paint-order:markers stroke fill" id="rect208196" width="165.00002" height="25.000004" x="379.99997" y="89.999992" transform="matrix(0.26458333,0,0,0.26458333,-35.718752,-70.114581)"/><rect style="fill:none;fill-opacity:1;stroke:#0a4;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:1,2;stroke-dashoffset:0;stroke-opacity:1;paint-order:markers stroke fill" id="rect208250" width="165.00002" height="25.000004" x="379.99997" y="89.999992" transform="matrix(0.26458333,0,0,0.26458333,-35.718757,-37.041667)"/><rect style="fill:none;fill-opacity:1;stroke:#0a4;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:1,2;stroke-dashoffset:0;stroke-opacity:1;paint-order:markers stroke fill" id="rect208252" width="165.00002" height="25.000004" x="379.99997" y="89.999992" transform="matrix(0.26458333,0,0,0.26458333,-35.718757,-3.9687521)"/><text transform="matrix(0.26458333,0,0,0.26458333,-35.90584,-70.114581)" id="text208639" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:17.3333px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;text-align:start;white-space:pre;shape-inside:url(#rect208641);display:inline;fill:#353333;fill-opacity:1;stroke:none;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:1,2;stroke-dashoffset:0;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="375" y="59.953608" id="tspan209438">__DATA.__data section</tspan></text></g></g></g></svg><br><br><figcaption>Fig 8. Differences in Designing String Encryption</figcaption></figure><br></center><p>To better understand the difficulty, let&rsquo;s take a closer look at how strings are encoded with
the <span class="dark-boxed dark-yellow">_unmount()</span> function. As a reminder, this function is used
as a part of jailbreak detection.</p><p>In the KaaSBle library, there are five cross-references to <span class="dark-boxed dark-yellow">_unmount()</span>:</p><center><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 341 100" width="100%" height="100%"><g font-family="Fira Code" font-size="11" font-weight="450"><rect x="0" y="0" width="341" height="100" fill="#353333" rx="4" ry="4" stroke-width="6" stroke="#6dcff6"/><text x="7" y="20"><tspan fill="#ed1c24">P </tspan><tspan fill="#fdd418">sub_61d94</tspan><tspan fill="#aaa">+178</tspan><tspan fill="#aaa">                     </tspan><tspan fill="#fff">BL</tspan><tspan> </tspan><tspan fill="#fdd418">_unmount</tspan><tspan fill="#aaa"/></text><text x="7" y="36"><tspan fill="#ed1c24">P </tspan><tspan fill="#fdd418">sub_8fa98</tspan><tspan fill="#aaa">+1c8</tspan><tspan fill="#aaa">                     </tspan><tspan fill="#fff">BL</tspan><tspan> </tspan><tspan fill="#fdd418">_unmount</tspan><tspan fill="#aaa"/></text><text x="7" y="52"><tspan fill="#ed1c24">P </tspan><tspan fill="#fdd418">_mbedtls_entropy_gather_0</tspan><tspan fill="#aaa">+128</tspan><tspan fill="#aaa">     </tspan><tspan fill="#fff">BL</tspan><tspan> </tspan><tspan fill="#fdd418">_unmount</tspan><tspan fill="#aaa"/></text><text x="7" y="68"><tspan fill="#ed1c24">P </tspan><tspan fill="#fdd418">_mbedtls_ssl_get_session</tspan><tspan fill="#aaa">+11c</tspan><tspan fill="#aaa">      </tspan><tspan fill="#fff">BL</tspan><tspan> </tspan><tspan fill="#fdd418">_unmount</tspan><tspan fill="#aaa"/></text><text x="7" y="84"><tspan fill="#ed1c24">P </tspan><tspan fill="#fdd418">sub_177998</tspan><tspan fill="#aaa">+c</tspan><tspan fill="#aaa">                      </tspan><tspan fill="#fff">BL</tspan><tspan> </tspan><tspan fill="#fdd418">_unmount</tspan><tspan fill="#aaa"/></text><text x="7" y="100"/></g></svg><br><br></center><p>When looking at the prologue of the <span class="dark-boxed dark-yellow">_unmount()</span> calls,
we get the following basic blocks:</p><center><figure><img class=lightense data-lightense-background=#949494 src=/post/22-09-ios-obfuscation-syscall-hooking/imgs/boostrapped.webp alt="Decoding Routine for /.bootstrapped"><figcaption>Figure 9 - Decoding Routine for the String /.bootstrapped</figure></figure><br></center><p>Which is equivalent to this snippet:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:green;font-weight:700>from</span> <span style=color:#00f;font-weight:700>itertools</span> <span style=color:green;font-weight:700>import</span> cycle
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green;font-weight:700>def</span> <span style=color:#00f>decode</span>(encrypted: <span style=color:green>bytes</span>, key: <span style=color:green>str</span>, op):
</span></span><span style=display:flex><span>    key       <span style=color:#666>=</span> <span style=color:green>bytes</span><span style=color:#666>.</span>fromhex(key)
</span></span><span style=display:flex><span>    encrypted <span style=color:#666>=</span> <span style=color:green>bytes</span><span style=color:#666>.</span>fromhex(encrypted)
</span></span><span style=display:flex><span>    out <span style=color:#666>=</span> <span style=color:#ba2121>&#34;&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:green;font-weight:700>for</span> idx, (k, v) <span style=color:#a2f;font-weight:700>in</span> <span style=color:green>enumerate</span>(<span style=color:green>zip</span>(encrypted, cycle(key))):
</span></span><span style=display:flex><span>        out <span style=color:#666>+=</span> <span style=color:green>chr</span>(op(idx, k, v) <span style=color:#666>&amp;</span> <span style=color:#666>0xFF</span>)
</span></span><span style=display:flex><span>    <span style=color:green;font-weight:700>return</span> out
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic># /.bootstrapped</span>
</span></span><span style=display:flex><span>clear <span style=color:#666>=</span> decode(<span style=color:#ba2121>&#34;9f0b698a3abc17e70bb54332271180&#34;</span>, <span style=color:#408080;font-style:italic># Encoded string</span>
</span></span><span style=display:flex><span>               <span style=color:#ba2121>&#34;b0250be555c8649379d43342427580&#34;</span>, <span style=color:#408080;font-style:italic># Key</span>
</span></span><span style=display:flex><span>               <span style=color:green;font-weight:700>lambda</span> _, k, v: (k <span style=color:#666>^</span> v))          <span style=color:#408080;font-style:italic># Operation</span>
</span></span></code></pre></div><p>It is worth mentioning that the string is not decoded <em>in-placed</em> but in another <code>__data</code> variable.
This means that an encoded string takes potentially twice its size in the final binary.</p><p>Another example of a decoding routine:</p><center><figure><img class=lightense data-lightense-background=#949494 src=/post/22-09-ios-obfuscation-syscall-hooking/imgs/installed_odyssey.webp alt="Decoding Routine for /.installed_odyssey"><figcaption>Figure 10 - Decoding Routine for the String /.installed_odyssey</figure></figure><br></center><p>Which is equivalent to:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#408080;font-style:italic># /.installed_odyssey</span>
</span></span><span style=display:flex><span>clear <span style=color:#666>=</span> decode(<span style=color:#ba2121>&#34;1bec336463362f66602b365d672e4f756f3353&#34;</span>, <span style=color:#408080;font-style:italic># Encoded string</span>
</span></span><span style=display:flex><span>               <span style=color:#ba2121>&#34;ecbdc8f3&#34;</span>,                               <span style=color:#408080;font-style:italic># Key</span>
</span></span><span style=display:flex><span>               <span style=color:green;font-weight:700>lambda</span> i, k, v: (k <span style=color:#666>-</span> v <span style=color:#666>-</span> i))              <span style=color:#408080;font-style:italic># Operation</span>
</span></span></code></pre></div><p>In this case, the key is an <code>uint32_t</code> integer for which the bytes are accessed through a stack variable.
The <em>weird</em> operation <code>x12 = x8 & (x8 ^ 0xfffffffffffffffc)</code> is simply a modulus <code>sizeof(uint32_t)</code> :)</p><p>In summary, because of the <strong>disparity</strong> of the encodings which are mixed with MBA and unique keys, it would be quite difficult
to <strong>statically</strong> decode all the strings of the library. On the other hand, since the clear strings are written in the
<code>__data</code> section of the binary, we can dump &ndash; at some point in the execution &ndash; this section and observe the
clear strings (c.f. <a href=https://www.romainthomas.fr/post/22-08-singpass-rasp-analysis/#jailbreak-detection>Singpass RASP Analysis - Jailbreak Detection</a>).</p><h2 id=crash-analysis>Crash Analysis</h2><p>When the obfuscator detects that the environment is compromised (jailbroken device, debugger attached, &mldr;), it
reacts by crashing the application. This crash occurs through different techniques among which:</p><ol><li>Corrupting a global pointer</li><li>Executing a break instruction (BRK #1)</li><li>Trashing the link register and frame register (LR / FP)</li><li>Calling <span class="dark-boxed dark-yellow">objc_msgSend</span> with corrupted parameters</li></ol><p>The instructions involved in crashing the application are <strong>inlined</strong> in the function where the check occurs.
This means that there is as many <em>crash routine</em> as there are RASP checks.</p><p>In particular, with such a design, we can&rsquo;t target a single function to bypass the different checks as I did
for SingPass.</p><h2 id=hooking-the-syscalls>Hooking the Syscalls</h2><div class="alert alert-info" role=alert style=border:none!important;background-color:#fafcff;color:#084298><span class="fas fa-salt-shaker" style=color:#084298>&#160;</span>
This approach is inspired by this talk at
Pass the Salt: <a href=https://archives.pass-the-salt.org/Pass%20the%20SALT/2021/slides/PTS2021-Talk-01-JailBreak_detection.pdf>Jailbreak Detection and How to Bypass Them</a></div><p>To better understand the <em>problem</em>, let&rsquo;s recap the situation:</p><ol><li>The code is obfuscated with CFG flattening, MBA, etc</li><li>The RASP checks are <strong>inlined</strong> in the code</li><li>The application crashes near the detection spot. In particular and compared to SingPass,
there is no RASP endpoint that can be hooked.</li></ol><p>The following figure depicts the differences in the RASP reaction between the two applications:</p><div class=col-lg-0 id=fig-3><center><figure><svg xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="791.09235" height="383.69897" viewBox="0 0 209.30985 101.52035" id="svg5" sodipodi:docname="callback_vs_crash.svg"><sodipodi:namedview id="namedview7" pagecolor="#ffffff" bordercolor="#000000" borderopacity=".25" showgrid="true"><inkscape:grid type="xygrid" id="grid6790" spacingx="1.3229166" spacingy="1.3229166" empspacing="5"/></sodipodi:namedview><defs id="defs2"><linearGradient id="linearGradient342777"><stop style="stop-color:#82412b;stop-opacity:1" offset="0" id="stop342773"/><stop style="stop-color:#082361;stop-opacity:1" offset=".49169078" id="stop342781"/><stop style="stop-color:#ef6456;stop-opacity:1" offset="1" id="stop342775"/></linearGradient><linearGradient id="linearGradient341235"><stop style="stop-color:#ef6456;stop-opacity:1" offset="0" id="stop341231"/><stop style="stop-color:#353333;stop-opacity:1" offset="1" id="stop341233"/></linearGradient><linearGradient id="linearGradient341229"><stop style="stop-color:#082361;stop-opacity:1" offset="0" id="stop341225"/><stop style="stop-color:#353333;stop-opacity:1" offset="1" id="stop341227"/></linearGradient><rect x="484.99997" y="359.99997" width="141.8231" height="40.000023" id="rect340312"/><rect x="290" y="254.99998" width="270" height="115" id="rect327889"/><linearGradient id="linearGradient321355"><stop style="stop-color:#ef6456;stop-opacity:1" offset="0" id="stop321351"/><stop style="stop-color:#353333;stop-opacity:1" offset="1" id="stop321353"/></linearGradient><linearGradient id="linearGradient321035"><stop style="stop-color:#082361;stop-opacity:1" offset="0" id="stop321031"/><stop style="stop-color:#353333;stop-opacity:1" offset="1" id="stop321033"/></linearGradient><linearGradient id="linearGradient317431"><stop style="stop-color:#5d2e1f;stop-opacity:1" offset="0" id="stop317427"/><stop style="stop-color:#353333;stop-opacity:1" offset="1" id="stop317429"/></linearGradient><rect x="134.99998" y="44.999996" width="194.99998" height="69.999992" id="rect314152"/><linearGradient xlink:href="#linearGradient317431" id="linearGradient317433" x1="124.99999" y1="54.999992" x2="144.99998" y2="54.999992" gradientUnits="userSpaceOnUse"/><rect x="134.99998" y="44.999996" width="194.99998" height="69.999992" id="rect320078"/><linearGradient xlink:href="#linearGradient321035" id="linearGradient320080" gradientUnits="userSpaceOnUse" x1="124.99999" y1="54.999992" x2="144.99998" y2="54.999992"/><rect x="134.99998" y="44.999996" width="194.99998" height="69.999992" id="rect321193"/><linearGradient xlink:href="#linearGradient321355" id="linearGradient321195" gradientUnits="userSpaceOnUse" x1="124.99999" y1="54.999992" x2="144.99998" y2="54.999992"/><linearGradient xlink:href="#linearGradient341235" id="linearGradient317433-1" x1="124.99999" y1="54.999992" x2="144.99998" y2="54.999992" gradientUnits="userSpaceOnUse"/><rect x="134.99998" y="44.999996" width="194.99998" height="69.999992" id="rect314152-7"/><rect x="134.99998" y="44.999996" width="194.99998" height="69.999992" id="rect320078-5"/><rect x="134.99998" y="44.999996" width="194.99998" height="69.999992" id="rect321193-9"/><linearGradient xlink:href="#linearGradient317431" id="linearGradient334572" gradientUnits="userSpaceOnUse" x1="124.99999" y1="54.999992" x2="144.99998" y2="54.999992"/><linearGradient xlink:href="#linearGradient341229" id="linearGradient334574" gradientUnits="userSpaceOnUse" x1="124.99999" y1="54.999992" x2="144.99998" y2="54.999992"/><rect x="484.99997" y="359.99997" width="141.8231" height="40.000023" id="rect340533"/><rect x="484.99997" y="359.99997" width="141.8231" height="40.000023" id="rect340608"/><linearGradient xlink:href="#linearGradient342777" id="linearGradient342779" x1="391.50027" y1="199.99998" x2="438.49966" y2="199.99998" gradientUnits="userSpaceOnUse"/><linearGradient xlink:href="#linearGradient342777" id="linearGradient343226" x1="391.50027" y1="199.99998" x2="438.49966" y2="199.99998" gradientUnits="userSpaceOnUse"/></defs><g id="layer1" transform="translate(-4.62497,-2.6713622)"><g id="g334828"><g id="cydia" style="isolation:isolate;stroke-width:1.37583" transform="matrix(0.19230769,0,0,0.19230769,-4.0288753,-46.387195)"><g id="g896" style="stroke-width:1.37583"><path d="M59.21 384.685C52.786 383.127 47.278 377.772 45.639 371.491 45.051 369.239 45 365.174 45 320.17c0-45.004.051-49.069.639-51.321 1.683-6.448 7.496-11.932 14.11-13.311 2.773-.578 97.729-.578 100.502.0 6.614 1.379 12.427 6.863 14.11 13.311.588 2.252.639 6.317.639 51.321s-.051 49.069-.639 51.321c-1.683 6.448-7.496 11.932-14.11 13.311-2.99.623-98.444.513-101.041-.117z" id="path875" fill="#5d2e1f" style="stroke-width:2.36614"/><g id="g302028" style="stroke-width:1.37583"><path d="m117.991 365.337c16.201-3.392 29.388-14.971 34.512-30.305 1.714-5.126 2.261-8.679 2.261-14.676.0-3.932-.196-6.506-.665-8.735-3.925-18.641-17.617-32.335-36.294-36.299-4.352-.924-13.116-.924-17.469.0-18.676 3.964-32.368 17.658-36.293 36.299-.915 4.345-.915 13.125.0 17.469 3.336 15.845 13.702 28.199 28.561 34.039 7.615 2.993 17.521 3.855 25.387 2.208z" id="path873" fill="#fff" style="stroke-width:2.36614"/></g><path d="M100.868 360.293c-15.098-3.173-27.102-14.482-31.223-29.416-1.184-4.29-1.609-11.963-.923-16.655 1.838-12.567 9.962-23.851 21.653-30.072 11.266-5.995 26.125-5.995 37.392.0 7.786 4.144 14.161 10.663 18.078 18.484 5.075 10.138 5.235 24.045.396 34.518-4.522 9.788-13.051 17.744-23.009 21.466-6.557 2.45-15.492 3.119-22.364 1.675z" id="path871" fill="#5d2e1f" style="stroke-width:2.36614"/><g id="g302047" style="stroke-width:1.37583"><path d="m124.495 346.447 8.363-3.495.103-5.258c.057-2.892-.045-5.259-.226-5.259s-5.432 2.068-11.668 4.595l-11.338 4.596-.68-1.158c-.374-.636-1.315-2.16-2.091-3.387l-1.411-2.23-.004 9.731-.003 9.731 5.296-2.186c2.913-1.202 9.06-3.758 13.659-5.68z" id="path869" fill="#fff" style="stroke-width:2.36614"/><path d="m102.938 342.099c0-8.08-.121-11.522-.406-11.522-.223.0-3.237.931-6.699 2.069l-6.293 2.069-2.407-1.915-2.407-1.916v5.051 5.05l1.928 1.393c6.395 4.623 15.768 11.19 16.005 11.214.154.016.279-5.156.279-11.493z" id="path867" fill="#faf9f9" style="stroke-width:2.36614"/><path d="m135.744 328.388c.227-.22-1.43-9.224-1.772-9.627-.068-.08-22.907 8.379-27.41 10.152-.358.141-.65.39-.65.554.0.254 3.489 6.339 5.036 8.782.498.788.631.742 12.508-4.395 6.602-2.855 12.132-5.315 12.288-5.466z" id="path865" fill="#fff" style="stroke-width:2.36614"/><path d="m98.061 329.754 2.371-.891-8.689-7.427c-4.78-4.084-8.893-7.552-9.142-7.705-.447-.277-7.724 5.418-7.724 6.045.0.165 3.412 3.144 7.583 6.619l7.584 6.318 2.823-1.034c1.553-.569 3.89-1.435 5.194-1.925z" id="path863" fill="#fff" style="stroke-width:2.36614"/><path d="m117.053 322.777c-.012-.282-7.147-3.354-7.784-3.352-.997.003-11.58 4.565-11.276 4.86.165.16 1.437 1.194 2.828 2.298l2.529 2.008 6.856-2.812c3.771-1.546 6.852-2.897 6.847-3.002z" id="path861" fill="#fff" style="stroke-width:2.36614"/><path d="m102.84 320.289 5.302-2.111v-1.977c0-1.088-.126-1.981-.279-1.985-.153-.004-2.746 1.036-5.761 2.309l-5.482 2.316v1.78c0 1.165.158 1.779.459 1.779.253.0 2.845-.95 5.761-2.111z" id="path859" fill="#fff" style="stroke-width:2.36614"/><path d="m118.992 319.705c-.088-1.277-.189-2.357-.224-2.399-.034-.042-1.937-.912-4.229-1.933l-4.167-1.857v2.026c0 1.115-.02 2.152-.044 2.305-.035.229 7.923 4.066 8.616 4.155.115.014.137-1.019.048-2.297z" id="path857" fill="#fff" style="stroke-width:2.36614"/><path d="m95.115 319.891-.018-1.765-4.688-3.345c-6.179-4.409-5.758-4.2-5.616-2.802.099.973.92 1.868 4.951 5.394 2.657 2.325 4.957 4.239 5.11 4.255.154.016.271-.766.261-1.737z" id="path855" fill="#fff" style="stroke-width:2.36614"/><path d="m127.163 319.342 4.711-1.84.12-2.941c.066-1.618.08-2.941.031-2.94-.05.0-2.684 1.294-5.854 2.875l-5.764 2.875.005 1.307c.003.718.107 1.687.232 2.153.267.999-.022 1.065 6.519-1.489z" id="path853" fill="#fff" style="stroke-width:2.36614"/><path d="m101.567 315.114c2.696-1.145 5.021-2.192 5.167-2.327.273-.253-11.548-7.856-12.215-7.856-.733.0-9.606 3.627-9.548 3.903.053.253 11.272 8.363 11.569 8.363.069.0 2.33-.937 5.027-2.083z" id="path851" fill="#fff" style="stroke-width:2.36614"/><path d="m126.539 312.929c1.636-.756 3.377-1.532 3.869-1.725.829-.326.608-.528-3.043-2.769l-3.938-2.416-6.249 3.141-6.249 3.141 1.301.554c.716.304 2.705 1.135 4.421 1.846l3.121 1.292 1.897-.846c1.043-.465 3.235-1.463 4.87-2.218z" id="path849" fill="#fff" style="stroke-width:2.36614"/><path d="m139.331 307.388c-.257-.239-15.928-8.032-16.153-8.032-.114.0-.158.878-.096 1.952l.112 1.951 5.195 3.234c5.434 3.382 6.141 3.998 6.141 5.349.0.674.447.359 2.478-1.744 1.362-1.411 2.408-2.631 2.323-2.71z" id="path847" fill="#fff" style="stroke-width:2.36614"/><path d="m88.925 305.222 5.651-2.415 1.553 1.062c.855.584 1.649 1.062 1.766 1.062.116.0.211-1.303.211-2.896v-2.896l3.171-1.428c1.745-.786 3.115-1.484 3.047-1.553-.096-.096-11.027 4.215-23.201 9.152l-.816.331 1.373 2.966 1.374 2.967.11-1.969.11-1.968z" id="path845" fill="#fff" style="stroke-width:2.36614"/><path d="m108.414 306.348c-.207-.511-8.385-4.95-8.644-4.691-.082.082-.029 1.219.116 2.528l.265 2.379 3.902 2.345 3.903 2.345.327-2.209c.18-1.215.239-2.428.131-2.697z" id="path843" fill="#fff" style="stroke-width:2.36614"/><path d="m115.801 308.063 5.349-2.815v-2.202c0-1.53-.142-2.194-.464-2.174-.256.015-2.723 1.144-5.483 2.508l-5.017 2.48-.11 2.509c-.061 1.38-.001 2.509.133 2.509s2.65-1.267 5.592-2.815z" id="path841" fill="#fff" style="stroke-width:2.36614"/><path d="m114.832 301.982 5.017-2.538-1.301-.548c-.715-.301-2.752-1.18-4.526-1.953l-3.227-1.405-4.579 1.976c-2.518 1.087-4.721 2.096-4.895 2.244-.315.267 7.415 4.819 8.121 4.782.205-.011 2.63-1.162 5.39-2.558z" id="path837" fill="#fff" style="stroke-width:2.36614"/></g></g></g><g id="debug" style="isolation:isolate;stroke-width:1.5291" transform="matrix(0.17303175,0,0,0.17303175,-1.605716,1.5328508)"><g id="g305879" style="stroke-width:1.5291"><path d="m123.194 265.125c-.891-.001-1.714-.478-2.158-1.252-.443-.773-.44-1.725.01-2.495l17.437-29.893c.447-.764 1.265-1.235 2.151-1.235h12.455c1.376.0 2.491 1.115 2.491 2.491s-1.115 2.491-2.491 2.491h-11.023l-16.718 28.657c-.447.766-1.267 1.237-2.154 1.236z" id="path305869" fill="#dadcde" style="stroke-width:2.9227"/><path d="m140.634 369.75h-9.964c-1.218.0-2.257-.88-2.457-2.082l-4.983-29.892c-.153-.881.178-1.776.867-2.346.689-.57 1.631-.727 2.467-.411.836.315 1.44 1.055 1.581 1.938l4.635 27.811h7.854c1.376.0 2.491 1.115 2.491 2.491s-1.115 2.491-2.491 2.491z" id="path305871" fill="#dadcde" style="stroke-width:2.9227"/><path d="m43.482 347.33c-1.376.0-2.491-1.115-2.491-2.491v-12.455c0-.757.344-1.472.934-1.945L66.836 310.51c1.074-.86 2.642-.686 3.502.388.86 1.075.686 2.643-.388 3.503l-23.977 19.181v11.257c0 1.376-1.115 2.491-2.491 2.491z" id="path305873" fill="#dadcde" style="stroke-width:2.9227"/><path d="m70.882 265.125c-.492.0-.972-.146-1.38-.419l-14.946-9.964c-.693-.462-1.109-1.24-1.11-2.072v-17.438c0-1.376 1.116-2.491 2.491-2.491 1.376.0 2.492 1.115 2.492 2.491v16.105l13.837 9.224c.913.61 1.32 1.745 1.002 2.796-.319 1.051-1.288 1.769-2.386 1.768z" id="path305875" fill="#dadcde" style="stroke-width:2.9227"/><path d="m168.036 324.911h-24.911c-1.376.0-2.491-1.116-2.491-2.491.0-1.376 1.115-2.491 2.491-2.491h24.911c1.375.0 2.491 1.115 2.491 2.491.0 1.375-1.116 2.491-2.491 2.491z" id="path305877" fill="#dadcde" style="stroke-width:2.9227"/></g><path d="m163.054 307.473v-14.946h-10.587c-1.145-6.815-3.856-13.27-7.922-18.857l6.053-6.054-9.964-9.964-6.054 6.053c-5.587-4.065-12.042-6.777-18.857-7.922v-10.587h-14.946v10.587c-6.815 1.145-13.27 3.856-18.857 7.922l-6.054-6.053-9.964 9.964 6.053 6.054c-4.065 5.587-6.777 12.042-7.922 18.857H53.446v14.946h10.587c1.145 6.815 3.856 13.27 7.922 18.857l-6.053 6.054 9.964 9.964 6.054-6.053c5.587 4.065 12.042 6.777 18.857 7.922v10.587h14.946v-10.587c6.815-1.145 13.27-3.856 18.857-7.922l6.054 6.053 9.964-9.964-6.053-6.054c4.065-5.587 6.777-12.042 7.922-18.857z" id="path305881" fill="#082361" style="stroke-width:2.9227"/><circle vector-effect="non-scaling-stroke" cx="108.25" cy="300" r="34.875" id="Ellipse" fill="#eefafe" style="stroke-width:2.9227"/><circle vector-effect="non-scaling-stroke" cx="158.07143" cy="232.74107" r="4.9821429" id="circle305884" fill="#082361" style="stroke-width:2.9227"/><circle vector-effect="non-scaling-stroke" cx="145.61607" cy="367.25894" r="4.9821429" id="circle305886" fill="#082361" style="stroke-width:2.9227"/><circle vector-effect="non-scaling-stroke" cx="43.482143" cy="347.33035" r="4.9821429" id="circle305888" fill="#082361" style="stroke-width:2.9227"/><circle vector-effect="non-scaling-stroke" cx="173.01785" cy="322.41965" r="4.9821429" id="circle305890" fill="#082361" style="stroke-width:2.9227"/><circle vector-effect="non-scaling-stroke" cx="55.9375" cy="232.74107" r="4.9821429" id="circle305892" fill="#082361" style="stroke-width:2.9227"/><path d="m79.396 308.519v-15.856h3.19v13.363h6.628v2.493zm12.59.0v-15.856h3.19v13.363h6.628v2.493zm19.475.0h-6.885v-15.856h6.875v0q2.299.0 3.566.736v0 0q1.268.736 1.773 1.987v0 0q.505 1.252.505 2.809v0 4.867.0q0 1.579-.532 2.814v0 0q-.532 1.235-1.8 1.939v0 0q-1.267.704-3.502.704zm-3.695-13.374v10.892h3.416v0q1.687.0 2.304-.623v0 0q.618-.623.618-1.944v0-5.694.0q0-1.289-.628-1.96v0 0q-.629-.671-2.294-.671v0zm20.163 13.374h-6.875v-15.856h6.102v0q2.223.0 3.443.451v0 0q1.219.451 1.697 1.37v0 0q.478.918.478 2.347v0 0q0 1.214-.397 1.977v0 0q-.398.762-1.633 1.074v0 0q1.095.15 1.681.66v0 0q.585.511.806 1.316v0 0q.22.806.22 1.848v0 0q0 2.492-1.284 3.652v0 0q-1.284 1.161-4.238 1.161zm-3.684-13.675v4.2h3.298v0q.934.0 1.348-.247v0 0q.413-.247.521-.736v0 0q.107-.489.107-1.198v0 0q0-.838-.193-1.273v0 0q-.194-.435-.741-.59v0 0q-.548-.156-1.633-.156v0zm0 6.123v5.317h3.093v0q1.247.0 1.875-.204v0 0q.628-.204.843-.779v0 0q.215-.574.215-1.67v0 0q0-.795-.156-1.391v0 0q-.155-.596-.709-.935v0 0q-.553-.338-1.745-.338v0z" id="Compound Path-8" fill="#082361" style="stroke-width:2.9227"/></g><g id="g312049" transform="matrix(0.56242975,0,0,0.56242975,-59.497756,60.063649)" style="stroke-width:1.778"><circle style="opacity:1;fill:#ef6456;fill-opacity:1;stroke:none;stroke-width:3.556;stroke-linecap:square;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="path308341" transform="matrix(0.26458333,0,0,0.26458333,-1.3481375,32.422202)" cy="89.999992" cx="520" r="83.999992"/><g id="g298608" transform="matrix(0.16905373,0,0,0.16905373,65.469304,27.580092)" style="stroke-width:2.78271"><path fill="#ef6456" d="m9 7v9.8h19v7.4H9V39H0V0H28.1L28 7z" id="path298598" style="fill:#fafafa;fill-opacity:1;stroke-width:2.78271" transform="translate(316.39999,150)"/><path fill="#ef6456" d="M51.4 39H41.3L49.7 26.1C44.9 23.8 42.3 19.6 42.3 13.5 42.3 4.8 48.2.0 58.5.0H76V39H67V28H58.5 57.7zM67 20V7h-8.5c-4.9.0-7.7 2-7.7 6.4.0 4.5 2.8 6.6 7.7 6.6z" id="path298600" style="fill:#fafafa;fill-opacity:1;stroke-width:2.78271" transform="translate(316.39999,150)"/><path fill="#ef6456" d="M92 39V0h9v39z" id="path298602" style="fill:#fafafa;fill-opacity:1;stroke-width:2.78271" transform="translate(316.39999,150)"/><path fill="#ef6456" d="M134.8.0c12.2.0 20.8 7.8 20.8 19.5C155.6 31.1 147 39 134.5 39H118V0zM127 32h8c6.6.0 11.4-5.2 11.4-12.4C146.4 12.3 141.3 7 134.6 7H127z" id="path298604" style="fill:#fafafa;fill-opacity:1;stroke-width:2.78271" transform="translate(316.39999,150)"/><path fill="#ef6456" d="m173.5 31-3.1 8h-9.2L178.3.0h9.2l16.9 39h-9.5l-3.1-8zM182.7 8.7 176.4 24h12.5z" id="path298606" style="fill:#fafafa;fill-opacity:1;stroke-width:2.78271" transform="translate(316.39999,150)"/></g></g><g id="g317386" transform="translate(1.3229174,3.3072917)"><g id="g320058" transform="translate(-0.6304527,-1.3542578)"><g id="g317379" transform="translate(-4.9999562e-8,0.66145864)"><rect style="opacity:1;fill:url(#linearGradient317433);fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect313837" width="132.38281" height="25.118452" x="124.99999" y="42.499996" transform="matrix(0.26458333,0,0,0.26458333,1.8610598e-8,-1.9843741)" ry="0"/><text transform="matrix(0.26458333,0,0,0.26458333,3.1074741,-1.8015517)" id="text314150" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:18.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect314152);display:inline;opacity:1;fill:#fff;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="135" y="61.103946" id="tspan345065">Jailbreak</tspan></text></g><g id="g320048"><path style="opacity:1;fill:none;fill-opacity:1;stroke:#5d2e1f;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m129.99999 79.999996h-5V44.999998h5" id="path319793" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/><path style="opacity:1;fill:none;fill-opacity:1;stroke:#5d2e1f;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m134.99999 44.999998h40" id="path320041" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/><path style="opacity:1;fill:none;fill-opacity:1;stroke:#5d2e1f;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m134.99999 79.999996h40" id="path320043" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/></g></g><g id="g320076" transform="translate(-0.6304527,36.90592)"><g id="g320066" transform="translate(-4.9999562e-8,0.66145864)"><rect style="opacity:1;fill:url(#linearGradient320080);fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect320060" width="132.38281" height="25.513048" x="124.99999" y="42.499996" transform="matrix(0.26458333,0,0,0.26458333,1.8610598e-8,-2.0522466)" ry="0"/><text transform="matrix(0.26458333,0,0,0.26458333,2.8180861,-2.3031585)" id="text320064" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:18.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect320078);display:inline;opacity:1;fill:#fff;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="135" y="61.103946" id="tspan345067">Debugger</tspan></text></g><g id="g320074"><path style="opacity:1;fill:none;fill-opacity:1;stroke:#082361;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m129.99999 79.999996h-5V44.999998h5" id="path320068" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/><path style="opacity:1;fill:none;fill-opacity:1;stroke:#082361;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m134.99999 44.999998h40" id="path320070" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/><path style="opacity:1;fill:none;fill-opacity:1;stroke:#082361;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m134.99999 79.999996h40" id="path320072" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/></g></g><g id="g321191" transform="translate(-0.6304527,75.15526)"><g id="g321181" transform="translate(-4.9999562e-8,0.66145864)"><rect style="opacity:1;fill:url(#linearGradient321195);fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect321175" width="132.38281" height="25.948605" x="124.99999" y="42.499996" transform="matrix(0.26458333,0,0,0.26458333,1.8610598e-8,-1.9843741)" ry="0"/><text transform="matrix(0.26458333,0,0,0.26458333,2.8180853,-1.8003459)" id="text321179" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:18.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect321193);display:inline;opacity:1;fill:#fff;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="135" y="61.103946" id="tspan345069">Frida</tspan></text></g><g id="g321189"><path style="opacity:1;fill:none;fill-opacity:1;stroke:#ef6456;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m129.99999 79.999996h-5V44.999998h5" id="path321183" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/><path style="opacity:1;fill:none;fill-opacity:1;stroke:#ef6456;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m134.99999 44.999998h40" id="path321185" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/><path style="opacity:1;fill:none;fill-opacity:1;stroke:#ef6456;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m134.99999 79.999996h40" id="path321187" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/></g></g></g><g id="g324215" transform="matrix(0.04882812,0,0,0.04882812,76.281245,40.416668)" style="stroke-width:5.41865"><path d="m258.271 372.002h-4.542c-29.09.0-53.208-22.749-54.906-51.789L183.501 58.211C182.621 43.156 188.05 28.232 198.397 17.262 208.744 6.291 223.327.0 238.407.0h35.186c15.079.0 29.662 6.291 40.009 17.261 10.348 10.97 15.777 25.896 14.898 40.949l-15.321 262.003c-1.7 29.041-25.819 51.789-54.908 51.789z" fill="#ff674f" id="path324180" style="fill:#ef6456;fill-opacity:1;stroke-width:17.7277"/><path d="m258.271 372.002c29.09.0 53.208-22.748 54.907-51.789L328.499 58.21C329.379 43.156 323.949 28.231 313.602 17.261 303.255 6.291 288.672.0 273.593.0H256v372.002z" fill="#f2472c" id="path324182" style="fill:#f2472c;fill-opacity:1;stroke-width:17.7277"/><g id="g329724" style="display:inline" sodipodi:insensitive="true"><path d="m256 512c-30.327.0-55-24.673-55-54.999.0-30.327 24.673-55 55-55s55 24.673 55 54.999c0 30.327-24.673 55-55 55z" fill="#ff674f" id="path324184" style="fill:#ef6456;fill-opacity:1;stroke-width:17.7277"/><path d="M256 402.001V512c30.327.0 55-24.673 55-55 0-30.326-24.673-54.999-55-54.999z" fill="#f2472c" id="path324186" style="stroke-width:17.7277"/></g><g id="g329712" transform="matrix(0.47147316,0,0,0.47147316,98.120179,303.30358)" style="stroke-width:11.493"><path d="m151.414 401.758c-5.162.0-10.184-2.665-12.972-7.445C126.377 373.625 120 350 120 325.993c0-24.008 6.377-47.633 18.442-68.32 4.173-7.155 13.356-9.577 20.514-5.4 7.156 4.173 9.574 13.357 5.401 20.514C154.964 288.892 150 307.29 150 325.993c0 18.702 4.964 37.101 14.357 53.206 4.173 7.156 1.755 16.341-5.401 20.515-2.376 1.385-4.977 2.044-7.542 2.044z" fill="#ff9300" id="path324188" style="fill:#ef6456;fill-opacity:1;stroke-width:37.6007"/><path d="m99.545 431.889c-5.162.0-10.184-2.665-12.972-7.445C69.189 394.632 60 360.589 60 325.993s9.189-68.639 26.574-98.45c4.172-7.156 13.357-9.575 20.514-5.401 7.157 4.174 9.575 13.358 5.401 20.515C97.776 267.885 90 296.702 90 325.993s7.776 58.108 22.489 83.337c4.173 7.156 1.755 16.341-5.401 20.515-2.377 1.385-4.977 2.044-7.543 2.044z" fill="#ffb500" id="path324190" style="fill:#5d2e1f;fill-opacity:1;stroke-width:37.6007"/><path d="m47.601 462.065c-5.166.0-10.191-2.67-12.978-7.456C11.973 415.702.0 371.228.0 325.993c0-45.233 11.973-89.709 34.623-128.616 4.168-7.159 13.351-9.586 20.51-5.416 7.159 4.168 9.584 13.351 5.417 20.51C40.564 246.801 30 286.056 30 325.993s10.564 79.192 30.55 113.521c4.168 7.159 1.743 16.342-5.417 20.51-2.373 1.382-4.97 2.041-7.532 2.041z" fill="#ffe645" id="path324192" style="fill:#082361;fill-opacity:1;stroke-width:37.6007"/></g><g id="g329720" transform="matrix(-0.47147316,0,0,0.47147316,413.87983,303.30358)" style="stroke-width:11.493"><path d="m151.414 401.758c-5.162.0-10.184-2.665-12.972-7.445C126.377 373.625 120 350 120 325.993c0-24.008 6.377-47.633 18.442-68.32 4.173-7.155 13.356-9.577 20.514-5.4 7.156 4.173 9.574 13.357 5.401 20.514C154.964 288.892 150 307.29 150 325.993c0 18.702 4.964 37.101 14.357 53.206 4.173 7.156 1.755 16.341-5.401 20.515-2.376 1.385-4.977 2.044-7.542 2.044z" fill="#ff9300" id="path329714" style="fill:#ef6456;fill-opacity:1;stroke-width:37.6007"/><path d="m99.545 431.889c-5.162.0-10.184-2.665-12.972-7.445C69.189 394.632 60 360.589 60 325.993s9.189-68.639 26.574-98.45c4.172-7.156 13.357-9.575 20.514-5.401 7.157 4.174 9.575 13.358 5.401 20.515C97.776 267.885 90 296.702 90 325.993s7.776 58.108 22.489 83.337c4.173 7.156 1.755 16.341-5.401 20.515-2.377 1.385-4.977 2.044-7.543 2.044z" fill="#ffb500" id="path329716" style="fill:#5d2e1f;fill-opacity:1;stroke-width:37.6007"/><path d="m47.601 462.065c-5.166.0-10.191-2.67-12.978-7.456C11.973 415.702.0 371.228.0 325.993c0-45.233 11.973-89.709 34.623-128.616 4.168-7.159 13.351-9.586 20.51-5.416 7.159 4.168 9.584 13.351 5.417 20.51C40.564 246.801 30 286.056 30 325.993s10.564 79.192 30.55 113.521c4.168 7.159 1.743 16.342-5.417 20.51-2.373 1.382-4.97 2.041-7.532 2.041z" fill="#ffe645" id="path329718" style="fill:#082361;fill-opacity:1;stroke-width:37.6007"/></g></g><text transform="matrix(0.26458333,0,0,0.26458333,-4.3695157,-34.137462)" id="text327887" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:18.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect327889);display:inline;opacity:1;fill:#f2472c;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="290" y="271.10395" id="tspan345071">User callback</tspan></text><g id="g329732" transform="matrix(-0.54601663,0.00596022,0.00596022,0.54601663,122.20109,42.974237)" style="stroke-width:1.83132"><path d="m151.414 401.758c-5.162.0-10.184-2.665-12.972-7.445C126.377 373.625 120 350 120 325.993c0-24.008 6.377-47.633 18.442-68.32 4.173-7.155 13.356-9.577 20.514-5.4 7.156 4.173 9.574 13.357 5.401 20.514C154.964 288.892 150 307.29 150 325.993c0 18.702 4.964 37.101 14.357 53.206 4.173 7.156 1.755 16.341-5.401 20.515-2.376 1.385-4.977 2.044-7.542 2.044z" fill="#ff9300" id="path329726" style="fill:#082361;fill-opacity:1;stroke-width:32.4654" transform="matrix(0.04882812,0,0,0.04882812,87.611268,2.7352504)"/><path d="m99.545 431.889c-5.162.0-10.184-2.665-12.972-7.445C69.189 394.632 60 360.589 60 325.993s9.189-68.639 26.574-98.45c4.172-7.156 13.357-9.575 20.514-5.401 7.157 4.174 9.575 13.358 5.401 20.515C97.776 267.885 90 296.702 90 325.993s7.776 58.108 22.489 83.337c4.173 7.156 1.755 16.341-5.401 20.515-2.377 1.385-4.977 2.044-7.543 2.044z" fill="#ffb500" id="path329728" style="fill:#082361;fill-opacity:1;stroke-width:32.4654" transform="matrix(0.04882812,0,0,0.04882812,87.611268,2.7352504)"/><path d="m47.601 462.065c-5.166.0-10.191-2.67-12.978-7.456C11.973 415.702.0 371.228.0 325.993c0-45.233 11.973-89.709 34.623-128.616 4.168-7.159 13.351-9.586 20.51-5.416 7.159 4.168 9.584 13.351 5.417 20.51C40.564 246.801 30 286.056 30 325.993s10.564 79.192 30.55 113.521c4.168 7.159 1.743 16.342-5.417 20.51-2.373 1.382-4.97 2.041-7.532 2.041z" fill="#ffe645" id="path329730" style="fill:#082361;fill-opacity:1;stroke-width:32.4654" transform="matrix(0.04882812,0,0,0.04882812,87.611268,2.7352504)"/></g><g id="g330859" transform="matrix(-0.39030657,-0.38187755,-0.38187755,0.39030657,114.55623,49.081724)" style="stroke-width:1.83132"><path d="m151.414 401.758c-5.162.0-10.184-2.665-12.972-7.445C126.377 373.625 120 350 120 325.993c0-24.008 6.377-47.633 18.442-68.32 4.173-7.155 13.356-9.577 20.514-5.4 7.156 4.173 9.574 13.357 5.401 20.514C154.964 288.892 150 307.29 150 325.993c0 18.702 4.964 37.101 14.357 53.206 4.173 7.156 1.755 16.341-5.401 20.515-2.376 1.385-4.977 2.044-7.542 2.044z" fill="#ff9300" id="path330853" style="fill:#5d2e1f;fill-opacity:1;stroke-width:32.4654" transform="matrix(0.04882812,0,0,0.04882812,87.611268,2.7352504)"/><path d="m99.545 431.889c-5.162.0-10.184-2.665-12.972-7.445C69.189 394.632 60 360.589 60 325.993s9.189-68.639 26.574-98.45c4.172-7.156 13.357-9.575 20.514-5.401 7.157 4.174 9.575 13.358 5.401 20.515C97.776 267.885 90 296.702 90 325.993s7.776 58.108 22.489 83.337c4.173 7.156 1.755 16.341-5.401 20.515-2.377 1.385-4.977 2.044-7.543 2.044z" fill="#ffb500" id="path330855" style="fill:#5d2e1f;fill-opacity:1;stroke-width:32.4654" transform="matrix(0.04882812,0,0,0.04882812,87.611268,2.7352504)"/><path d="m47.601 462.065c-5.166.0-10.191-2.67-12.978-7.456C11.973 415.702.0 371.228.0 325.993c0-45.233 11.973-89.709 34.623-128.616 4.168-7.159 13.351-9.586 20.51-5.416 7.159 4.168 9.584 13.351 5.417 20.51C40.564 246.801 30 286.056 30 325.993s10.564 79.192 30.55 113.521c4.168 7.159 1.743 16.342-5.417 20.51-2.373 1.382-4.97 2.041-7.532 2.041z" fill="#ffe645" id="path330857" style="fill:#5d2e1f;fill-opacity:1;stroke-width:32.4654" transform="matrix(0.04882812,0,0,0.04882812,87.611268,2.7352504)"/></g><g id="g330875" transform="matrix(-0.39030657,0.38187755,-0.38187755,-0.39030657,114.58291,57.797449)" style="stroke-width:1.83132"><path d="m151.414 401.758c-5.162.0-10.184-2.665-12.972-7.445C126.377 373.625 120 350 120 325.993c0-24.008 6.377-47.633 18.442-68.32 4.173-7.155 13.356-9.577 20.514-5.4 7.156 4.173 9.574 13.357 5.401 20.514C154.964 288.892 150 307.29 150 325.993c0 18.702 4.964 37.101 14.357 53.206 4.173 7.156 1.755 16.341-5.401 20.515-2.376 1.385-4.977 2.044-7.542 2.044z" fill="#ff9300" id="path330869" style="fill:#ef6456;fill-opacity:1;stroke-width:32.4654" transform="matrix(0.04882812,0,0,0.04882812,87.611268,2.7352504)"/><path d="m99.545 431.889c-5.162.0-10.184-2.665-12.972-7.445C69.189 394.632 60 360.589 60 325.993s9.189-68.639 26.574-98.45c4.172-7.156 13.357-9.575 20.514-5.401 7.157 4.174 9.575 13.358 5.401 20.515C97.776 267.885 90 296.702 90 325.993s7.776 58.108 22.489 83.337c4.173 7.156 1.755 16.341-5.401 20.515-2.377 1.385-4.977 2.044-7.543 2.044z" fill="#ffb500" id="path330871" style="fill:#ef6456;fill-opacity:1;stroke-width:32.4654" transform="matrix(0.04882812,0,0,0.04882812,87.611268,2.7352504)"/><path d="m47.601 462.065c-5.166.0-10.191-2.67-12.978-7.456C11.973 415.702.0 371.228.0 325.993c0-45.233 11.973-89.709 34.623-128.616 4.168-7.159 13.351-9.586 20.51-5.416 7.159 4.168 9.584 13.351 5.417 20.51C40.564 246.801 30 286.056 30 325.993s10.564 79.192 30.55 113.521c4.168 7.159 1.743 16.342-5.417 20.51-2.373 1.382-4.97 2.041-7.532 2.041z" fill="#ffe645" id="path330873" style="fill:#ef6456;fill-opacity:1;stroke-width:32.4654" transform="matrix(0.04882812,0,0,0.04882812,87.611268,2.7352504)"/></g></g><g id="g334905" transform="matrix(-1,0,0,1,345.74979,4.251815)"><g id="g334724"><g id="cydia-0" style="isolation:isolate;stroke-width:1.37583" transform="matrix(-0.19230769,0,0,0.19230769,165.46883,-50.63901)"><g id="g896-9" style="stroke-width:1.37583"><path d="M59.21 384.685C52.786 383.127 47.278 377.772 45.639 371.491 45.051 369.239 45 365.174 45 320.17c0-45.004.051-49.069.639-51.321 1.683-6.448 7.496-11.932 14.11-13.311 2.773-.578 97.729-.578 100.502.0 6.614 1.379 12.427 6.863 14.11 13.311.588 2.252.639 6.317.639 51.321s-.051 49.069-.639 51.321c-1.683 6.448-7.496 11.932-14.11 13.311-2.99.623-98.444.513-101.041-.117z" id="path875-9" fill="#5d2e1f" style="stroke-width:2.36614"/><g id="g302028-4" style="stroke-width:1.37583"><path d="m117.991 365.337c16.201-3.392 29.388-14.971 34.512-30.305 1.714-5.126 2.261-8.679 2.261-14.676.0-3.932-.196-6.506-.665-8.735-3.925-18.641-17.617-32.335-36.294-36.299-4.352-.924-13.116-.924-17.469.0-18.676 3.964-32.368 17.658-36.293 36.299-.915 4.345-.915 13.125.0 17.469 3.336 15.845 13.702 28.199 28.561 34.039 7.615 2.993 17.521 3.855 25.387 2.208z" id="path873-5" fill="#fff" style="stroke-width:2.36614"/></g><path d="M100.868 360.293c-15.098-3.173-27.102-14.482-31.223-29.416-1.184-4.29-1.609-11.963-.923-16.655 1.838-12.567 9.962-23.851 21.653-30.072 11.266-5.995 26.125-5.995 37.392.0 7.786 4.144 14.161 10.663 18.078 18.484 5.075 10.138 5.235 24.045.396 34.518-4.522 9.788-13.051 17.744-23.009 21.466-6.557 2.45-15.492 3.119-22.364 1.675z" id="path871-1" fill="#5d2e1f" style="stroke-width:2.36614"/><g id="g302047-0" style="stroke-width:1.37583"><path d="m124.495 346.447 8.363-3.495.103-5.258c.057-2.892-.045-5.259-.226-5.259s-5.432 2.068-11.668 4.595l-11.338 4.596-.68-1.158c-.374-.636-1.315-2.16-2.091-3.387l-1.411-2.23-.004 9.731-.003 9.731 5.296-2.186c2.913-1.202 9.06-3.758 13.659-5.68z" id="path869-3" fill="#fff" style="stroke-width:2.36614"/><path d="m102.938 342.099c0-8.08-.121-11.522-.406-11.522-.223.0-3.237.931-6.699 2.069l-6.293 2.069-2.407-1.915-2.407-1.916v5.051 5.05l1.928 1.393c6.395 4.623 15.768 11.19 16.005 11.214.154.016.279-5.156.279-11.493z" id="path867-7" fill="#faf9f9" style="stroke-width:2.36614"/><path d="m135.744 328.388c.227-.22-1.43-9.224-1.772-9.627-.068-.08-22.907 8.379-27.41 10.152-.358.141-.65.39-.65.554.0.254 3.489 6.339 5.036 8.782.498.788.631.742 12.508-4.395 6.602-2.855 12.132-5.315 12.288-5.466z" id="path865-8" fill="#fff" style="stroke-width:2.36614"/><path d="m98.061 329.754 2.371-.891-8.689-7.427c-4.78-4.084-8.893-7.552-9.142-7.705-.447-.277-7.724 5.418-7.724 6.045.0.165 3.412 3.144 7.583 6.619l7.584 6.318 2.823-1.034c1.553-.569 3.89-1.435 5.194-1.925z" id="path863-8" fill="#fff" style="stroke-width:2.36614"/><path d="m117.053 322.777c-.012-.282-7.147-3.354-7.784-3.352-.997.003-11.58 4.565-11.276 4.86.165.16 1.437 1.194 2.828 2.298l2.529 2.008 6.856-2.812c3.771-1.546 6.852-2.897 6.847-3.002z" id="path861-6" fill="#fff" style="stroke-width:2.36614"/><path d="m102.84 320.289 5.302-2.111v-1.977c0-1.088-.126-1.981-.279-1.985-.153-.004-2.746 1.036-5.761 2.309l-5.482 2.316v1.78c0 1.165.158 1.779.459 1.779.253.0 2.845-.95 5.761-2.111z" id="path859-0" fill="#fff" style="stroke-width:2.36614"/><path d="m118.992 319.705c-.088-1.277-.189-2.357-.224-2.399-.034-.042-1.937-.912-4.229-1.933l-4.167-1.857v2.026c0 1.115-.02 2.152-.044 2.305-.035.229 7.923 4.066 8.616 4.155.115.014.137-1.019.048-2.297z" id="path857-4" fill="#fff" style="stroke-width:2.36614"/><path d="m95.115 319.891-.018-1.765-4.688-3.345c-6.179-4.409-5.758-4.2-5.616-2.802.099.973.92 1.868 4.951 5.394 2.657 2.325 4.957 4.239 5.11 4.255.154.016.271-.766.261-1.737z" id="path855-6" fill="#fff" style="stroke-width:2.36614"/><path d="m127.163 319.342 4.711-1.84.12-2.941c.066-1.618.08-2.941.031-2.94-.05.0-2.684 1.294-5.854 2.875l-5.764 2.875.005 1.307c.003.718.107 1.687.232 2.153.267.999-.022 1.065 6.519-1.489z" id="path853-7" fill="#fff" style="stroke-width:2.36614"/><path d="m101.567 315.114c2.696-1.145 5.021-2.192 5.167-2.327.273-.253-11.548-7.856-12.215-7.856-.733.0-9.606 3.627-9.548 3.903.053.253 11.272 8.363 11.569 8.363.069.0 2.33-.937 5.027-2.083z" id="path851-6" fill="#fff" style="stroke-width:2.36614"/><path d="m126.539 312.929c1.636-.756 3.377-1.532 3.869-1.725.829-.326.608-.528-3.043-2.769l-3.938-2.416-6.249 3.141-6.249 3.141 1.301.554c.716.304 2.705 1.135 4.421 1.846l3.121 1.292 1.897-.846c1.043-.465 3.235-1.463 4.87-2.218z" id="path849-0" fill="#fff" style="stroke-width:2.36614"/><path d="m139.331 307.388c-.257-.239-15.928-8.032-16.153-8.032-.114.0-.158.878-.096 1.952l.112 1.951 5.195 3.234c5.434 3.382 6.141 3.998 6.141 5.349.0.674.447.359 2.478-1.744 1.362-1.411 2.408-2.631 2.323-2.71z" id="path847-9" fill="#fff" style="stroke-width:2.36614"/><path d="m88.925 305.222 5.651-2.415 1.553 1.062c.855.584 1.649 1.062 1.766 1.062.116.0.211-1.303.211-2.896v-2.896l3.171-1.428c1.745-.786 3.115-1.484 3.047-1.553-.096-.096-11.027 4.215-23.201 9.152l-.816.331 1.373 2.966 1.374 2.967.11-1.969.11-1.968z" id="path845-7" fill="#fff" style="stroke-width:2.36614"/><path d="m108.414 306.348c-.207-.511-8.385-4.95-8.644-4.691-.082.082-.029 1.219.116 2.528l.265 2.379 3.902 2.345 3.903 2.345.327-2.209c.18-1.215.239-2.428.131-2.697z" id="path843-5" fill="#fff" style="stroke-width:2.36614"/><path d="m115.801 308.063 5.349-2.815v-2.202c0-1.53-.142-2.194-.464-2.174-.256.015-2.723 1.144-5.483 2.508l-5.017 2.48-.11 2.509c-.061 1.38-.001 2.509.133 2.509s2.65-1.267 5.592-2.815z" id="path841-9" fill="#fff" style="stroke-width:2.36614"/><path d="m114.832 301.982 5.017-2.538-1.301-.548c-.715-.301-2.752-1.18-4.526-1.953l-3.227-1.405-4.579 1.976c-2.518 1.087-4.721 2.096-4.895 2.244-.315.267 7.415 4.819 8.121 4.782.205-.011 2.63-1.162 5.39-2.558z" id="path837-7" fill="#fff" style="stroke-width:2.36614"/></g></g></g><g id="debug-8" style="isolation:isolate;stroke-width:1.5291" transform="matrix(-0.17303175,0,0,0.17303175,163.04567,-2.7189643)"><g id="g305879-5" style="stroke-width:1.5291"><path d="m123.194 265.125c-.891-.001-1.714-.478-2.158-1.252-.443-.773-.44-1.725.01-2.495l17.437-29.893c.447-.764 1.265-1.235 2.151-1.235h12.455c1.376.0 2.491 1.115 2.491 2.491s-1.115 2.491-2.491 2.491h-11.023l-16.718 28.657c-.447.766-1.267 1.237-2.154 1.236z" id="path305869-3" fill="#dadcde" style="stroke-width:2.9227"/><path d="m140.634 369.75h-9.964c-1.218.0-2.257-.88-2.457-2.082l-4.983-29.892c-.153-.881.178-1.776.867-2.346.689-.57 1.631-.727 2.467-.411.836.315 1.44 1.055 1.581 1.938l4.635 27.811h7.854c1.376.0 2.491 1.115 2.491 2.491s-1.115 2.491-2.491 2.491z" id="path305871-3" fill="#dadcde" style="stroke-width:2.9227"/><path d="m43.482 347.33c-1.376.0-2.491-1.115-2.491-2.491v-12.455c0-.757.344-1.472.934-1.945L66.836 310.51c1.074-.86 2.642-.686 3.502.388.86 1.075.686 2.643-.388 3.503l-23.977 19.181v11.257c0 1.376-1.115 2.491-2.491 2.491z" id="path305873-8" fill="#dadcde" style="stroke-width:2.9227"/><path d="m70.882 265.125c-.492.0-.972-.146-1.38-.419l-14.946-9.964c-.693-.462-1.109-1.24-1.11-2.072v-17.438c0-1.376 1.116-2.491 2.491-2.491 1.376.0 2.492 1.115 2.492 2.491v16.105l13.837 9.224c.913.61 1.32 1.745 1.002 2.796-.319 1.051-1.288 1.769-2.386 1.768z" id="path305875-3" fill="#dadcde" style="stroke-width:2.9227"/><path d="m168.036 324.911h-24.911c-1.376.0-2.491-1.116-2.491-2.491.0-1.376 1.115-2.491 2.491-2.491h24.911c1.375.0 2.491 1.115 2.491 2.491.0 1.375-1.116 2.491-2.491 2.491z" id="path305877-7" fill="#dadcde" style="stroke-width:2.9227"/></g><path d="m163.054 307.473v-14.946h-10.587c-1.145-6.815-3.856-13.27-7.922-18.857l6.053-6.054-9.964-9.964-6.054 6.053c-5.587-4.065-12.042-6.777-18.857-7.922v-10.587h-14.946v10.587c-6.815 1.145-13.27 3.856-18.857 7.922l-6.054-6.053-9.964 9.964 6.053 6.054c-4.065 5.587-6.777 12.042-7.922 18.857H53.446v14.946h10.587c1.145 6.815 3.856 13.27 7.922 18.857l-6.053 6.054 9.964 9.964 6.054-6.053c5.587 4.065 12.042 6.777 18.857 7.922v10.587h14.946v-10.587c6.815-1.145 13.27-3.856 18.857-7.922l6.054 6.053 9.964-9.964-6.053-6.054c4.065-5.587 6.777-12.042 7.922-18.857z" id="path305881-9" fill="#082361" style="stroke-width:2.9227"/><circle vector-effect="non-scaling-stroke" cx="108.25" cy="300" r="34.875" id="Ellipse-3" fill="#eefafe" style="stroke-width:2.9227"/><circle vector-effect="non-scaling-stroke" cx="158.07143" cy="232.74107" r="4.9821429" id="circle305884-7" fill="#082361" style="stroke-width:2.9227"/><circle vector-effect="non-scaling-stroke" cx="145.61607" cy="367.25894" r="4.9821429" id="circle305886-8" fill="#082361" style="stroke-width:2.9227"/><circle vector-effect="non-scaling-stroke" cx="43.482143" cy="347.33035" r="4.9821429" id="circle305888-7" fill="#082361" style="stroke-width:2.9227"/><circle vector-effect="non-scaling-stroke" cx="173.01785" cy="322.41965" r="4.9821429" id="circle305890-4" fill="#082361" style="stroke-width:2.9227"/><circle vector-effect="non-scaling-stroke" cx="55.9375" cy="232.74107" r="4.9821429" id="circle305892-1" fill="#082361" style="stroke-width:2.9227"/><path d="m79.396 308.519v-15.856h3.19v13.363h6.628v2.493zm12.59.0v-15.856h3.19v13.363h6.628v2.493zm19.475.0h-6.885v-15.856h6.875v0q2.299.0 3.566.736v0 0q1.268.736 1.773 1.987v0 0q.505 1.252.505 2.809v0 4.867.0q0 1.579-.532 2.814v0 0q-.532 1.235-1.8 1.939v0 0q-1.267.704-3.502.704zm-3.695-13.374v10.892h3.416v0q1.687.0 2.304-.623v0 0q.618-.623.618-1.944v0-5.694.0q0-1.289-.628-1.96v0 0q-.629-.671-2.294-.671v0zm20.163 13.374h-6.875v-15.856h6.102v0q2.223.0 3.443.451v0 0q1.219.451 1.697 1.37v0 0q.478.918.478 2.347v0 0q0 1.214-.397 1.977v0 0q-.398.762-1.633 1.074v0 0q1.095.15 1.681.66v0 0q.585.511.806 1.316v0 0q.22.806.22 1.848v0 0q0 2.492-1.284 3.652v0 0q-1.284 1.161-4.238 1.161zm-3.684-13.675v4.2h3.298v0q.934.0 1.348-.247v0 0q.413-.247.521-.736v0 0q.107-.489.107-1.198v0 0q0-.838-.193-1.273v0 0q-.194-.435-.741-.59v0 0q-.548-.156-1.633-.156v0zm0 6.123v5.317h3.093v0q1.247.0 1.875-.204v0 0q.628-.204.843-.779v0 0q.215-.574.215-1.67v0 0q0-.795-.156-1.391v0 0q-.155-.596-.709-.935v0 0q-.553-.338-1.745-.338v0z" id="Compound Path-8-9" fill="#082361" style="stroke-width:2.9227"/></g><g id="g312049-0" transform="matrix(-0.56242975,0,0,0.56242975,220.93772,55.811834)" style="stroke-width:1.778"><circle style="opacity:1;fill:#ef6456;fill-opacity:1;stroke:none;stroke-width:3.556;stroke-linecap:square;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" id="path308341-9" transform="matrix(0.26458333,0,0,0.26458333,-1.3481375,32.422202)" cy="89.999992" cx="520" r="83.999992"/><g id="g298608-8" transform="matrix(0.16905373,0,0,0.16905373,65.469304,27.580092)" style="stroke-width:2.78271"><path fill="#ef6456" d="m9 7v9.8h19v7.4H9V39H0V0H28.1L28 7z" id="path298598-8" style="fill:#fafafa;fill-opacity:1;stroke-width:2.78271" transform="translate(316.39999,150)"/><path fill="#ef6456" d="M51.4 39H41.3L49.7 26.1C44.9 23.8 42.3 19.6 42.3 13.5 42.3 4.8 48.2.0 58.5.0H76V39H67V28H58.5 57.7zM67 20V7h-8.5c-4.9.0-7.7 2-7.7 6.4.0 4.5 2.8 6.6 7.7 6.6z" id="path298600-5" style="fill:#fafafa;fill-opacity:1;stroke-width:2.78271" transform="translate(316.39999,150)"/><path fill="#ef6456" d="M92 39V0h9v39z" id="path298602-8" style="fill:#fafafa;fill-opacity:1;stroke-width:2.78271" transform="translate(316.39999,150)"/><path fill="#ef6456" d="M134.8.0c12.2.0 20.8 7.8 20.8 19.5C155.6 31.1 147 39 134.5 39H118V0zM127 32h8c6.6.0 11.4-5.2 11.4-12.4C146.4 12.3 141.3 7 134.6 7H127z" id="path298604-4" style="fill:#fafafa;fill-opacity:1;stroke-width:2.78271" transform="translate(316.39999,150)"/><path fill="#ef6456" d="m173.5 31-3.1 8h-9.2L178.3.0h9.2l16.9 39h-9.5l-3.1-8zM182.7 8.7 176.4 24h12.5z" id="path298606-3" style="fill:#fafafa;fill-opacity:1;stroke-width:2.78271" transform="translate(316.39999,150)"/></g></g><g id="g317386-7" transform="translate(128.51294,-0.9445234)"><g id="g320058-1" transform="translate(-0.6304527,-1.3542578)"><g id="g317379-3" transform="matrix(-1,0,0,1,101.17211,0.66145864)"><rect style="opacity:1;fill:url(#linearGradient334572);fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect313837-8" width="132.38281" height="25.118452" x="124.99999" y="42.499996" transform="matrix(-0.26458333,0,0,0.26458333,101.17211,-1.9843741)" ry="0"/><text transform="matrix(0.26458333,0,0,0.26458333,3.1074741,-1.8015517)" id="text314150-0" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:18.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect314152-7);display:inline;opacity:1;fill:#fff;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="135" y="61.103946" id="tspan345073">Jailbreak</tspan></text></g><g id="g320048-9"><path style="opacity:1;fill:none;fill-opacity:1;stroke:#5d2e1f;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m129.99999 79.999996h-5V44.999998h5" id="path319793-7" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/><path style="opacity:1;fill:none;fill-opacity:1;stroke:#5d2e1f;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m134.99999 44.999998h40" id="path320041-9" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/><path style="opacity:1;fill:none;fill-opacity:1;stroke:#5d2e1f;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m134.99999 79.999996h40" id="path320043-9" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/></g></g><g id="g320076-3" transform="translate(-0.6304527,36.90592)"><g id="g320066-2" transform="translate(-4.9999562e-8,0.66145864)"><rect style="opacity:1;fill:url(#linearGradient334574);fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect320060-4" width="132.38281" height="25.513048" x="124.99999" y="42.499996" transform="matrix(0.26458333,0,0,0.26458333,1.8610598e-8,-2.0522466)" ry="0"/><text transform="matrix(-0.26458333,0,0,0.26458333,97.676764,-2.3031585)" id="text320064-3" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:18.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect320078-5);display:inline;opacity:1;fill:#fff;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="135" y="61.103946" id="tspan345075">Debugger</tspan></text></g><g id="g320074-7"><path style="opacity:1;fill:none;fill-opacity:1;stroke:#082361;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m129.99999 79.999996h-5V44.999998h5" id="path320068-1" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/><path style="opacity:1;fill:none;fill-opacity:1;stroke:#082361;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m134.99999 44.999998h40" id="path320070-2" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/><path style="opacity:1;fill:none;fill-opacity:1;stroke:#082361;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m134.99999 79.999996h40" id="path320072-2" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/></g></g><g id="g321191-0" transform="translate(-0.6304527,75.15526)"><g id="g321181-2" transform="translate(-4.9999562e-8,0.66145864)"><rect style="opacity:1;fill:url(#linearGradient317433-1);fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect321175-1" width="132.38281" height="25.948605" x="124.99999" y="42.499996" transform="matrix(0.26458333,0,0,0.26458333,1.8610598e-8,-1.9843741)" ry="0"/><text transform="matrix(-0.26458333,0,0,0.26458333,86.315851,-1.8003459)" id="text321179-7" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:18.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect321193-9);display:inline;opacity:1;fill:#fff;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="135" y="61.103946" id="tspan345077">Frida</tspan></text><path style="opacity:1;fill:none;fill-opacity:1;stroke:#5d2e1f;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m559.99997 59.999997h-10v39.999998h-20" id="path341505" transform="matrix(-0.26458333,0,0,0.26458333,217.8673,-79.12401)"/></g><g id="g321189-5"><path style="opacity:1;fill:none;fill-opacity:1;stroke:#ef6456;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m129.99999 79.999996h-5V44.999998h5" id="path321183-1" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/><path style="opacity:1;fill:none;fill-opacity:1;stroke:#ef6456;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m134.99999 44.999998h40" id="path321185-7" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/><path style="opacity:1;fill:none;fill-opacity:1;stroke:#ef6456;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m134.99999 79.999996h40" id="path321187-4" transform="matrix(0.26458333,0,0,0.26458333,-1.3229174,-3.3072917)"/></g></g></g></g></g><g id="Layer_11" data-name="Layer 11" transform="matrix(0.45454545,0,0,0.45454545,117.99715,14.429923)" style="stroke-width:6.20889"><path d="M45 8H29a1.07 1.07.0 00-.91.58l-2.74 6-2.28 5a1 1 0 00.1 1l4.75 6.54-4.84 11.49A1 1 0 0024 40h21a1 1 0 001-1V9A1 1 0 0045 8zm-1 6H27.84l1.82-4H44zm0 24H25.51L30 27.39a1 1 0 00-.11-1l-4.74-6.53L26.92 16H44z" id="path337814" style="fill:#5d2e1f;fill-opacity:1;stroke-width:6.20889"/><g id="g339822"><path d="M6 11a1 1 0 101 1A1 1 0 006 11z" id="path337816" style="fill:#82412b;fill-opacity:1;stroke-width:6.20889"/><path d="m9 11a1 1 0 101 1 1 1 0 00-1-1z" id="path337818" style="fill:#82412b;fill-opacity:1;stroke-width:6.20889"/><path d="m12 11a1 1 0 101 1 1 1 0 00-1-1z" id="path337820" style="fill:#82412b;fill-opacity:1;stroke-width:6.20889"/><path d="M24.81 27.42l-4.67-6.55 4.8-11.48A1 1 0 0024 8H3A1 1 0 002 9v30a1 1 0 001 1h15.51a1 1 0 00.89-.55l5.49-11A1 1 0 0024.81 27.42zM4 10h18.52l-1.68 4H4zM17.89 38H4V16h16l-1.93 4.61a1 1 0 00.11 1l4.65 6.51z" id="path337822" style="fill:#82412b;fill-opacity:1;stroke-width:6.20889"/></g></g><g id="g338210" data-name="Layer 11" transform="matrix(0.45454545,0,0,0.45454545,117.99715,42.007573)" style="stroke-width:6.20889"><path d="M45 8H29a1.07 1.07.0 00-.91.58l-2.74 6-2.28 5a1 1 0 00.1 1l4.75 6.54-4.84 11.49A1 1 0 0024 40h21a1 1 0 001-1V9A1 1 0 0045 8zm-1 6H27.84l1.82-4H44zm0 24H25.51L30 27.39a1 1 0 00-.11-1l-4.74-6.53L26.92 16H44z" id="path338200" style="fill:#05173f;fill-opacity:1;stroke-width:6.20889"/><g id="g339828"><path d="M6 11a1 1 0 101 1A1 1 0 006 11z" id="path338202" style="fill:#082361;fill-opacity:1;stroke-width:6.20889"/><path d="m9 11a1 1 0 101 1 1 1 0 00-1-1z" id="path338204" style="fill:#082361;fill-opacity:1;stroke-width:6.20889"/><path d="m12 11a1 1 0 101 1 1 1 0 00-1-1z" id="path338206" style="fill:#082361;fill-opacity:1;stroke-width:6.20889"/><path d="M24.81 27.42l-4.67-6.55 4.8-11.48A1 1 0 0024 8H3A1 1 0 002 9v30a1 1 0 001 1h15.51a1 1 0 00.89-.55l5.49-11A1 1 0 0024.81 27.42zM4 10h18.52l-1.68 4H4zM17.89 38H4V16h16l-1.93 4.61a1 1 0 00.11 1l4.65 6.51z" id="path338208" style="fill:#082361;fill-opacity:1;stroke-width:6.20889"/></g></g><g id="g338222" data-name="Layer 11" transform="matrix(0.45454545,0,0,0.45454545,118.4517,70.453594)" style="stroke-width:6.20889"><path d="M45 8H29a1.07 1.07.0 00-.91.58l-2.74 6-2.28 5a1 1 0 00.1 1l4.75 6.54-4.84 11.49A1 1 0 0024 40h21a1 1 0 001-1V9A1 1 0 0045 8zm-1 6H27.84l1.82-4H44zm0 24H25.51L30 27.39a1 1 0 00-.11-1l-4.74-6.53L26.92 16H44z" id="path338212" style="fill:#ef4b3b;fill-opacity:1;stroke-width:6.20889"/><g id="g339834" style="fill:#ef6456;fill-opacity:1"><path d="M6 11a1 1 0 101 1A1 1 0 006 11z" id="path338214" style="fill:#ef6456;fill-opacity:1;stroke-width:6.20889"/><path d="m9 11a1 1 0 101 1 1 1 0 00-1-1z" id="path338216" style="fill:#ef6456;fill-opacity:1;stroke-width:6.20889"/><path d="m12 11a1 1 0 101 1 1 1 0 00-1-1z" id="path338218" style="fill:#ef6456;fill-opacity:1;stroke-width:6.20889"/><path d="M24.81 27.42l-4.67-6.55 4.8-11.48A1 1 0 0024 8H3A1 1 0 002 9v30a1 1 0 001 1h15.51a1 1 0 00.89-.55l5.49-11A1 1 0 0024.81 27.42zM4 10h18.52l-1.68 4H4zM17.89 38H4V16h16l-1.93 4.61a1 1 0 00.11 1l4.65 6.51z" id="path338220" style="fill:#ef6456;fill-opacity:1;stroke-width:6.20889"/></g><path style="opacity:1;fill:none;fill-opacity:1;stroke:#ef4b3b;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m559.99997 349.99998h-74.99999v-10" id="path340133" transform="matrix(0.58208334,0,0,0.58208334,-260.59374,-154.99791)"/><text transform="matrix(0.58208334,0,0,0.58208334,-273.0843,-213.98678)" id="text340310" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:18.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect340312);display:inline;opacity:1;fill:#ef4b3b;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="485" y="376.10395" id="tspan345079">Crash</tspan></text><text transform="matrix(0.58208334,0,0,0.58208334,-272.93918,-275.10553)" id="text340531" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:18.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect340533);display:inline;opacity:1;fill:#082361;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="485" y="376.10395" id="tspan345081">Crash</tspan></text><text transform="matrix(0.58208334,0,0,0.58208334,-273.0843,-336.22428)" id="text340606" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:18.6667px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect340608);display:inline;opacity:1;fill:#82412b;fill-opacity:1;stroke:none;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="485" y="376.10395" id="tspan345083">Crash</tspan></text><path style="opacity:1;fill:#05173f;fill-opacity:1;stroke:#05173f;stroke-width:2;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" d="m559.99997 199.99999h-30" id="path340992" transform="matrix(0.58208334,0,0,0.58208334,-260.59374,-154.99791)"/></g><path style="opacity:1;fill:url(#linearGradient342779);fill-opacity:1;stroke:url(#linearGradient343226);stroke-width:1.99937;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:15.995,7.99748;stroke-dashoffset:0;stroke-opacity:1;paint-order:markers stroke fill" d="m437.49996 24.999986-45 349.999984" id="path341970" transform="matrix(0.26458333,0,0,0.26458333,-0.66145166,3.4447916e-6)" sodipodi:nodetypes="cc"/></g></svg><br><br><figcaption>Figure 11 - RASP Reaction: User Callback vs Crash</figure></figure><br></center></div><p>We can&rsquo;t actually hook a function to bypass the RASP checks <strong>but</strong> the structure of the AArch64 instructions
has a valuable property:</p><div class="admonition hint"><p><center><p><b>The size of an AArch64 instruction is fixed</b></p></center></p></div><p>As a consequence, we can <strong>linearly</strong> search the <span class="dark-boxed text-white">SVC <span class=dark-blue>#80</span></span>
instructions which are encoded as <span class="dark-boxed text-white">0xD4001001</span>.</p><h3 id=interception>Interception</h3><p>Let&rsquo;s consider the following approach to intercept the syscalls:</p><ol><li>We linearly scan the <code>__text</code> section to find the <code>SVC</code> instructions (i.e. the four-bytes <code>0xD4001001</code>)</li><li>We replace this instruction with a branch (<code>BL #imm</code>) to a function we <em>control</em></li><li>We process the redirection to disable the RASP checks</li></ol><p>For the first point, thanks to the fixed instruction&rsquo;s size, we can search syscalls by reading the whole <code>__text</code> section:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:green;font-weight:700>static</span> <span style=color:green;font-weight:700>constexpr</span> <span style=color:#b00040>uint32_t</span> SVC         <span style=color:#666>=</span> <span style=color:#666>0xD4001001</span>; <span style=color:#408080;font-style:italic>// SVC #0x80
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span><span style=color:green;font-weight:700>static</span> <span style=color:green;font-weight:700>constexpr</span> size_t   SIZEOF_INST <span style=color:#666>=</span> <span style=color:#666>4</span>;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:green;font-weight:700>for</span> (size_t addr <span style=color:#666>=</span> text_start; addr <span style=color:#666>&lt;</span> text_end; addr <span style=color:#666>+=</span> SIZEOF_INST) {
</span></span><span style=display:flex><span>  <span style=color:#408080;font-style:italic>// Read the instruction
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span>  <span style=color:green;font-weight:700>auto</span> inst <span style=color:#666>=</span> <span style=color:#666>*</span><span style=color:green;font-weight:700>reinterpret_cast</span><span style=color:#666>&lt;</span><span style=color:#b00040>uint32_t</span><span style=color:#666>*&gt;</span>(addr);
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>if</span> (inst <span style=color:#666>!=</span> SVC) {
</span></span><span style=display:flex><span>    <span style=color:green;font-weight:700>continue</span>;
</span></span><span style=display:flex><span>  }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#408080;font-style:italic>// We found a syscall instruction at: `addr`
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span>}
</span></span></code></pre></div><p>For the second point, on a syscall instruction, we have to patch the syscall with a branch.
To do so, Frida&rsquo;s <code>gum_memory_patch_code</code> is pretty convenient:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#b00040>void</span><span style=color:#666>*</span> svc_addr <span style=color:#666>=</span> <span style=color:#408080;font-style:italic>/* Address of the syscall to patch */</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>gum_memory_patch_code(svc_addr, <span style=color:#408080;font-style:italic>/* sizeof an arm64 inst */</span> <span style=color:#666>4</span>,
</span></span><span style=display:flex><span>                      [] (<span style=color:#b00040>void</span><span style=color:#666>*</span> addr, <span style=color:#b00040>void</span><span style=color:#666>*</span>) {
</span></span><span style=display:flex><span>                        GumArm64Writer<span style=color:#666>*</span> writer <span style=color:#666>=</span> gum_arm64_writer_new(addr);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>                        <span style=color:#408080;font-style:italic>/* Transform a SVC #0x80 into BL #AABBCC */</span>
</span></span><span style=display:flex><span>                        gum_arm64_writer_put_bl_imm(writer, <span style=color:#666>0xAABBCC</span>);
</span></span><span style=display:flex><span>                      }, <span style=color:green;font-weight:700>nullptr</span>);
</span></span><span style=display:flex><span>);
</span></span></code></pre></div><p>The pending question is where to branch the new <code>BL</code> instruction instead of <code>0xAABBCC</code>?</p><p>Ideally, we would like to jump on our own dedicated stub:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:#b00040>void</span> <span style=color:#00f>handler</span>() {
</span></span><span style=display:flex><span>  <span style=color:#408080;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>  <span style=color:#408080;font-style:italic>// ...
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span>  gum_arm64_writer_put_bl_imm(writer, <span style=color:#666>&amp;</span>handler);
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p><b><u>But</u></b>, the <code>bl #imm</code> instruction only accepts an immediate value in the range of <code>]-0x8000000; 0x8000000[</code>.
This range might be too narrow to encode our absolute pointer <code>&handler</code>.</p><div class="alert alert-info" role=alert style=border:none!important;background-color:#fcfffe;color:#004b32><span class="fas fa-binary" style=color:#004b32>&#160;</span>
The BL instruction encodes the <strong>signed</strong> <code>#imm</code> as a multiple of 4 on 26 bits. Thus, and because of the sign bit,
this <code>#imm</code> can range from: <code>±1 &lt;&lt; (26 + 2 - 1);</code></div><p>We can actually workaround this restriction by using a <em>trampoline</em> located <strong>in the library</strong> where the RASP checks occur.
It is quite common for large binary to find small functions with one or two instructions that are not likely or rarely used:</p><center><figure><img class=lightense data-lightense-background=#949494 src=/post/22-09-ios-obfuscation-syscall-hooking/imgs/small_func_1.webp alt="Small C++ vtable function"><br><figcaption>Figure 12 - Small C++ vtable function</figure></figure><br></center><center><figure><img class=lightense data-lightense-background=#949494 src=/post/22-09-ios-obfuscation-syscall-hooking/imgs/small_func_2.webp alt="Small C++ vtable function"><br><figcaption>Figure 13 - Small C++ vtable function</figure></figure><br></center><p>The idea is to use one of these functions as a placeholder to write <strong>two instructions</strong> which enables to branch
an <strong>absolute address</strong>:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#00f>LDR</span>   <span style=color:#800>x15</span>, <span>=&amp;</span><span style=color:#800>handler</span>
</span></span><span style=display:flex><span><span style=color:#00f>BR</span>    <span style=color:#800>x15</span>
</span></span></code></pre></div><p>Since this placeholder function is located within the library where the syscalls take place,
we can <code>BL #imm</code> to this function without risking too much that <code>#imm</code> overflows the range <code>]-0x8000000; 0x8000000[</code>.</p><center><figure class=mb-4><svg xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="825" height="400" viewBox="0 0 218.28125 105.83333" id="svg5" sodipodi:docname="svc_hook_1.svg"><sodipodi:namedview id="namedview7" pagecolor="#ffffff" bordercolor="#000000" borderopacity=".25" showgrid="true"><inkscape:grid type="xygrid" id="grid6790" spacingx="1.3229166" spacingy="1.3229166" empspacing="5"/></sodipodi:namedview><defs id="defs2"><meshgradient id="meshgradient269333" gradientUnits="userSpaceOnUse" x="13.999999" y="13.999999"><meshrow id="meshrow269335"><meshpatch id="meshpatch269337"><stop path="c 162.333,0 324.667,0 487,0" style="stop-color:#e92f2f;stop-opacity:1" id="stop269339"/><stop path="c 0,124 0,248 0,372" style="stop-color:#01b5d1;stop-opacity:1" id="stop269341"/><stop path="c -162.333,0 -324.667,0 -487,0" style="stop-color:#c364fc;stop-opacity:1" id="stop269343"/><stop path="c 0,-124 0,-248 0,-372" style="stop-color:#00ff66;stop-opacity:1" id="stop269345"/></meshpatch></meshrow></meshgradient><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect234635"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect238031"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect238035"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect238039"/><rect x="39.999996" y="290" width="184.99998" height="39.999996" id="rect239763"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect243638"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect243640"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect243642"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect243644"/><rect x="39.999996" y="290" width="184.99998" height="39.999996" id="rect243646"/><linearGradient xlink:href="#linearGradient274115" id="linearGradient274117" x1="449.99997" y1="50" x2="469.99997" y2="300" gradientUnits="userSpaceOnUse"/><linearGradient id="linearGradient274115"><stop style="stop-color:#01b5d1;stop-opacity:1" offset="0" id="stop274111"/><stop style="stop-color:#c364fc;stop-opacity:1" offset="1" id="stop274113"/></linearGradient><linearGradient xlink:href="#linearGradient261993" id="linearGradient261995" x1="228.99998" y1="214.99998" x2="280" y2="214.99998" gradientUnits="userSpaceOnUse"/><linearGradient id="linearGradient261993"><stop style="stop-color:#e92f2f;stop-opacity:1" offset="0" id="stop261989"/><stop style="stop-color:#01b5d1;stop-opacity:1" offset="1" id="stop261991"/></linearGradient><linearGradient xlink:href="#linearGradient261328" id="linearGradient261330" x1="228.99998" y1="329.99997" x2="280" y2="330" gradientUnits="userSpaceOnUse"/><linearGradient id="linearGradient261328"><stop style="stop-color:#00ff66;stop-opacity:1" offset="0" id="stop261324"/><stop style="stop-color:#c364fc;stop-opacity:1" offset="1" id="stop261326"/></linearGradient><linearGradient xlink:href="#linearGradient261993" id="linearGradient6307" gradientUnits="userSpaceOnUse" x1="228.99998" y1="214.99998" x2="280" y2="214.99998"/><linearGradient xlink:href="#linearGradient261993" id="linearGradient6309" gradientUnits="userSpaceOnUse" x1="228.99998" y1="214.99998" x2="280" y2="214.99998"/><linearGradient xlink:href="#linearGradient261993" id="linearGradient6311" gradientUnits="userSpaceOnUse" x1="228.99998" y1="214.99998" x2="280" y2="214.99998"/></defs><g id="layer1"><g id="g163140" transform="translate(39.687505,-6.6145826)" style="display:inline"><rect style="opacity:1;fill:none;fill-opacity:1;stroke:url(#meshgradient269333);stroke-width:1.99937;stroke-linecap:square;stroke-miterlimit:2;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;paint-order:markers stroke fill" id="rect252596" width="484.99997" height="370" x="14.999999" y="14.999999" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,6.6145835)"/><g id="g241251"><rect style="fill:#353333;fill-opacity:1;stroke:#e92f2f;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" id="rect146355" width="199.99998" height="350" x="24.999998" y="49.999996" transform="matrix(0.26458333,0,0,0.26458333,1.3229168,9.6041667e-7)"/><g id="g241236"><rect style="fill:#5b4a4a;fill-opacity:1;stroke:#e92f2f;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect233849" width="179.99998" height="204.99998" x="35" y="35" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,6.6145835)"/><g id="g241228"><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,6.6145835)" id="text234633" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect234635);display:inline;fill:#e92f2f;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan6669">0x169F8: SVC #0x80</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,21.698017)" id="text238029" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect238031);display:inline;fill:#e92f2f;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan6671">0x20EF0: SVC #0x80</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,36.781451)" id="text238033" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect238035);display:inline;fill:#e92f2f;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan6673">0x6DB64: SVC #0x80</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,51.864884)" id="text238037" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect238039);display:inline;fill:#e92f2f;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan6675">0xA4964: SVC #0x80</tspan></text></g></g><g id="g241222" transform="translate(1.068611e-6,5.2916664)"><rect style="fill:#415c3e;fill-opacity:1;stroke:#0f6;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect233853" width="179.99998" height="45" x="35" y="329.99997" transform="matrix(0.26458333,0,0,0.26458333,1.3229162,-5.2916615)"/><text transform="matrix(0.26458333,0,0,0.26458333,1.0500635,6.0733635)" id="text239761" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect239763);display:inline;fill:#0f6;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="303.80336" id="tspan6677">sub sp, sp, #10</tspan><tspan x="40" y="323.80336" id="tspan6679">add sp, sp, #10</tspan></text></g></g><g id="g243636" transform="translate(70.114579)"><rect style="fill:#353333;fill-opacity:1;stroke:#01b5d1;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" id="rect243612" width="199.99998" height="350" x="24.999998" y="49.999996" transform="matrix(0.26458333,0,0,0.26458333,1.3229168,9.6041667e-7)"/><g id="g243626"><rect style="fill:#26393b;fill-opacity:.980392;stroke:#01b5d1;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect243614" width="179.99998" height="204.99998" x="35" y="35" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,6.6145835)"/><g id="g243624"><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,6.6145835)" id="text243616" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect243638);display:inline;fill:#00b7d4;fill-opacity:.980392;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan6681">0x169F8: BL #140</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,21.698017)" id="text243618" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect243640);display:inline;fill:#00b7d4;fill-opacity:.980392;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan6683">0x20EF0: BL #120</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,36.781451)" id="text243620" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect243642);display:inline;fill:#00b7d4;fill-opacity:.980392;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan6685">0x6DB64: BL #80</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,51.864884)" id="text243622" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect243644);display:inline;fill:#00b7d4;fill-opacity:.980392;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan6687">0xA4964: BL #64</tspan></text></g></g><g id="g243634" transform="translate(1.068611e-6,5.2916664)"><rect style="fill:#382345;fill-opacity:1;stroke:#c364fc;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect243628" width="179.99998" height="45" x="35" y="329.99997" transform="matrix(0.26458333,0,0,0.26458333,1.3229162,-5.2916615)"/><text transform="matrix(0.26458333,0,0,0.26458333,1.0500635,6.0733635)" id="text243632" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect243646);display:inline;fill:#c364fc;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="303.80336" id="tspan6689">LDR x15, =&amp;handler</tspan><tspan x="40" y="323.80336" id="tspan6691">BR x15</tspan></text><g id="path273820" transform="matrix(0.26458333,0,0,0.26458333,-68.791664,1.3229171)"><g id="g276245"><g id="path276247" transform="matrix(0,0.62429472,-0.62429472,0,464.99998,294.99999)"><path style="color:#000;fill:#c364fc;fill-opacity:1;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path276251"/><path style="color:#000;fill:#c364fc;fill-opacity:1;fill-rule:evenodd;-inkscape-stroke:none" d="M-3.546875-6.15625V6.15625L7.1015625.0 6.1035156-.578125zm1.3339844 2.3125L4.4355469.0-2.2128906 3.84375z" id="path276253"/></g></g><path style="color:#000;fill:url(#linearGradient274117);stroke-linecap:square;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="m449 49v2h1 14v53h-14-1v2h1 14v53h-14-1v2h1 14v58h-14-1v2h1 14v74 1h2v-1-74-2-58-2-53-2-55h-16z" id="path276255"/></g></g></g><g id="path261063" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,6.6145835)"><g id="g265044"><g id="path265046" transform="matrix(0.62429472,0,0,0.62429472,279.99999,214.99999)"><path style="color:#000;fill:#04b4cf;fill-opacity:1;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path265050"/></g></g><path style="color:#000;fill:url(#linearGradient6307);stroke-linecap:round;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="m230 214a1 1 0 00-1 1 1 1 0 001 1h50a1 1 0 001-1 1 1 0 00-1-1z" id="path265054"/></g><g id="path261065" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,6.6145835)"><g id="g267991"><g id="path267993" transform="matrix(0.62429472,0,0,0.62429472,279.99999,329.99999)"><path style="color:#000;fill:#bf67f9;fill-opacity:1;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path267997"/></g></g><path style="color:#000;fill:url(#linearGradient261330);stroke-linecap:round;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="m230 329a1 1 0 00-1 1 1 1 0 001 1h50a1 1 0 001-1 1 1 0 00-1-1z" id="path268001"/></g><g id="g267296" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,-6.879168)"><g id="g267292"><g id="g267290" transform="matrix(0.62429472,0,0,0.62429472,279.99999,214.99999)"><path style="color:#000;fill:#04b4cf;fill-opacity:1;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path267288"/></g></g><path style="color:#000;fill:url(#linearGradient6309);stroke-linecap:round;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="m230 214a1 1 0 00-1 1 1 1 0 001 1h50a1 1 0 001-1 1 1 0 00-1-1z" id="path267294"/></g><g id="g267314" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,-22.489581)"><g id="g267310"><g id="g267308" transform="matrix(0.62429472,0,0,0.62429472,279.99999,214.99999)"><path style="color:#000;fill:#04b4cf;fill-opacity:1;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path267306"/></g></g><path style="color:#000;fill:url(#linearGradient6311);stroke-linecap:round;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="m230 214a1 1 0 00-1 1 1 1 0 001 1h50a1 1 0 001-1 1 1 0 00-1-1z" id="path267312"/></g><g id="g267332" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,-37.041666)"><g id="g267328"><g id="g267326" transform="matrix(0.62429472,0,0,0.62429472,279.99999,214.99999)"><path style="color:#000;fill:#04b4cf;fill-opacity:1;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path267324"/></g></g><path style="color:#000;fill:url(#linearGradient261995);stroke-linecap:round;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="m230 214a1 1 0 00-1 1 1 1 0 001 1h50a1 1 0 001-1 1 1 0 00-1-1z" id="path267330"/></g></g><script id="mesh_polyfill" type="text/javascript">!function(){const t="http://www.w3.org/2000/svg",e="http://www.w3.org/1999/xlink",s="http://www.w3.org/1999/xhtml",r=2;if(document.createElementNS(t,"meshgradient").x)return;const n=(t,e,s,r)=>{let n=new x(.5*(e.x+s.x),.5*(e.y+s.y)),o=new x(.5*(t.x+e.x),.5*(t.y+e.y)),i=new x(.5*(s.x+r.x),.5*(s.y+r.y)),a=new x(.5*(n.x+o.x),.5*(n.y+o.y)),h=new x(.5*(n.x+i.x),.5*(n.y+i.y)),l=new x(.5*(a.x+h.x),.5*(a.y+h.y));return[[t,o,a,l],[l,h,i,r]]},o=t=>{let e=t[0].distSquared(t[1]),s=t[2].distSquared(t[3]),r=.25*t[0].distSquared(t[2]),n=.25*t[1].distSquared(t[3]),o=e>s?e:s,i=r>n?r:n;return 18*(o>i?o:i)},i=(t,e)=>Math.sqrt(t.distSquared(e)),a=(t,e)=>t.scale(2/3).add(e.scale(1/3)),h=t=>{let e,s,r,n,o,i,a,h=new g;return t.match(/(\w+\(\s*[^)]+\))+/g).forEach(t=>{let l=t.match(/[\w.-]+/g),d=l.shift();switch(d){case"translate":2===l.length?e=new g(1,0,0,1,l[0],l[1]):(console.error("mesh.js: translate does not have 2 arguments!"),e=new g(1,0,0,1,0,0)),h=h.append(e);break;case"scale":1===l.length?s=new g(l[0],0,0,l[0],0,0):2===l.length?s=new g(l[0],0,0,l[1],0,0):(console.error("mesh.js: scale does not have 1 or 2 arguments!"),s=new g(1,0,0,1,0,0)),h=h.append(s);break;case"rotate":if(3===l.length&amp;&amp;(e=new g(1,0,0,1,l[1],l[2]),h=h.append(e)),l[0]){r=l[0]*Math.PI/180;let t=Math.cos(r),e=Math.sin(r);Math.abs(t)&lt;1e-16&amp;&amp;(t=0),Math.abs(e)&lt;1e-16&amp;&amp;(e=0),a=new g(t,e,-e,t,0,0),h=h.append(a)}else console.error("math.js: No argument to rotate transform!");3===l.length&amp;&amp;(e=new g(1,0,0,1,-l[1],-l[2]),h=h.append(e));break;case"skewX":l[0]?(r=l[0]*Math.PI/180,n=Math.tan(r),o=new g(1,0,n,1,0,0),h=h.append(o)):console.error("math.js: No argument to skewX transform!");break;case"skewY":l[0]?(r=l[0]*Math.PI/180,n=Math.tan(r),i=new g(1,n,0,1,0,0),h=h.append(i)):console.error("math.js: No argument to skewY transform!");break;case"matrix":6===l.length?h=h.append(new g(...l)):console.error("math.js: Incorrect number of arguments for matrix!");break;default:console.error("mesh.js: Unhandled transform type: "+d)}}),h},l=t=>{let e=[],s=t.split(/[ ,]+/);for(let t=0,r=s.length-1;t&lt;r;t+=2)e.push(new x(parseFloat(s[t]),parseFloat(s[t+1])));return e},d=(t,e)=>{for(let s in e)t.setAttribute(s,e[s])},c=(t,e,s,r,n)=>{let o,i,a=[0,0,0,0];for(let h=0;h&lt;3;++h)e[h]&lt;t[h]&amp;&amp;e[h]&lt;s[h]||t[h]&lt;e[h]&amp;&amp;s[h]&lt;e[h]?a[h]=0:(a[h]=.5*((e[h]-t[h])/r+(s[h]-e[h])/n),o=Math.abs(3*(e[h]-t[h])/r),i=Math.abs(3*(s[h]-e[h])/n),a[h]>o?a[h]=o:a[h]>i&amp;&amp;(a[h]=i));return a},u=[[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],[-3,3,0,0,-2,-1,0,0,0,0,0,0,0,0,0,0],[2,-2,0,0,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0,-3,3,0,0,-2,-1,0,0],[0,0,0,0,0,0,0,0,2,-2,0,0,1,1,0,0],[-3,0,3,0,0,0,0,0,-2,0,-1,0,0,0,0,0],[0,0,0,0,-3,0,3,0,0,0,0,0,-2,0,-1,0],[9,-9,-9,9,6,3,-6,-3,6,-6,3,-3,4,2,2,1],[-6,6,6,-6,-3,-3,3,3,-4,4,-2,2,-2,-2,-1,-1],[2,0,-2,0,0,0,0,0,1,0,1,0,0,0,0,0],[0,0,0,0,2,0,-2,0,0,0,0,0,1,0,1,0],[-6,6,6,-6,-4,-2,4,2,-3,3,-3,3,-2,-1,-2,-1],[4,-4,-4,4,2,2,-2,-2,2,-2,2,-2,1,1,1,1]],f=t=>{let e=[];for(let s=0;s&lt;16;++s){e[s]=0;for(let r=0;r&lt;16;++r)e[s]+=u[s][r]*t[r]}return e},p=(t,e,s)=>{const r=e*e,n=s*s,o=e*e*e,i=s*s*s;return t[0]+t[1]*e+t[2]*r+t[3]*o+t[4]*s+t[5]*s*e+t[6]*s*r+t[7]*s*o+t[8]*n+t[9]*n*e+t[10]*n*r+t[11]*n*o+t[12]*i+t[13]*i*e+t[14]*i*r+t[15]*i*o},y=t=>{let e=[],s=[],r=[];for(let s=0;s&lt;4;++s)e[s]=[],e[s][0]=n(t[0][s],t[1][s],t[2][s],t[3][s]),e[s][1]=[],e[s][1].push(...n(...e[s][0][0])),e[s][1].push(...n(...e[s][0][1])),e[s][2]=[],e[s][2].push(...n(...e[s][1][0])),e[s][2].push(...n(...e[s][1][1])),e[s][2].push(...n(...e[s][1][2])),e[s][2].push(...n(...e[s][1][3]));for(let t=0;t&lt;8;++t){s[t]=[];for(let r=0;r&lt;4;++r)s[t][r]=[],s[t][r][0]=n(e[0][2][t][r],e[1][2][t][r],e[2][2][t][r],e[3][2][t][r]),s[t][r][1]=[],s[t][r][1].push(...n(...s[t][r][0][0])),s[t][r][1].push(...n(...s[t][r][0][1])),s[t][r][2]=[],s[t][r][2].push(...n(...s[t][r][1][0])),s[t][r][2].push(...n(...s[t][r][1][1])),s[t][r][2].push(...n(...s[t][r][1][2])),s[t][r][2].push(...n(...s[t][r][1][3]))}for(let t=0;t&lt;8;++t){r[t]=[];for(let e=0;e&lt;8;++e)r[t][e]=[],r[t][e][0]=s[t][0][2][e],r[t][e][1]=s[t][1][2][e],r[t][e][2]=s[t][2][2][e],r[t][e][3]=s[t][3][2][e]}return r};class x{constructor(t,e){this.x=t||0,this.y=e||0}toString(){return`(x=${this.x}, y=${this.y})`}clone(){return new x(this.x,this.y)}add(t){return new x(this.x+t.x,this.y+t.y)}scale(t){return void 0===t.x?new x(this.x*t,this.y*t):new x(this.x*t.x,this.y*t.y)}distSquared(t){let e=this.x-t.x,s=this.y-t.y;return e*e+s*s}transform(t){let e=this.x*t.a+this.y*t.c+t.e,s=this.x*t.b+this.y*t.d+t.f;return new x(e,s)}}class g{constructor(t,e,s,r,n,o){void 0===t?(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0):(this.a=t,this.b=e,this.c=s,this.d=r,this.e=n,this.f=o)}toString(){return`affine: ${this.a} ${this.c} ${this.e} \n ${this.b} ${this.d} ${this.f}`}append(t){t instanceof g||console.error("mesh.js: argument to Affine.append is not affine!");let e=this.a*t.a+this.c*t.b,s=this.b*t.a+this.d*t.b,r=this.a*t.c+this.c*t.d,n=this.b*t.c+this.d*t.d,o=this.a*t.e+this.c*t.f+this.e,i=this.b*t.e+this.d*t.f+this.f;return new g(e,s,r,n,o,i)}}class w{constructor(t,e){this.nodes=t,this.colors=e}paintCurve(t,e){if(o(this.nodes)>r){const s=n(...this.nodes);let r=[[],[]],o=[[],[]];for(let t=0;t&lt;4;++t)r[0][t]=this.colors[0][t],r[1][t]=(this.colors[0][t]+this.colors[1][t])/2,o[0][t]=r[1][t],o[1][t]=this.colors[1][t];let i=new w(s[0],r),a=new w(s[1],o);i.paintCurve(t,e),a.paintCurve(t,e)}else{let s=Math.round(this.nodes[0].x);if(s>=0&amp;&amp;s&lt;e){let r=4*(~~this.nodes[0].y*e+s);t[r]=Math.round(this.colors[0][0]),t[r+1]=Math.round(this.colors[0][1]),t[r+2]=Math.round(this.colors[0][2]),t[r+3]=Math.round(this.colors[0][3])}}}}class m{constructor(t,e){this.nodes=t,this.colors=e}split(){let t=[[],[],[],[]],e=[[],[],[],[]],s=[[[],[]],[[],[]]],r=[[[],[]],[[],[]]];for(let s=0;s&lt;4;++s){const r=n(this.nodes[0][s],this.nodes[1][s],this.nodes[2][s],this.nodes[3][s]);t[0][s]=r[0][0],t[1][s]=r[0][1],t[2][s]=r[0][2],t[3][s]=r[0][3],e[0][s]=r[1][0],e[1][s]=r[1][1],e[2][s]=r[1][2],e[3][s]=r[1][3]}for(let t=0;t&lt;4;++t)s[0][0][t]=this.colors[0][0][t],s[0][1][t]=this.colors[0][1][t],s[1][0][t]=(this.colors[0][0][t]+this.colors[1][0][t])/2,s[1][1][t]=(this.colors[0][1][t]+this.colors[1][1][t])/2,r[0][0][t]=s[1][0][t],r[0][1][t]=s[1][1][t],r[1][0][t]=this.colors[1][0][t],r[1][1][t]=this.colors[1][1][t];return[new m(t,s),new m(e,r)]}paint(t,e){let s,n=!1;for(let t=0;t&lt;4;++t)if((s=o([this.nodes[0][t],this.nodes[1][t],this.nodes[2][t],this.nodes[3][t]]))>r){n=!0;break}if(n){let s=this.split();s[0].paint(t,e),s[1].paint(t,e)}else{new w([...this.nodes[0]],[...this.colors[0]]).paintCurve(t,e)}}}class b{constructor(t){this.readMesh(t),this.type=t.getAttribute("type")||"bilinear"}readMesh(t){let e=[[]],s=[[]],r=Number(t.getAttribute("x")),n=Number(t.getAttribute("y"));e[0][0]=new x(r,n);let o=t.children;for(let t=0,r=o.length;t&lt;r;++t){e[3*t+1]=[],e[3*t+2]=[],e[3*t+3]=[],s[t+1]=[];let r=o[t].children;for(let n=0,o=r.length;n&lt;o;++n){let o=r[n].children;for(let r=0,i=o.length;r&lt;i;++r){let i=r;0!==t&amp;&amp;++i;let h,d=o[r].getAttribute("path"),c="l";null!=d&amp;&amp;(c=(h=d.match(/\s*([lLcC])\s*(.*)/))[1]);let u=l(h[2]);switch(c){case"l":0===i?(e[3*t][3*n+3]=u[0].add(e[3*t][3*n]),e[3*t][3*n+1]=a(e[3*t][3*n],e[3*t][3*n+3]),e[3*t][3*n+2]=a(e[3*t][3*n+3],e[3*t][3*n])):1===i?(e[3*t+3][3*n+3]=u[0].add(e[3*t][3*n+3]),e[3*t+1][3*n+3]=a(e[3*t][3*n+3],e[3*t+3][3*n+3]),e[3*t+2][3*n+3]=a(e[3*t+3][3*n+3],e[3*t][3*n+3])):2===i?(0===n&amp;&amp;(e[3*t+3][3*n+0]=u[0].add(e[3*t+3][3*n+3])),e[3*t+3][3*n+1]=a(e[3*t+3][3*n],e[3*t+3][3*n+3]),e[3*t+3][3*n+2]=a(e[3*t+3][3*n+3],e[3*t+3][3*n])):(e[3*t+1][3*n]=a(e[3*t][3*n],e[3*t+3][3*n]),e[3*t+2][3*n]=a(e[3*t+3][3*n],e[3*t][3*n]));break;case"L":0===i?(e[3*t][3*n+3]=u[0],e[3*t][3*n+1]=a(e[3*t][3*n],e[3*t][3*n+3]),e[3*t][3*n+2]=a(e[3*t][3*n+3],e[3*t][3*n])):1===i?(e[3*t+3][3*n+3]=u[0],e[3*t+1][3*n+3]=a(e[3*t][3*n+3],e[3*t+3][3*n+3]),e[3*t+2][3*n+3]=a(e[3*t+3][3*n+3],e[3*t][3*n+3])):2===i?(0===n&amp;&amp;(e[3*t+3][3*n+0]=u[0]),e[3*t+3][3*n+1]=a(e[3*t+3][3*n],e[3*t+3][3*n+3]),e[3*t+3][3*n+2]=a(e[3*t+3][3*n+3],e[3*t+3][3*n])):(e[3*t+1][3*n]=a(e[3*t][3*n],e[3*t+3][3*n]),e[3*t+2][3*n]=a(e[3*t+3][3*n],e[3*t][3*n]));break;case"c":0===i?(e[3*t][3*n+1]=u[0].add(e[3*t][3*n]),e[3*t][3*n+2]=u[1].add(e[3*t][3*n]),e[3*t][3*n+3]=u[2].add(e[3*t][3*n])):1===i?(e[3*t+1][3*n+3]=u[0].add(e[3*t][3*n+3]),e[3*t+2][3*n+3]=u[1].add(e[3*t][3*n+3]),e[3*t+3][3*n+3]=u[2].add(e[3*t][3*n+3])):2===i?(e[3*t+3][3*n+2]=u[0].add(e[3*t+3][3*n+3]),e[3*t+3][3*n+1]=u[1].add(e[3*t+3][3*n+3]),0===n&amp;&amp;(e[3*t+3][3*n+0]=u[2].add(e[3*t+3][3*n+3]))):(e[3*t+2][3*n]=u[0].add(e[3*t+3][3*n]),e[3*t+1][3*n]=u[1].add(e[3*t+3][3*n]));break;case"C":0===i?(e[3*t][3*n+1]=u[0],e[3*t][3*n+2]=u[1],e[3*t][3*n+3]=u[2]):1===i?(e[3*t+1][3*n+3]=u[0],e[3*t+2][3*n+3]=u[1],e[3*t+3][3*n+3]=u[2]):2===i?(e[3*t+3][3*n+2]=u[0],e[3*t+3][3*n+1]=u[1],0===n&amp;&amp;(e[3*t+3][3*n+0]=u[2])):(e[3*t+2][3*n]=u[0],e[3*t+1][3*n]=u[1]);break;default:console.error("mesh.js: "+c+" invalid path type.")}if(0===t&amp;&amp;0===n||r>0){let e=window.getComputedStyle(o[r]).stopColor.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i),a=window.getComputedStyle(o[r]).stopOpacity,h=255;a&amp;&amp;(h=Math.floor(255*a)),e&amp;&amp;(0===i?(s[t][n]=[],s[t][n][0]=Math.floor(e[1]),s[t][n][1]=Math.floor(e[2]),s[t][n][2]=Math.floor(e[3]),s[t][n][3]=h):1===i?(s[t][n+1]=[],s[t][n+1][0]=Math.floor(e[1]),s[t][n+1][1]=Math.floor(e[2]),s[t][n+1][2]=Math.floor(e[3]),s[t][n+1][3]=h):2===i?(s[t+1][n+1]=[],s[t+1][n+1][0]=Math.floor(e[1]),s[t+1][n+1][1]=Math.floor(e[2]),s[t+1][n+1][2]=Math.floor(e[3]),s[t+1][n+1][3]=h):3===i&amp;&amp;(s[t+1][n]=[],s[t+1][n][0]=Math.floor(e[1]),s[t+1][n][1]=Math.floor(e[2]),s[t+1][n][2]=Math.floor(e[3]),s[t+1][n][3]=h))}}e[3*t+1][3*n+1]=new x,e[3*t+1][3*n+2]=new x,e[3*t+2][3*n+1]=new x,e[3*t+2][3*n+2]=new x,e[3*t+1][3*n+1].x=(-4*e[3*t][3*n].x+6*(e[3*t][3*n+1].x+e[3*t+1][3*n].x)+-2*(e[3*t][3*n+3].x+e[3*t+3][3*n].x)+3*(e[3*t+3][3*n+1].x+e[3*t+1][3*n+3].x)+-1*e[3*t+3][3*n+3].x)/9,e[3*t+1][3*n+2].x=(-4*e[3*t][3*n+3].x+6*(e[3*t][3*n+2].x+e[3*t+1][3*n+3].x)+-2*(e[3*t][3*n].x+e[3*t+3][3*n+3].x)+3*(e[3*t+3][3*n+2].x+e[3*t+1][3*n].x)+-1*e[3*t+3][3*n].x)/9,e[3*t+2][3*n+1].x=(-4*e[3*t+3][3*n].x+6*(e[3*t+3][3*n+1].x+e[3*t+2][3*n].x)+-2*(e[3*t+3][3*n+3].x+e[3*t][3*n].x)+3*(e[3*t][3*n+1].x+e[3*t+2][3*n+3].x)+-1*e[3*t][3*n+3].x)/9,e[3*t+2][3*n+2].x=(-4*e[3*t+3][3*n+3].x+6*(e[3*t+3][3*n+2].x+e[3*t+2][3*n+3].x)+-2*(e[3*t+3][3*n].x+e[3*t][3*n+3].x)+3*(e[3*t][3*n+2].x+e[3*t+2][3*n].x)+-1*e[3*t][3*n].x)/9,e[3*t+1][3*n+1].y=(-4*e[3*t][3*n].y+6*(e[3*t][3*n+1].y+e[3*t+1][3*n].y)+-2*(e[3*t][3*n+3].y+e[3*t+3][3*n].y)+3*(e[3*t+3][3*n+1].y+e[3*t+1][3*n+3].y)+-1*e[3*t+3][3*n+3].y)/9,e[3*t+1][3*n+2].y=(-4*e[3*t][3*n+3].y+6*(e[3*t][3*n+2].y+e[3*t+1][3*n+3].y)+-2*(e[3*t][3*n].y+e[3*t+3][3*n+3].y)+3*(e[3*t+3][3*n+2].y+e[3*t+1][3*n].y)+-1*e[3*t+3][3*n].y)/9,e[3*t+2][3*n+1].y=(-4*e[3*t+3][3*n].y+6*(e[3*t+3][3*n+1].y+e[3*t+2][3*n].y)+-2*(e[3*t+3][3*n+3].y+e[3*t][3*n].y)+3*(e[3*t][3*n+1].y+e[3*t+2][3*n+3].y)+-1*e[3*t][3*n+3].y)/9,e[3*t+2][3*n+2].y=(-4*e[3*t+3][3*n+3].y+6*(e[3*t+3][3*n+2].y+e[3*t+2][3*n+3].y)+-2*(e[3*t+3][3*n].y+e[3*t][3*n+3].y)+3*(e[3*t][3*n+2].y+e[3*t+2][3*n].y)+-1*e[3*t][3*n].y)/9}}this.nodes=e,this.colors=s}paintMesh(t,e){let s=(this.nodes.length-1)/3,r=(this.nodes[0].length-1)/3;if("bilinear"===this.type||s&lt;2||r&lt;2){let n;for(let o=0;o&lt;s;++o)for(let s=0;s&lt;r;++s){let r=[];for(let t=3*o,e=3*o+4;t&lt;e;++t)r.push(this.nodes[t].slice(3*s,3*s+4));let i=[];i.push(this.colors[o].slice(s,s+2)),i.push(this.colors[o+1].slice(s,s+2)),(n=new m(r,i)).paint(t,e)}}else{let n,o,a,h,l,d,u;const x=s,g=r;s++,r++;let w=new Array(s);for(let t=0;t&lt;s;++t){w[t]=new Array(r);for(let e=0;e&lt;r;++e)w[t][e]=[],w[t][e][0]=this.nodes[3*t][3*e],w[t][e][1]=this.colors[t][e]}for(let t=0;t&lt;s;++t)for(let e=0;e&lt;r;++e)0!==t&amp;&amp;t!==x&amp;&amp;(n=i(w[t-1][e][0],w[t][e][0]),o=i(w[t+1][e][0],w[t][e][0]),w[t][e][2]=c(w[t-1][e][1],w[t][e][1],w[t+1][e][1],n,o)),0!==e&amp;&amp;e!==g&amp;&amp;(n=i(w[t][e-1][0],w[t][e][0]),o=i(w[t][e+1][0],w[t][e][0]),w[t][e][3]=c(w[t][e-1][1],w[t][e][1],w[t][e+1][1],n,o));for(let t=0;t&lt;r;++t){w[0][t][2]=[],w[x][t][2]=[];for(let e=0;e&lt;4;++e)n=i(w[1][t][0],w[0][t][0]),o=i(w[x][t][0],w[x-1][t][0]),w[0][t][2][e]=n>0?2*(w[1][t][1][e]-w[0][t][1][e])/n-w[1][t][2][e]:0,w[x][t][2][e]=o>0?2*(w[x][t][1][e]-w[x-1][t][1][e])/o-w[x-1][t][2][e]:0}for(let t=0;t&lt;s;++t){w[t][0][3]=[],w[t][g][3]=[];for(let e=0;e&lt;4;++e)n=i(w[t][1][0],w[t][0][0]),o=i(w[t][g][0],w[t][g-1][0]),w[t][0][3][e]=n>0?2*(w[t][1][1][e]-w[t][0][1][e])/n-w[t][1][3][e]:0,w[t][g][3][e]=o>0?2*(w[t][g][1][e]-w[t][g-1][1][e])/o-w[t][g-1][3][e]:0}for(let s=0;s&lt;x;++s)for(let r=0;r&lt;g;++r){let n=i(w[s][r][0],w[s+1][r][0]),o=i(w[s][r+1][0],w[s+1][r+1][0]),c=i(w[s][r][0],w[s][r+1][0]),x=i(w[s+1][r][0],w[s+1][r+1][0]),g=[[],[],[],[]];for(let t=0;t&lt;4;++t){(d=[])[0]=w[s][r][1][t],d[1]=w[s+1][r][1][t],d[2]=w[s][r+1][1][t],d[3]=w[s+1][r+1][1][t],d[4]=w[s][r][2][t]*n,d[5]=w[s+1][r][2][t]*n,d[6]=w[s][r+1][2][t]*o,d[7]=w[s+1][r+1][2][t]*o,d[8]=w[s][r][3][t]*c,d[9]=w[s+1][r][3][t]*x,d[10]=w[s][r+1][3][t]*c,d[11]=w[s+1][r+1][3][t]*x,d[12]=0,d[13]=0,d[14]=0,d[15]=0,u=f(d);for(let e=0;e&lt;9;++e){g[t][e]=[];for(let s=0;s&lt;9;++s)g[t][e][s]=p(u,e/8,s/8),g[t][e][s]>255?g[t][e][s]=255:g[t][e][s]&lt;0&amp;&amp;(g[t][e][s]=0)}}h=[];for(let t=3*s,e=3*s+4;t&lt;e;++t)h.push(this.nodes[t].slice(3*r,3*r+4));l=y(h);for(let s=0;s&lt;8;++s)for(let r=0;r&lt;8;++r)(a=new m(l[s][r],[[[g[0][s][r],g[1][s][r],g[2][s][r],g[3][s][r]],[g[0][s][r+1],g[1][s][r+1],g[2][s][r+1],g[3][s][r+1]]],[[g[0][s+1][r],g[1][s+1][r],g[2][s+1][r],g[3][s+1][r]],[g[0][s+1][r+1],g[1][s+1][r+1],g[2][s+1][r+1],g[3][s+1][r+1]]]])).paint(t,e)}}}transform(t){if(t instanceof x)for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].add(t);else if(t instanceof g)for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].transform(t)}scale(t){for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].scale(t)}}document.querySelectorAll("rect,circle,ellipse,path,text").forEach((r,n)=>{let o=r.getAttribute("id");o||(o="patchjs_shape"+n,r.setAttribute("id",o));const i=r.style.fill.match(/^url\(\s*"?\s*#([^\s"]+)"?\s*\)/),a=r.style.stroke.match(/^url\(\s*"?\s*#([^\s"]+)"?\s*\)/);if(i&amp;&amp;i[1]){const a=document.getElementById(i[1]);if(a&amp;&amp;"meshgradient"===a.nodeName){const i=r.getBBox();let l=document.createElementNS(s,"canvas");d(l,{width:i.width,height:i.height});const c=l.getContext("2d");let u=c.createImageData(i.width,i.height);const f=new b(a);"objectBoundingBox"===a.getAttribute("gradientUnits")&amp;&amp;f.scale(new x(i.width,i.height));const p=a.getAttribute("gradientTransform");null!=p&amp;&amp;f.transform(h(p)),"userSpaceOnUse"===a.getAttribute("gradientUnits")&amp;&amp;f.transform(new x(-i.x,-i.y)),f.paintMesh(u.data,l.width),c.putImageData(u,0,0);const y=document.createElementNS(t,"image");d(y,{width:i.width,height:i.height,x:i.x,y:i.y});let g=l.toDataURL();y.setAttributeNS(e,"xlink:href",g),r.parentNode.insertBefore(y,r),r.style.fill="none";const w=document.createElementNS(t,"use");w.setAttributeNS(e,"xlink:href","#"+o);const m="patchjs_clip"+n,M=document.createElementNS(t,"clipPath");M.setAttribute("id",m),M.appendChild(w),r.parentElement.insertBefore(M,r),y.setAttribute("clip-path","url(#"+m+")"),u=null,l=null,g=null}}if(a&amp;&amp;a[1]){const o=document.getElementById(a[1]);if(o&amp;&amp;"meshgradient"===o.nodeName){const i=parseFloat(r.style.strokeWidth.slice(0,-2))*(parseFloat(r.style.strokeMiterlimit)||parseFloat(r.getAttribute("stroke-miterlimit"))||1),a=r.getBBox(),l=Math.trunc(a.width+i),c=Math.trunc(a.height+i),u=Math.trunc(a.x-i/2),f=Math.trunc(a.y-i/2);let p=document.createElementNS(s,"canvas");d(p,{width:l,height:c});const y=p.getContext("2d");let g=y.createImageData(l,c);const w=new b(o);"objectBoundingBox"===o.getAttribute("gradientUnits")&amp;&amp;w.scale(new x(l,c));const m=o.getAttribute("gradientTransform");null!=m&amp;&amp;w.transform(h(m)),"userSpaceOnUse"===o.getAttribute("gradientUnits")&amp;&amp;w.transform(new x(-u,-f)),w.paintMesh(g.data,p.width),y.putImageData(g,0,0);const M=document.createElementNS(t,"image");d(M,{width:l,height:c,x:0,y:0});let S=p.toDataURL();M.setAttributeNS(e,"xlink:href",S);const k="pattern_clip"+n,A=document.createElementNS(t,"pattern");d(A,{id:k,patternUnits:"userSpaceOnUse",width:l,height:c,x:u,y:f}),A.appendChild(M),o.parentNode.appendChild(A),r.style.stroke="url(#"+k+")",g=null,p=null,S=null}}})}();</script></g><script id="script6693" type="text/javascript">!function(){const t="http://www.w3.org/2000/svg",e="http://www.w3.org/1999/xlink",s="http://www.w3.org/1999/xhtml",r=2;if(document.createElementNS(t,"meshgradient").x)return;const n=(t,e,s,r)=>{let n=new x(.5*(e.x+s.x),.5*(e.y+s.y)),o=new x(.5*(t.x+e.x),.5*(t.y+e.y)),i=new x(.5*(s.x+r.x),.5*(s.y+r.y)),a=new x(.5*(n.x+o.x),.5*(n.y+o.y)),h=new x(.5*(n.x+i.x),.5*(n.y+i.y)),l=new x(.5*(a.x+h.x),.5*(a.y+h.y));return[[t,o,a,l],[l,h,i,r]]},o=t=>{let e=t[0].distSquared(t[1]),s=t[2].distSquared(t[3]),r=.25*t[0].distSquared(t[2]),n=.25*t[1].distSquared(t[3]),o=e>s?e:s,i=r>n?r:n;return 18*(o>i?o:i)},i=(t,e)=>Math.sqrt(t.distSquared(e)),a=(t,e)=>t.scale(2/3).add(e.scale(1/3)),h=t=>{let e,s,r,n,o,i,a,h=new g;return t.match(/(\w+\(\s*[^)]+\))+/g).forEach(t=>{let l=t.match(/[\w.-]+/g),d=l.shift();switch(d){case"translate":2===l.length?e=new g(1,0,0,1,l[0],l[1]):(console.error("mesh.js: translate does not have 2 arguments!"),e=new g(1,0,0,1,0,0)),h=h.append(e);break;case"scale":1===l.length?s=new g(l[0],0,0,l[0],0,0):2===l.length?s=new g(l[0],0,0,l[1],0,0):(console.error("mesh.js: scale does not have 1 or 2 arguments!"),s=new g(1,0,0,1,0,0)),h=h.append(s);break;case"rotate":if(3===l.length&amp;&amp;(e=new g(1,0,0,1,l[1],l[2]),h=h.append(e)),l[0]){r=l[0]*Math.PI/180;let t=Math.cos(r),e=Math.sin(r);Math.abs(t)&lt;1e-16&amp;&amp;(t=0),Math.abs(e)&lt;1e-16&amp;&amp;(e=0),a=new g(t,e,-e,t,0,0),h=h.append(a)}else console.error("math.js: No argument to rotate transform!");3===l.length&amp;&amp;(e=new g(1,0,0,1,-l[1],-l[2]),h=h.append(e));break;case"skewX":l[0]?(r=l[0]*Math.PI/180,n=Math.tan(r),o=new g(1,0,n,1,0,0),h=h.append(o)):console.error("math.js: No argument to skewX transform!");break;case"skewY":l[0]?(r=l[0]*Math.PI/180,n=Math.tan(r),i=new g(1,n,0,1,0,0),h=h.append(i)):console.error("math.js: No argument to skewY transform!");break;case"matrix":6===l.length?h=h.append(new g(...l)):console.error("math.js: Incorrect number of arguments for matrix!");break;default:console.error("mesh.js: Unhandled transform type: "+d)}}),h},l=t=>{let e=[],s=t.split(/[ ,]+/);for(let t=0,r=s.length-1;t&lt;r;t+=2)e.push(new x(parseFloat(s[t]),parseFloat(s[t+1])));return e},d=(t,e)=>{for(let s in e)t.setAttribute(s,e[s])},c=(t,e,s,r,n)=>{let o,i,a=[0,0,0,0];for(let h=0;h&lt;3;++h)e[h]&lt;t[h]&amp;&amp;e[h]&lt;s[h]||t[h]&lt;e[h]&amp;&amp;s[h]&lt;e[h]?a[h]=0:(a[h]=.5*((e[h]-t[h])/r+(s[h]-e[h])/n),o=Math.abs(3*(e[h]-t[h])/r),i=Math.abs(3*(s[h]-e[h])/n),a[h]>o?a[h]=o:a[h]>i&amp;&amp;(a[h]=i));return a},u=[[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],[-3,3,0,0,-2,-1,0,0,0,0,0,0,0,0,0,0],[2,-2,0,0,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0,-3,3,0,0,-2,-1,0,0],[0,0,0,0,0,0,0,0,2,-2,0,0,1,1,0,0],[-3,0,3,0,0,0,0,0,-2,0,-1,0,0,0,0,0],[0,0,0,0,-3,0,3,0,0,0,0,0,-2,0,-1,0],[9,-9,-9,9,6,3,-6,-3,6,-6,3,-3,4,2,2,1],[-6,6,6,-6,-3,-3,3,3,-4,4,-2,2,-2,-2,-1,-1],[2,0,-2,0,0,0,0,0,1,0,1,0,0,0,0,0],[0,0,0,0,2,0,-2,0,0,0,0,0,1,0,1,0],[-6,6,6,-6,-4,-2,4,2,-3,3,-3,3,-2,-1,-2,-1],[4,-4,-4,4,2,2,-2,-2,2,-2,2,-2,1,1,1,1]],f=t=>{let e=[];for(let s=0;s&lt;16;++s){e[s]=0;for(let r=0;r&lt;16;++r)e[s]+=u[s][r]*t[r]}return e},p=(t,e,s)=>{const r=e*e,n=s*s,o=e*e*e,i=s*s*s;return t[0]+t[1]*e+t[2]*r+t[3]*o+t[4]*s+t[5]*s*e+t[6]*s*r+t[7]*s*o+t[8]*n+t[9]*n*e+t[10]*n*r+t[11]*n*o+t[12]*i+t[13]*i*e+t[14]*i*r+t[15]*i*o},y=t=>{let e=[],s=[],r=[];for(let s=0;s&lt;4;++s)e[s]=[],e[s][0]=n(t[0][s],t[1][s],t[2][s],t[3][s]),e[s][1]=[],e[s][1].push(...n(...e[s][0][0])),e[s][1].push(...n(...e[s][0][1])),e[s][2]=[],e[s][2].push(...n(...e[s][1][0])),e[s][2].push(...n(...e[s][1][1])),e[s][2].push(...n(...e[s][1][2])),e[s][2].push(...n(...e[s][1][3]));for(let t=0;t&lt;8;++t){s[t]=[];for(let r=0;r&lt;4;++r)s[t][r]=[],s[t][r][0]=n(e[0][2][t][r],e[1][2][t][r],e[2][2][t][r],e[3][2][t][r]),s[t][r][1]=[],s[t][r][1].push(...n(...s[t][r][0][0])),s[t][r][1].push(...n(...s[t][r][0][1])),s[t][r][2]=[],s[t][r][2].push(...n(...s[t][r][1][0])),s[t][r][2].push(...n(...s[t][r][1][1])),s[t][r][2].push(...n(...s[t][r][1][2])),s[t][r][2].push(...n(...s[t][r][1][3]))}for(let t=0;t&lt;8;++t){r[t]=[];for(let e=0;e&lt;8;++e)r[t][e]=[],r[t][e][0]=s[t][0][2][e],r[t][e][1]=s[t][1][2][e],r[t][e][2]=s[t][2][2][e],r[t][e][3]=s[t][3][2][e]}return r};class x{constructor(t,e){this.x=t||0,this.y=e||0}toString(){return`(x=${this.x}, y=${this.y})`}clone(){return new x(this.x,this.y)}add(t){return new x(this.x+t.x,this.y+t.y)}scale(t){return void 0===t.x?new x(this.x*t,this.y*t):new x(this.x*t.x,this.y*t.y)}distSquared(t){let e=this.x-t.x,s=this.y-t.y;return e*e+s*s}transform(t){let e=this.x*t.a+this.y*t.c+t.e,s=this.x*t.b+this.y*t.d+t.f;return new x(e,s)}}class g{constructor(t,e,s,r,n,o){void 0===t?(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0):(this.a=t,this.b=e,this.c=s,this.d=r,this.e=n,this.f=o)}toString(){return`affine: ${this.a} ${this.c} ${this.e} \n ${this.b} ${this.d} ${this.f}`}append(t){t instanceof g||console.error("mesh.js: argument to Affine.append is not affine!");let e=this.a*t.a+this.c*t.b,s=this.b*t.a+this.d*t.b,r=this.a*t.c+this.c*t.d,n=this.b*t.c+this.d*t.d,o=this.a*t.e+this.c*t.f+this.e,i=this.b*t.e+this.d*t.f+this.f;return new g(e,s,r,n,o,i)}}class w{constructor(t,e){this.nodes=t,this.colors=e}paintCurve(t,e){if(o(this.nodes)>r){const s=n(...this.nodes);let r=[[],[]],o=[[],[]];for(let t=0;t&lt;4;++t)r[0][t]=this.colors[0][t],r[1][t]=(this.colors[0][t]+this.colors[1][t])/2,o[0][t]=r[1][t],o[1][t]=this.colors[1][t];let i=new w(s[0],r),a=new w(s[1],o);i.paintCurve(t,e),a.paintCurve(t,e)}else{let s=Math.round(this.nodes[0].x);if(s>=0&amp;&amp;s&lt;e){let r=4*(~~this.nodes[0].y*e+s);t[r]=Math.round(this.colors[0][0]),t[r+1]=Math.round(this.colors[0][1]),t[r+2]=Math.round(this.colors[0][2]),t[r+3]=Math.round(this.colors[0][3])}}}}class m{constructor(t,e){this.nodes=t,this.colors=e}split(){let t=[[],[],[],[]],e=[[],[],[],[]],s=[[[],[]],[[],[]]],r=[[[],[]],[[],[]]];for(let s=0;s&lt;4;++s){const r=n(this.nodes[0][s],this.nodes[1][s],this.nodes[2][s],this.nodes[3][s]);t[0][s]=r[0][0],t[1][s]=r[0][1],t[2][s]=r[0][2],t[3][s]=r[0][3],e[0][s]=r[1][0],e[1][s]=r[1][1],e[2][s]=r[1][2],e[3][s]=r[1][3]}for(let t=0;t&lt;4;++t)s[0][0][t]=this.colors[0][0][t],s[0][1][t]=this.colors[0][1][t],s[1][0][t]=(this.colors[0][0][t]+this.colors[1][0][t])/2,s[1][1][t]=(this.colors[0][1][t]+this.colors[1][1][t])/2,r[0][0][t]=s[1][0][t],r[0][1][t]=s[1][1][t],r[1][0][t]=this.colors[1][0][t],r[1][1][t]=this.colors[1][1][t];return[new m(t,s),new m(e,r)]}paint(t,e){let s,n=!1;for(let t=0;t&lt;4;++t)if((s=o([this.nodes[0][t],this.nodes[1][t],this.nodes[2][t],this.nodes[3][t]]))>r){n=!0;break}if(n){let s=this.split();s[0].paint(t,e),s[1].paint(t,e)}else{new w([...this.nodes[0]],[...this.colors[0]]).paintCurve(t,e)}}}class b{constructor(t){this.readMesh(t),this.type=t.getAttribute("type")||"bilinear"}readMesh(t){let e=[[]],s=[[]],r=Number(t.getAttribute("x")),n=Number(t.getAttribute("y"));e[0][0]=new x(r,n);let o=t.children;for(let t=0,r=o.length;t&lt;r;++t){e[3*t+1]=[],e[3*t+2]=[],e[3*t+3]=[],s[t+1]=[];let r=o[t].children;for(let n=0,o=r.length;n&lt;o;++n){let o=r[n].children;for(let r=0,i=o.length;r&lt;i;++r){let i=r;0!==t&amp;&amp;++i;let h,d=o[r].getAttribute("path"),c="l";null!=d&amp;&amp;(c=(h=d.match(/\s*([lLcC])\s*(.*)/))[1]);let u=l(h[2]);switch(c){case"l":0===i?(e[3*t][3*n+3]=u[0].add(e[3*t][3*n]),e[3*t][3*n+1]=a(e[3*t][3*n],e[3*t][3*n+3]),e[3*t][3*n+2]=a(e[3*t][3*n+3],e[3*t][3*n])):1===i?(e[3*t+3][3*n+3]=u[0].add(e[3*t][3*n+3]),e[3*t+1][3*n+3]=a(e[3*t][3*n+3],e[3*t+3][3*n+3]),e[3*t+2][3*n+3]=a(e[3*t+3][3*n+3],e[3*t][3*n+3])):2===i?(0===n&amp;&amp;(e[3*t+3][3*n+0]=u[0].add(e[3*t+3][3*n+3])),e[3*t+3][3*n+1]=a(e[3*t+3][3*n],e[3*t+3][3*n+3]),e[3*t+3][3*n+2]=a(e[3*t+3][3*n+3],e[3*t+3][3*n])):(e[3*t+1][3*n]=a(e[3*t][3*n],e[3*t+3][3*n]),e[3*t+2][3*n]=a(e[3*t+3][3*n],e[3*t][3*n]));break;case"L":0===i?(e[3*t][3*n+3]=u[0],e[3*t][3*n+1]=a(e[3*t][3*n],e[3*t][3*n+3]),e[3*t][3*n+2]=a(e[3*t][3*n+3],e[3*t][3*n])):1===i?(e[3*t+3][3*n+3]=u[0],e[3*t+1][3*n+3]=a(e[3*t][3*n+3],e[3*t+3][3*n+3]),e[3*t+2][3*n+3]=a(e[3*t+3][3*n+3],e[3*t][3*n+3])):2===i?(0===n&amp;&amp;(e[3*t+3][3*n+0]=u[0]),e[3*t+3][3*n+1]=a(e[3*t+3][3*n],e[3*t+3][3*n+3]),e[3*t+3][3*n+2]=a(e[3*t+3][3*n+3],e[3*t+3][3*n])):(e[3*t+1][3*n]=a(e[3*t][3*n],e[3*t+3][3*n]),e[3*t+2][3*n]=a(e[3*t+3][3*n],e[3*t][3*n]));break;case"c":0===i?(e[3*t][3*n+1]=u[0].add(e[3*t][3*n]),e[3*t][3*n+2]=u[1].add(e[3*t][3*n]),e[3*t][3*n+3]=u[2].add(e[3*t][3*n])):1===i?(e[3*t+1][3*n+3]=u[0].add(e[3*t][3*n+3]),e[3*t+2][3*n+3]=u[1].add(e[3*t][3*n+3]),e[3*t+3][3*n+3]=u[2].add(e[3*t][3*n+3])):2===i?(e[3*t+3][3*n+2]=u[0].add(e[3*t+3][3*n+3]),e[3*t+3][3*n+1]=u[1].add(e[3*t+3][3*n+3]),0===n&amp;&amp;(e[3*t+3][3*n+0]=u[2].add(e[3*t+3][3*n+3]))):(e[3*t+2][3*n]=u[0].add(e[3*t+3][3*n]),e[3*t+1][3*n]=u[1].add(e[3*t+3][3*n]));break;case"C":0===i?(e[3*t][3*n+1]=u[0],e[3*t][3*n+2]=u[1],e[3*t][3*n+3]=u[2]):1===i?(e[3*t+1][3*n+3]=u[0],e[3*t+2][3*n+3]=u[1],e[3*t+3][3*n+3]=u[2]):2===i?(e[3*t+3][3*n+2]=u[0],e[3*t+3][3*n+1]=u[1],0===n&amp;&amp;(e[3*t+3][3*n+0]=u[2])):(e[3*t+2][3*n]=u[0],e[3*t+1][3*n]=u[1]);break;default:console.error("mesh.js: "+c+" invalid path type.")}if(0===t&amp;&amp;0===n||r>0){let e=window.getComputedStyle(o[r]).stopColor.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i),a=window.getComputedStyle(o[r]).stopOpacity,h=255;a&amp;&amp;(h=Math.floor(255*a)),e&amp;&amp;(0===i?(s[t][n]=[],s[t][n][0]=Math.floor(e[1]),s[t][n][1]=Math.floor(e[2]),s[t][n][2]=Math.floor(e[3]),s[t][n][3]=h):1===i?(s[t][n+1]=[],s[t][n+1][0]=Math.floor(e[1]),s[t][n+1][1]=Math.floor(e[2]),s[t][n+1][2]=Math.floor(e[3]),s[t][n+1][3]=h):2===i?(s[t+1][n+1]=[],s[t+1][n+1][0]=Math.floor(e[1]),s[t+1][n+1][1]=Math.floor(e[2]),s[t+1][n+1][2]=Math.floor(e[3]),s[t+1][n+1][3]=h):3===i&amp;&amp;(s[t+1][n]=[],s[t+1][n][0]=Math.floor(e[1]),s[t+1][n][1]=Math.floor(e[2]),s[t+1][n][2]=Math.floor(e[3]),s[t+1][n][3]=h))}}e[3*t+1][3*n+1]=new x,e[3*t+1][3*n+2]=new x,e[3*t+2][3*n+1]=new x,e[3*t+2][3*n+2]=new x,e[3*t+1][3*n+1].x=(-4*e[3*t][3*n].x+6*(e[3*t][3*n+1].x+e[3*t+1][3*n].x)+-2*(e[3*t][3*n+3].x+e[3*t+3][3*n].x)+3*(e[3*t+3][3*n+1].x+e[3*t+1][3*n+3].x)+-1*e[3*t+3][3*n+3].x)/9,e[3*t+1][3*n+2].x=(-4*e[3*t][3*n+3].x+6*(e[3*t][3*n+2].x+e[3*t+1][3*n+3].x)+-2*(e[3*t][3*n].x+e[3*t+3][3*n+3].x)+3*(e[3*t+3][3*n+2].x+e[3*t+1][3*n].x)+-1*e[3*t+3][3*n].x)/9,e[3*t+2][3*n+1].x=(-4*e[3*t+3][3*n].x+6*(e[3*t+3][3*n+1].x+e[3*t+2][3*n].x)+-2*(e[3*t+3][3*n+3].x+e[3*t][3*n].x)+3*(e[3*t][3*n+1].x+e[3*t+2][3*n+3].x)+-1*e[3*t][3*n+3].x)/9,e[3*t+2][3*n+2].x=(-4*e[3*t+3][3*n+3].x+6*(e[3*t+3][3*n+2].x+e[3*t+2][3*n+3].x)+-2*(e[3*t+3][3*n].x+e[3*t][3*n+3].x)+3*(e[3*t][3*n+2].x+e[3*t+2][3*n].x)+-1*e[3*t][3*n].x)/9,e[3*t+1][3*n+1].y=(-4*e[3*t][3*n].y+6*(e[3*t][3*n+1].y+e[3*t+1][3*n].y)+-2*(e[3*t][3*n+3].y+e[3*t+3][3*n].y)+3*(e[3*t+3][3*n+1].y+e[3*t+1][3*n+3].y)+-1*e[3*t+3][3*n+3].y)/9,e[3*t+1][3*n+2].y=(-4*e[3*t][3*n+3].y+6*(e[3*t][3*n+2].y+e[3*t+1][3*n+3].y)+-2*(e[3*t][3*n].y+e[3*t+3][3*n+3].y)+3*(e[3*t+3][3*n+2].y+e[3*t+1][3*n].y)+-1*e[3*t+3][3*n].y)/9,e[3*t+2][3*n+1].y=(-4*e[3*t+3][3*n].y+6*(e[3*t+3][3*n+1].y+e[3*t+2][3*n].y)+-2*(e[3*t+3][3*n+3].y+e[3*t][3*n].y)+3*(e[3*t][3*n+1].y+e[3*t+2][3*n+3].y)+-1*e[3*t][3*n+3].y)/9,e[3*t+2][3*n+2].y=(-4*e[3*t+3][3*n+3].y+6*(e[3*t+3][3*n+2].y+e[3*t+2][3*n+3].y)+-2*(e[3*t+3][3*n].y+e[3*t][3*n+3].y)+3*(e[3*t][3*n+2].y+e[3*t+2][3*n].y)+-1*e[3*t][3*n].y)/9}}this.nodes=e,this.colors=s}paintMesh(t,e){let s=(this.nodes.length-1)/3,r=(this.nodes[0].length-1)/3;if("bilinear"===this.type||s&lt;2||r&lt;2){let n;for(let o=0;o&lt;s;++o)for(let s=0;s&lt;r;++s){let r=[];for(let t=3*o,e=3*o+4;t&lt;e;++t)r.push(this.nodes[t].slice(3*s,3*s+4));let i=[];i.push(this.colors[o].slice(s,s+2)),i.push(this.colors[o+1].slice(s,s+2)),(n=new m(r,i)).paint(t,e)}}else{let n,o,a,h,l,d,u;const x=s,g=r;s++,r++;let w=new Array(s);for(let t=0;t&lt;s;++t){w[t]=new Array(r);for(let e=0;e&lt;r;++e)w[t][e]=[],w[t][e][0]=this.nodes[3*t][3*e],w[t][e][1]=this.colors[t][e]}for(let t=0;t&lt;s;++t)for(let e=0;e&lt;r;++e)0!==t&amp;&amp;t!==x&amp;&amp;(n=i(w[t-1][e][0],w[t][e][0]),o=i(w[t+1][e][0],w[t][e][0]),w[t][e][2]=c(w[t-1][e][1],w[t][e][1],w[t+1][e][1],n,o)),0!==e&amp;&amp;e!==g&amp;&amp;(n=i(w[t][e-1][0],w[t][e][0]),o=i(w[t][e+1][0],w[t][e][0]),w[t][e][3]=c(w[t][e-1][1],w[t][e][1],w[t][e+1][1],n,o));for(let t=0;t&lt;r;++t){w[0][t][2]=[],w[x][t][2]=[];for(let e=0;e&lt;4;++e)n=i(w[1][t][0],w[0][t][0]),o=i(w[x][t][0],w[x-1][t][0]),w[0][t][2][e]=n>0?2*(w[1][t][1][e]-w[0][t][1][e])/n-w[1][t][2][e]:0,w[x][t][2][e]=o>0?2*(w[x][t][1][e]-w[x-1][t][1][e])/o-w[x-1][t][2][e]:0}for(let t=0;t&lt;s;++t){w[t][0][3]=[],w[t][g][3]=[];for(let e=0;e&lt;4;++e)n=i(w[t][1][0],w[t][0][0]),o=i(w[t][g][0],w[t][g-1][0]),w[t][0][3][e]=n>0?2*(w[t][1][1][e]-w[t][0][1][e])/n-w[t][1][3][e]:0,w[t][g][3][e]=o>0?2*(w[t][g][1][e]-w[t][g-1][1][e])/o-w[t][g-1][3][e]:0}for(let s=0;s&lt;x;++s)for(let r=0;r&lt;g;++r){let n=i(w[s][r][0],w[s+1][r][0]),o=i(w[s][r+1][0],w[s+1][r+1][0]),c=i(w[s][r][0],w[s][r+1][0]),x=i(w[s+1][r][0],w[s+1][r+1][0]),g=[[],[],[],[]];for(let t=0;t&lt;4;++t){(d=[])[0]=w[s][r][1][t],d[1]=w[s+1][r][1][t],d[2]=w[s][r+1][1][t],d[3]=w[s+1][r+1][1][t],d[4]=w[s][r][2][t]*n,d[5]=w[s+1][r][2][t]*n,d[6]=w[s][r+1][2][t]*o,d[7]=w[s+1][r+1][2][t]*o,d[8]=w[s][r][3][t]*c,d[9]=w[s+1][r][3][t]*x,d[10]=w[s][r+1][3][t]*c,d[11]=w[s+1][r+1][3][t]*x,d[12]=0,d[13]=0,d[14]=0,d[15]=0,u=f(d);for(let e=0;e&lt;9;++e){g[t][e]=[];for(let s=0;s&lt;9;++s)g[t][e][s]=p(u,e/8,s/8),g[t][e][s]>255?g[t][e][s]=255:g[t][e][s]&lt;0&amp;&amp;(g[t][e][s]=0)}}h=[];for(let t=3*s,e=3*s+4;t&lt;e;++t)h.push(this.nodes[t].slice(3*r,3*r+4));l=y(h);for(let s=0;s&lt;8;++s)for(let r=0;r&lt;8;++r)(a=new m(l[s][r],[[[g[0][s][r],g[1][s][r],g[2][s][r],g[3][s][r]],[g[0][s][r+1],g[1][s][r+1],g[2][s][r+1],g[3][s][r+1]]],[[g[0][s+1][r],g[1][s+1][r],g[2][s+1][r],g[3][s+1][r]],[g[0][s+1][r+1],g[1][s+1][r+1],g[2][s+1][r+1],g[3][s+1][r+1]]]])).paint(t,e)}}}transform(t){if(t instanceof x)for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].add(t);else if(t instanceof g)for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].transform(t)}scale(t){for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].scale(t)}}document.querySelectorAll("rect,circle,ellipse,path,text").forEach((r,n)=>{let o=r.getAttribute("id");o||(o="patchjs_shape"+n,r.setAttribute("id",o));const i=r.style.fill.match(/^url\(\s*"?\s*#([^\s"]+)"?\s*\)/),a=r.style.stroke.match(/^url\(\s*"?\s*#([^\s"]+)"?\s*\)/);if(i&amp;&amp;i[1]){const a=document.getElementById(i[1]);if(a&amp;&amp;"meshgradient"===a.nodeName){const i=r.getBBox();let l=document.createElementNS(s,"canvas");d(l,{width:i.width,height:i.height});const c=l.getContext("2d");let u=c.createImageData(i.width,i.height);const f=new b(a);"objectBoundingBox"===a.getAttribute("gradientUnits")&amp;&amp;f.scale(new x(i.width,i.height));const p=a.getAttribute("gradientTransform");null!=p&amp;&amp;f.transform(h(p)),"userSpaceOnUse"===a.getAttribute("gradientUnits")&amp;&amp;f.transform(new x(-i.x,-i.y)),f.paintMesh(u.data,l.width),c.putImageData(u,0,0);const y=document.createElementNS(t,"image");d(y,{width:i.width,height:i.height,x:i.x,y:i.y});let g=l.toDataURL();y.setAttributeNS(e,"xlink:href",g),r.parentNode.insertBefore(y,r),r.style.fill="none";const w=document.createElementNS(t,"use");w.setAttributeNS(e,"xlink:href","#"+o);const m="patchjs_clip"+n,M=document.createElementNS(t,"clipPath");M.setAttribute("id",m),M.appendChild(w),r.parentElement.insertBefore(M,r),y.setAttribute("clip-path","url(#"+m+")"),u=null,l=null,g=null}}if(a&amp;&amp;a[1]){const o=document.getElementById(a[1]);if(o&amp;&amp;"meshgradient"===o.nodeName){const i=parseFloat(r.style.strokeWidth.slice(0,-2))*(parseFloat(r.style.strokeMiterlimit)||parseFloat(r.getAttribute("stroke-miterlimit"))||1),a=r.getBBox(),l=Math.trunc(a.width+i),c=Math.trunc(a.height+i),u=Math.trunc(a.x-i/2),f=Math.trunc(a.y-i/2);let p=document.createElementNS(s,"canvas");d(p,{width:l,height:c});const y=p.getContext("2d");let g=y.createImageData(l,c);const w=new b(o);"objectBoundingBox"===o.getAttribute("gradientUnits")&amp;&amp;w.scale(new x(l,c));const m=o.getAttribute("gradientTransform");null!=m&amp;&amp;w.transform(h(m)),"userSpaceOnUse"===o.getAttribute("gradientUnits")&amp;&amp;w.transform(new x(-u,-f)),w.paintMesh(g.data,p.width),y.putImageData(g,0,0);const M=document.createElementNS(t,"image");d(M,{width:l,height:c,x:0,y:0});let S=p.toDataURL();M.setAttributeNS(e,"xlink:href",S);const k="pattern_clip"+n,A=document.createElementNS(t,"pattern");d(A,{id:k,patternUnits:"userSpaceOnUse",width:l,height:c,x:u,y:f}),A.appendChild(M),o.parentNode.appendChild(A),r.style.stroke="url(#"+k+")",g=null,p=null,S=null}}})}();</script></svg><figcaption>Fig 14. Syscall Patch</figcaption></figure></center><p>Now that we found a mechanism to redirect the syscall instruction, we can focus on the <code>handler</code> function
which aims at welcoming the syscall&rsquo;s redirection.</p><p>First, the <code>SVC</code> instructions are <em>atomic</em> which means that our <code>handler</code> function must take care
of not corrupting the values of the registers.</p><p>In particular, <code>handler</code> can&rsquo;t follow the ARM64 calling convention. If we consider the following instructions:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#00f>mov</span> <span style=color:#800>x6</span>, <span style=color:#408080;font-style:italic>#0
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span><span style=color:#800>...</span>
</span></span><span style=display:flex><span><span style=color:#00f>svc</span> <span style=color:#408080;font-style:italic>#0x80
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span><span style=color:#800>...</span>
</span></span><span style=display:flex><span><span style=color:#00f>mov</span> <span style=color:#800>x2</span>, <span style=color:#800>x6</span>
</span></span></code></pre></div><p><code>svc #0x80</code> does not corrupt <code>x6</code> while this code:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#00f>mov</span> <span style=color:#800>x6</span>, <span style=color:#408080;font-style:italic>#0
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span><span style=color:#800>...</span>
</span></span><span style=display:flex><span><span style=color:#00f>BL</span> <span style=color:#408080;font-style:italic>#imm
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span><span style=color:#800>...</span>
</span></span><span style=display:flex><span><span style=color:#00f>mov</span> <span style=color:#800>x2</span>, <span style=color:#800>x6</span>
</span></span></code></pre></div><p>could corrupt <code>x6</code> according to the ARM64 calling convention. Therefore, our <code>handler()</code> function
must <strong>really</strong> mimic an interruption and take care of correctly saving/restoring the registers.</p><p>In other words, we must write a small assembly stub to save and restore the registers<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup></p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-asm data-lang=asm><span style=display:flex><span><span style=color:#00f>stp</span> <span style=color:#800>x0</span>,  <span style=color:#800>x1</span>,  [<span style=color:#800>sp</span>, -<span style=color:#666>16</span>]!
</span></span><span style=display:flex><span><span style=color:#7d9029>...</span>
</span></span><span style=display:flex><span><span style=color:#00f>stp</span> <span style=color:#800>x28</span>, <span style=color:#800>x29</span>, [<span style=color:#800>sp</span>, -<span style=color:#666>16</span>]!
</span></span><span style=display:flex><span><span style=color:#00f>stp</span> <span style=color:#800>x30</span>, <span style=color:#800>xzr</span>, [<span style=color:#800>sp</span>, -<span style=color:#666>16</span>]!
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>mov</span> <span style=color:#800>x0</span>, <span style=color:#800>sp</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#00f>bl</span> <span style=color:#800>_syscall_handler</span><span style=color:#408080;font-style:italic>;
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span>
</span></span><span style=display:flex><span><span style=color:#00f>ldp</span> <span style=color:#800>x30</span>, <span style=color:#800>xzr</span>, [<span style=color:#800>sp</span>], <span style=color:#666>16</span>
</span></span><span style=display:flex><span><span style=color:#00f>ldp</span> <span style=color:#800>x28</span>, <span style=color:#800>x29</span>, [<span style=color:#800>sp</span>], <span style=color:#666>16</span>
</span></span><span style=display:flex><span><span style=color:#7d9029>...</span>
</span></span><span style=display:flex><span><span style=color:#00f>ldp</span> <span style=color:#800>xzr</span>, <span style=color:#800>x1</span>,  [<span style=color:#800>sp</span>], <span style=color:#666>16</span>
</span></span><span style=display:flex><span><span style=color:#00f>ret</span>
</span></span></code></pre></div><p>The <code>syscall_handler</code> function takes a pointer to the stack frame as a parameter. Thus, we can access the saved
registers:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span><span style=color:green;font-weight:700>extern</span> <span style=color:#ba2121>&#34;C&#34;</span> {
</span></span><span style=display:flex><span>uintptr_t <span style=color:#00f>syscall_handler</span>(uintptr_t<span style=color:#666>*</span> sp) {
</span></span><span style=display:flex><span>  uintptr_t x16 <span style=color:#666>=</span> sp[<span style=color:#666>14</span>]; <span style=color:#408080;font-style:italic>// Syscall number
</span></span></span><span style=display:flex><span><span style=color:#408080;font-style:italic></span>  <span style=color:green;font-weight:700>return</span> <span style=color:#666>-</span><span style=color:#666>1</span>;
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><div class="alert alert-info" role=alert style=border:none!important;background-color:#fafcff;color:#084298><span class="fas fa-hand-point-right" style=color:#084298>&#160;</span>
Apple prefixes (or mangles) symbols with a <strong><code>_</code></strong> this is why <code>syscall_handler</code> is referenced by <code>_syscall_handler</code> in the
assembly code.</div><p>Given our <code>syscall_handler</code> function, we have access to the original AArch64 registers such as we can
access the syscall number and its parameters. We are also able to modify the return value since the original syscall
is replaced by a branch.</p><div class=col-lg-0 id=fig-3><center><figure><svg xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape" xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd" xmlns:xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg" xmlns:svg="http://www.w3.org/2000/svg" width="786.99963" height="371.99936" viewBox="0 0 208.22699 98.424827" id="svg5" sodipodi:docname="svc_hook.svg"><sodipodi:namedview id="namedview7" pagecolor="#ffffff" bordercolor="#000000" borderopacity=".25" showgrid="true"><inkscape:grid type="xygrid" id="grid6790" spacingx="1.3229166" spacingy="1.3229166" empspacing="5"/></sodipodi:namedview><defs id="defs2"><linearGradient id="linearGradient274115"><stop style="stop-color:#01b5d1;stop-opacity:1" offset="0" id="stop274111"/><stop style="stop-color:#c364fc;stop-opacity:1" offset="1" id="stop274113"/></linearGradient><linearGradient id="linearGradient261993"><stop style="stop-color:#e92f2f;stop-opacity:1" offset="0" id="stop261989"/><stop style="stop-color:#01b5d1;stop-opacity:1" offset="1" id="stop261991"/></linearGradient><linearGradient id="linearGradient261328"><stop style="stop-color:#00ff66;stop-opacity:1" offset="0" id="stop261324"/><stop style="stop-color:#c364fc;stop-opacity:1" offset="1" id="stop261326"/></linearGradient><rect x="600" y="354.99997" width="194.99998" height="24.999998" id="rect259647"/><rect x="605" y="34.999996" width="249.99998" height="204.99998" id="rect250676"/><rect x="39.999996" y="290" width="184.99998" height="39.999996" id="rect239763"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect234635"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect238031"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect238035"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect238039"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect243638"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect243640"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect243642"/><rect x="39.999996" y="39.999996" width="254.99998" height="204.99998" id="rect243644"/><rect x="39.999996" y="290" width="184.99998" height="39.999996" id="rect243646"/><rect x="605" y="34.999996" width="249.99998" height="204.99998" id="rect252684"/><linearGradient xlink:href="#linearGradient261328" id="linearGradient261330" x1="228.99998" y1="329.99997" x2="280" y2="330" gradientUnits="userSpaceOnUse"/><linearGradient xlink:href="#linearGradient261993" id="linearGradient261995" x1="228.99998" y1="214.99998" x2="280" y2="214.99998" gradientUnits="userSpaceOnUse"/><linearGradient xlink:href="#linearGradient261993" id="linearGradient267298" gradientUnits="userSpaceOnUse" x1="228.99998" y1="214.99998" x2="280" y2="214.99998"/><linearGradient xlink:href="#linearGradient261993" id="linearGradient267316" gradientUnits="userSpaceOnUse" x1="228.99998" y1="214.99998" x2="280" y2="214.99998"/><linearGradient xlink:href="#linearGradient261993" id="linearGradient267334" gradientUnits="userSpaceOnUse" x1="228.99998" y1="214.99998" x2="280" y2="214.99998"/><meshgradient id="meshgradient269333" gradientUnits="userSpaceOnUse" x="13.999999" y="13.999999"><meshrow id="meshrow269335"><meshpatch id="meshpatch269337"><stop path="c 162.333,0 324.667,0 487,0" style="stop-color:#e92f2f;stop-opacity:1" id="stop269339"/><stop path="c 0,124 0,248 0,372" style="stop-color:#01b5d1;stop-opacity:1" id="stop269341"/><stop path="c -162.333,0 -324.667,0 -487,0" style="stop-color:#c364fc;stop-opacity:1" id="stop269343"/><stop path="c 0,-124 0,-248 0,-372" style="stop-color:#00ff66;stop-opacity:1" id="stop269345"/></meshpatch></meshrow></meshgradient><meshgradient id="meshgradient270279" gradientUnits="userSpaceOnUse" x="23.999998" y="48.999996"><meshrow id="meshrow270281"><meshpatch id="meshpatch270283"><stop path="c 67.3333,0 134.667,0 202,0" style="stop-color:#c364fc;stop-opacity:1" id="stop270285"/><stop path="c 0,109 0,218 0,327" style="stop-color:#01362b;stop-opacity:1" id="stop270287"/><stop path="c -67.3333,0 -134.667,0 -202,0" style="stop-color:#80ffe6;stop-opacity:1" id="stop270289"/><stop path="c 0,-109 0,-218 0,-327" style="stop-color:#382345;stop-opacity:1" id="stop270291"/></meshpatch></meshrow></meshgradient><linearGradient xlink:href="#linearGradient274115" id="linearGradient274117" x1="449.99997" y1="50" x2="469.99997" y2="300" gradientUnits="userSpaceOnUse"/></defs><g id="layer1" transform="translate(-3.7042496,-3.7042497)"><g id="g163140" transform="translate(-1.3229165,-6.6145835)"><rect style="opacity:1;fill:none;fill-opacity:1;stroke:url(#meshgradient269333);stroke-width:1.99937;stroke-linecap:square;stroke-miterlimit:2;stroke-dasharray:none;stroke-dashoffset:0;stroke-opacity:1;paint-order:markers stroke fill" id="rect252596" width="484.99997" height="370" x="14.999999" y="14.999999" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,6.6145835)"/><g id="g241251"><rect style="fill:#353333;fill-opacity:1;stroke:#e92f2f;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" id="rect146355" width="199.99998" height="350" x="24.999998" y="49.999996" transform="matrix(0.26458333,0,0,0.26458333,1.3229168,9.6041667e-7)"/><g id="g241236"><rect style="fill:#5b4a4a;fill-opacity:1;stroke:#e92f2f;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect233849" width="179.99998" height="204.99998" x="35" y="35" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,6.6145835)"/><g id="g241228"><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,6.6145835)" id="text234633" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect234635);display:inline;fill:#e92f2f;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan280272">0x169F8: SVC #0x80</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,21.698017)" id="text238029" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect238031);display:inline;fill:#e92f2f;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan280274">0x20EF0: SVC #0x80</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,36.781451)" id="text238033" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect238035);display:inline;fill:#e92f2f;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan280276">0x6DB64: SVC #0x80</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,51.864884)" id="text238037" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect238039);display:inline;fill:#e92f2f;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan280278">0xA4964: SVC #0x80</tspan></text></g></g><g id="g241222" transform="translate(1.068611e-6,5.2916664)"><rect style="fill:#415c3e;fill-opacity:1;stroke:#0f6;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect233853" width="179.99998" height="45" x="35" y="329.99997" transform="matrix(0.26458333,0,0,0.26458333,1.3229162,-5.2916615)"/><text transform="matrix(0.26458333,0,0,0.26458333,1.0500635,6.0733635)" id="text239761" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect239763);display:inline;fill:#0f6;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="303.80336" id="tspan280280">sub sp, sp, #10</tspan><tspan x="40" y="323.80336" id="tspan280282">add sp, sp, #10</tspan></text></g></g><g id="g243636" transform="translate(70.114579)"><rect style="fill:#353333;fill-opacity:1;stroke:#01b5d1;stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" id="rect243612" width="199.99998" height="350" x="24.999998" y="49.999996" transform="matrix(0.26458333,0,0,0.26458333,1.3229168,9.6041667e-7)"/><g id="g243626"><rect style="fill:#26393b;fill-opacity:.980392;stroke:#01b5d1;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect243614" width="179.99998" height="204.99998" x="35" y="35" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,6.6145835)"/><g id="g243624"><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,6.6145835)" id="text243616" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect243638);display:inline;fill:#00b7d4;fill-opacity:.980392;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan280284">0x169F8: BL #140</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,21.698017)" id="text243618" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect243640);display:inline;fill:#00b7d4;fill-opacity:.980392;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan280286">0x20EF0: BL #120</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,36.781451)" id="text243620" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect243642);display:inline;fill:#00b7d4;fill-opacity:.980392;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan280288">0x6DB64: BL #80</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.3094794,51.864884)" id="text243622" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect243644);display:inline;fill:#00b7d4;fill-opacity:.980392;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="53.803357" id="tspan280290">0xA4964: BL #64</tspan></text></g></g><g id="g243634" transform="translate(1.068611e-6,5.2916664)"><rect style="fill:#382345;fill-opacity:1;stroke:#c364fc;stroke-width:1;stroke-linecap:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1;paint-order:markers stroke fill" id="rect243628" width="179.99998" height="45" x="35" y="329.99997" transform="matrix(0.26458333,0,0,0.26458333,1.3229162,-5.2916615)"/><text transform="matrix(0.26458333,0,0,0.26458333,1.0500635,6.0733635)" id="text243632" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect243646);display:inline;fill:#c364fc;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;paint-order:markers stroke fill"><tspan x="40" y="303.80336" id="tspan280292">LDR x15, =&amp;handler</tspan><tspan x="40" y="323.80336" id="tspan280294">BR x15</tspan></text><g id="path273820" transform="matrix(0.26458333,0,0,0.26458333,-68.791664,1.3229171)"><g id="g276245"><g id="path276247" transform="matrix(0,0.62429472,-0.62429472,0,464.99998,294.99999)"><path style="color:#000;fill:#c364fc;fill-opacity:1;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path276251"/><path style="color:#000;fill:#c364fc;fill-opacity:1;fill-rule:evenodd;-inkscape-stroke:none" d="M-3.546875-6.15625V6.15625L7.1015625.0 6.1035156-.578125zm1.3339844 2.3125L4.4355469.0-2.2128906 3.84375z" id="path276253"/></g></g><path style="color:#000;fill:url(#linearGradient274117);stroke-linecap:square;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="m449 49v2h1 14v53h-14-1v2h1 14v53h-14-1v2h1 14v58h-14-1v2h1 14v74 1h2v-1-74-2-58-2-53-2-55h-16z" id="path276255"/></g></g></g><g id="g252601" transform="translate(0.66145575)"><rect style="fill:#353333;fill-opacity:1;stroke:url(#meshgradient270279);stroke-width:2;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:2;stroke-dasharray:none;stroke-opacity:1" id="rect243612-5" width="200" height="325" x="24.999998" y="49.999996" transform="matrix(0.26458333,0,0,0.26458333,152.79687,1.0093053e-6)"/><g id="g259536"><text transform="matrix(0.26458333,0,0,0.26458333,1.719788,6.2015236)" id="text250674" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect250676);display:inline;fill:#c364fc;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="605" y="48.803357" id="tspan280296">handler (...) {</tspan><tspan x="605" y="68.803357" id="tspan280298">stp x0, x1, [sp, -16]!</tspan><tspan x="605" y="88.803357" id="tspan280300"/><tspan x="605" y="108.80336" id="tspan280302"/><tspan x="605" y="128.80336" id="tspan280304">bl _syscall_handler;</tspan><tspan x="605" y="148.80336" id="tspan280306"/><tspan x="605" y="168.80336" id="tspan280308">ldp xzr, x1, [sp], 16;</tspan><tspan x="605" y="188.80336" id="tspan280310">ret;</tspan><tspan x="605" y="208.80336" id="tspan280312">}</tspan></text><text transform="matrix(0.26458333,0,0,0.26458333,1.719788,55.879109)" id="text252682" style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect252684);display:inline;fill:#80ffe6;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="605" y="48.803357" id="tspan280314">syscall_handler (...) {</tspan><tspan x="605" y="68.803357" id="tspan280316"/><tspan x="605" y="88.803357" id="tspan280318">// Bypass</tspan><tspan x="605" y="108.80336" id="tspan280320"/><tspan x="605" y="128.80336" id="tspan280322"/><tspan x="605" y="148.80336" id="tspan280324">}</tspan></text></g><text transform="matrix(0.26458333,0,0,0.26458333,0.66146075,6.6145835)" id="text259645" style="font-style:normal;font-variant:normal;font-weight:700;font-stretch:normal;font-size:20px;font-family:Monda;-inkscape-font-specification:'Monda, Bold';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;white-space:pre;shape-inside:url(#rect259647);display:inline;opacity:1;fill:#382345;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill"><tspan x="600" y="372.2542" id="tspan280326">iHook.dylib</tspan></text><text style="font-style:normal;font-variant:normal;font-weight:400;font-stretch:normal;font-size:16px;font-family:Monda;-inkscape-font-specification:'Monda, Normal';font-variant-ligatures:normal;font-variant-caps:normal;font-variant-numeric:normal;font-variant-east-asian:normal;opacity:1;fill:#382345;fill-opacity:1;stroke:none;stroke-width:4;stroke-linecap:round;stroke-miterlimit:2;stroke-opacity:1;paint-order:markers stroke fill" x="699.99994" y="399.99997" id="text259807" transform="matrix(0.26458333,0,0,0.26458333,0.66146075,6.6145835)"><tspan sodipodi:role="line" id="tspan259805" x="699.99994" y="399.99997"/></text></g><g id="path261063" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,6.6145835)"><g id="g265044"><g id="path265046" transform="matrix(0.62429472,0,0,0.62429472,279.99999,214.99999)"><path style="color:#000;fill:#04b4cf;fill-opacity:1;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path265050"/></g></g><path style="color:#000;fill:url(#linearGradient261995);stroke-linecap:round;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="m230 214a1 1 0 00-1 1 1 1 0 001 1h50a1 1 0 001-1 1 1 0 00-1-1z" id="path265054"/></g><g id="path261065" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,6.6145835)"><g id="g267991"><g id="path267993" transform="matrix(0.62429472,0,0,0.62429472,279.99999,329.99999)"><path style="color:#000;fill:#bf67f9;fill-opacity:1;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path267997"/></g></g><path style="color:#000;fill:url(#linearGradient261330);stroke-linecap:round;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="m230 329a1 1 0 00-1 1 1 1 0 001 1h50a1 1 0 001-1 1 1 0 00-1-1z" id="path268001"/></g><g id="path261186" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,6.6145835)"><g id="g278980"><g id="path278982" transform="matrix(0.62429472,0,0,0.62429472,589.99997,39.999998)"><path style="color:#000;fill:#c364fc;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path278986"/><path style="color:#000;fill:#c364fc;fill-rule:evenodd;-inkscape-stroke:none" d="M-3.546875-6.15625V6.15625L7.1015625.0 6.1035156-.578125zm1.3339844 2.3125L4.4355469.0-2.2128906 3.84375z" id="path278988"/></g></g><path style="color:#000;fill:#c364fc;stroke-linecap:round;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="M549 39V339H375a1 1 0 00-1 1 1 1 0 001 1H551V41h39a1 1 0 001-1 1 1 0 00-1-1z" id="path278990"/></g><g id="g267296" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,-6.879168)"><g id="g267292"><g id="g267290" transform="matrix(0.62429472,0,0,0.62429472,279.99999,214.99999)"><path style="color:#000;fill:#04b4cf;fill-opacity:1;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path267288"/></g></g><path style="color:#000;fill:url(#linearGradient267298);stroke-linecap:round;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="m230 214a1 1 0 00-1 1 1 1 0 001 1h50a1 1 0 001-1 1 1 0 00-1-1z" id="path267294"/></g><g id="g267314" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,-22.489581)"><g id="g267310"><g id="g267308" transform="matrix(0.62429472,0,0,0.62429472,279.99999,214.99999)"><path style="color:#000;fill:#04b4cf;fill-opacity:1;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path267306"/></g></g><path style="color:#000;fill:url(#linearGradient267316);stroke-linecap:round;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="m230 214a1 1 0 00-1 1 1 1 0 001 1h50a1 1 0 001-1 1 1 0 00-1-1z" id="path267312"/></g><g id="g267332" transform="matrix(0.26458333,0,0,0.26458333,1.3229165,-37.041666)"><g id="g267328"><g id="g267326" transform="matrix(0.62429472,0,0,0.62429472,279.99999,214.99999)"><path style="color:#000;fill:#04b4cf;fill-opacity:1;fill-rule:evenodd;stroke-width:1pt;-inkscape-stroke:none" d="M5.77.0-2.88 5V-5z" id="path267324"/></g></g><path style="color:#000;fill:url(#linearGradient267334);stroke-linecap:round;stroke-miterlimit:2;-inkscape-stroke:none;paint-order:markers stroke fill" d="m230 214a1 1 0 00-1 1 1 1 0 001 1h50a1 1 0 001-1 1 1 0 00-1-1z" id="path267330"/></g></g><script id="mesh_polyfill" type="text/javascript">!function(){const t="http://www.w3.org/2000/svg",e="http://www.w3.org/1999/xlink",s="http://www.w3.org/1999/xhtml",r=2;if(document.createElementNS(t,"meshgradient").x)return;const n=(t,e,s,r)=>{let n=new x(.5*(e.x+s.x),.5*(e.y+s.y)),o=new x(.5*(t.x+e.x),.5*(t.y+e.y)),i=new x(.5*(s.x+r.x),.5*(s.y+r.y)),a=new x(.5*(n.x+o.x),.5*(n.y+o.y)),h=new x(.5*(n.x+i.x),.5*(n.y+i.y)),l=new x(.5*(a.x+h.x),.5*(a.y+h.y));return[[t,o,a,l],[l,h,i,r]]},o=t=>{let e=t[0].distSquared(t[1]),s=t[2].distSquared(t[3]),r=.25*t[0].distSquared(t[2]),n=.25*t[1].distSquared(t[3]),o=e>s?e:s,i=r>n?r:n;return 18*(o>i?o:i)},i=(t,e)=>Math.sqrt(t.distSquared(e)),a=(t,e)=>t.scale(2/3).add(e.scale(1/3)),h=t=>{let e,s,r,n,o,i,a,h=new g;return t.match(/(\w+\(\s*[^)]+\))+/g).forEach(t=>{let l=t.match(/[\w.-]+/g),d=l.shift();switch(d){case"translate":2===l.length?e=new g(1,0,0,1,l[0],l[1]):(console.error("mesh.js: translate does not have 2 arguments!"),e=new g(1,0,0,1,0,0)),h=h.append(e);break;case"scale":1===l.length?s=new g(l[0],0,0,l[0],0,0):2===l.length?s=new g(l[0],0,0,l[1],0,0):(console.error("mesh.js: scale does not have 1 or 2 arguments!"),s=new g(1,0,0,1,0,0)),h=h.append(s);break;case"rotate":if(3===l.length&amp;&amp;(e=new g(1,0,0,1,l[1],l[2]),h=h.append(e)),l[0]){r=l[0]*Math.PI/180;let t=Math.cos(r),e=Math.sin(r);Math.abs(t)&lt;1e-16&amp;&amp;(t=0),Math.abs(e)&lt;1e-16&amp;&amp;(e=0),a=new g(t,e,-e,t,0,0),h=h.append(a)}else console.error("math.js: No argument to rotate transform!");3===l.length&amp;&amp;(e=new g(1,0,0,1,-l[1],-l[2]),h=h.append(e));break;case"skewX":l[0]?(r=l[0]*Math.PI/180,n=Math.tan(r),o=new g(1,0,n,1,0,0),h=h.append(o)):console.error("math.js: No argument to skewX transform!");break;case"skewY":l[0]?(r=l[0]*Math.PI/180,n=Math.tan(r),i=new g(1,n,0,1,0,0),h=h.append(i)):console.error("math.js: No argument to skewY transform!");break;case"matrix":6===l.length?h=h.append(new g(...l)):console.error("math.js: Incorrect number of arguments for matrix!");break;default:console.error("mesh.js: Unhandled transform type: "+d)}}),h},l=t=>{let e=[],s=t.split(/[ ,]+/);for(let t=0,r=s.length-1;t&lt;r;t+=2)e.push(new x(parseFloat(s[t]),parseFloat(s[t+1])));return e},d=(t,e)=>{for(let s in e)t.setAttribute(s,e[s])},c=(t,e,s,r,n)=>{let o,i,a=[0,0,0,0];for(let h=0;h&lt;3;++h)e[h]&lt;t[h]&amp;&amp;e[h]&lt;s[h]||t[h]&lt;e[h]&amp;&amp;s[h]&lt;e[h]?a[h]=0:(a[h]=.5*((e[h]-t[h])/r+(s[h]-e[h])/n),o=Math.abs(3*(e[h]-t[h])/r),i=Math.abs(3*(s[h]-e[h])/n),a[h]>o?a[h]=o:a[h]>i&amp;&amp;(a[h]=i));return a},u=[[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],[-3,3,0,0,-2,-1,0,0,0,0,0,0,0,0,0,0],[2,-2,0,0,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0,-3,3,0,0,-2,-1,0,0],[0,0,0,0,0,0,0,0,2,-2,0,0,1,1,0,0],[-3,0,3,0,0,0,0,0,-2,0,-1,0,0,0,0,0],[0,0,0,0,-3,0,3,0,0,0,0,0,-2,0,-1,0],[9,-9,-9,9,6,3,-6,-3,6,-6,3,-3,4,2,2,1],[-6,6,6,-6,-3,-3,3,3,-4,4,-2,2,-2,-2,-1,-1],[2,0,-2,0,0,0,0,0,1,0,1,0,0,0,0,0],[0,0,0,0,2,0,-2,0,0,0,0,0,1,0,1,0],[-6,6,6,-6,-4,-2,4,2,-3,3,-3,3,-2,-1,-2,-1],[4,-4,-4,4,2,2,-2,-2,2,-2,2,-2,1,1,1,1]],f=t=>{let e=[];for(let s=0;s&lt;16;++s){e[s]=0;for(let r=0;r&lt;16;++r)e[s]+=u[s][r]*t[r]}return e},p=(t,e,s)=>{const r=e*e,n=s*s,o=e*e*e,i=s*s*s;return t[0]+t[1]*e+t[2]*r+t[3]*o+t[4]*s+t[5]*s*e+t[6]*s*r+t[7]*s*o+t[8]*n+t[9]*n*e+t[10]*n*r+t[11]*n*o+t[12]*i+t[13]*i*e+t[14]*i*r+t[15]*i*o},y=t=>{let e=[],s=[],r=[];for(let s=0;s&lt;4;++s)e[s]=[],e[s][0]=n(t[0][s],t[1][s],t[2][s],t[3][s]),e[s][1]=[],e[s][1].push(...n(...e[s][0][0])),e[s][1].push(...n(...e[s][0][1])),e[s][2]=[],e[s][2].push(...n(...e[s][1][0])),e[s][2].push(...n(...e[s][1][1])),e[s][2].push(...n(...e[s][1][2])),e[s][2].push(...n(...e[s][1][3]));for(let t=0;t&lt;8;++t){s[t]=[];for(let r=0;r&lt;4;++r)s[t][r]=[],s[t][r][0]=n(e[0][2][t][r],e[1][2][t][r],e[2][2][t][r],e[3][2][t][r]),s[t][r][1]=[],s[t][r][1].push(...n(...s[t][r][0][0])),s[t][r][1].push(...n(...s[t][r][0][1])),s[t][r][2]=[],s[t][r][2].push(...n(...s[t][r][1][0])),s[t][r][2].push(...n(...s[t][r][1][1])),s[t][r][2].push(...n(...s[t][r][1][2])),s[t][r][2].push(...n(...s[t][r][1][3]))}for(let t=0;t&lt;8;++t){r[t]=[];for(let e=0;e&lt;8;++e)r[t][e]=[],r[t][e][0]=s[t][0][2][e],r[t][e][1]=s[t][1][2][e],r[t][e][2]=s[t][2][2][e],r[t][e][3]=s[t][3][2][e]}return r};class x{constructor(t,e){this.x=t||0,this.y=e||0}toString(){return`(x=${this.x}, y=${this.y})`}clone(){return new x(this.x,this.y)}add(t){return new x(this.x+t.x,this.y+t.y)}scale(t){return void 0===t.x?new x(this.x*t,this.y*t):new x(this.x*t.x,this.y*t.y)}distSquared(t){let e=this.x-t.x,s=this.y-t.y;return e*e+s*s}transform(t){let e=this.x*t.a+this.y*t.c+t.e,s=this.x*t.b+this.y*t.d+t.f;return new x(e,s)}}class g{constructor(t,e,s,r,n,o){void 0===t?(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0):(this.a=t,this.b=e,this.c=s,this.d=r,this.e=n,this.f=o)}toString(){return`affine: ${this.a} ${this.c} ${this.e} \n ${this.b} ${this.d} ${this.f}`}append(t){t instanceof g||console.error("mesh.js: argument to Affine.append is not affine!");let e=this.a*t.a+this.c*t.b,s=this.b*t.a+this.d*t.b,r=this.a*t.c+this.c*t.d,n=this.b*t.c+this.d*t.d,o=this.a*t.e+this.c*t.f+this.e,i=this.b*t.e+this.d*t.f+this.f;return new g(e,s,r,n,o,i)}}class w{constructor(t,e){this.nodes=t,this.colors=e}paintCurve(t,e){if(o(this.nodes)>r){const s=n(...this.nodes);let r=[[],[]],o=[[],[]];for(let t=0;t&lt;4;++t)r[0][t]=this.colors[0][t],r[1][t]=(this.colors[0][t]+this.colors[1][t])/2,o[0][t]=r[1][t],o[1][t]=this.colors[1][t];let i=new w(s[0],r),a=new w(s[1],o);i.paintCurve(t,e),a.paintCurve(t,e)}else{let s=Math.round(this.nodes[0].x);if(s>=0&amp;&amp;s&lt;e){let r=4*(~~this.nodes[0].y*e+s);t[r]=Math.round(this.colors[0][0]),t[r+1]=Math.round(this.colors[0][1]),t[r+2]=Math.round(this.colors[0][2]),t[r+3]=Math.round(this.colors[0][3])}}}}class m{constructor(t,e){this.nodes=t,this.colors=e}split(){let t=[[],[],[],[]],e=[[],[],[],[]],s=[[[],[]],[[],[]]],r=[[[],[]],[[],[]]];for(let s=0;s&lt;4;++s){const r=n(this.nodes[0][s],this.nodes[1][s],this.nodes[2][s],this.nodes[3][s]);t[0][s]=r[0][0],t[1][s]=r[0][1],t[2][s]=r[0][2],t[3][s]=r[0][3],e[0][s]=r[1][0],e[1][s]=r[1][1],e[2][s]=r[1][2],e[3][s]=r[1][3]}for(let t=0;t&lt;4;++t)s[0][0][t]=this.colors[0][0][t],s[0][1][t]=this.colors[0][1][t],s[1][0][t]=(this.colors[0][0][t]+this.colors[1][0][t])/2,s[1][1][t]=(this.colors[0][1][t]+this.colors[1][1][t])/2,r[0][0][t]=s[1][0][t],r[0][1][t]=s[1][1][t],r[1][0][t]=this.colors[1][0][t],r[1][1][t]=this.colors[1][1][t];return[new m(t,s),new m(e,r)]}paint(t,e){let s,n=!1;for(let t=0;t&lt;4;++t)if((s=o([this.nodes[0][t],this.nodes[1][t],this.nodes[2][t],this.nodes[3][t]]))>r){n=!0;break}if(n){let s=this.split();s[0].paint(t,e),s[1].paint(t,e)}else{new w([...this.nodes[0]],[...this.colors[0]]).paintCurve(t,e)}}}class b{constructor(t){this.readMesh(t),this.type=t.getAttribute("type")||"bilinear"}readMesh(t){let e=[[]],s=[[]],r=Number(t.getAttribute("x")),n=Number(t.getAttribute("y"));e[0][0]=new x(r,n);let o=t.children;for(let t=0,r=o.length;t&lt;r;++t){e[3*t+1]=[],e[3*t+2]=[],e[3*t+3]=[],s[t+1]=[];let r=o[t].children;for(let n=0,o=r.length;n&lt;o;++n){let o=r[n].children;for(let r=0,i=o.length;r&lt;i;++r){let i=r;0!==t&amp;&amp;++i;let h,d=o[r].getAttribute("path"),c="l";null!=d&amp;&amp;(c=(h=d.match(/\s*([lLcC])\s*(.*)/))[1]);let u=l(h[2]);switch(c){case"l":0===i?(e[3*t][3*n+3]=u[0].add(e[3*t][3*n]),e[3*t][3*n+1]=a(e[3*t][3*n],e[3*t][3*n+3]),e[3*t][3*n+2]=a(e[3*t][3*n+3],e[3*t][3*n])):1===i?(e[3*t+3][3*n+3]=u[0].add(e[3*t][3*n+3]),e[3*t+1][3*n+3]=a(e[3*t][3*n+3],e[3*t+3][3*n+3]),e[3*t+2][3*n+3]=a(e[3*t+3][3*n+3],e[3*t][3*n+3])):2===i?(0===n&amp;&amp;(e[3*t+3][3*n+0]=u[0].add(e[3*t+3][3*n+3])),e[3*t+3][3*n+1]=a(e[3*t+3][3*n],e[3*t+3][3*n+3]),e[3*t+3][3*n+2]=a(e[3*t+3][3*n+3],e[3*t+3][3*n])):(e[3*t+1][3*n]=a(e[3*t][3*n],e[3*t+3][3*n]),e[3*t+2][3*n]=a(e[3*t+3][3*n],e[3*t][3*n]));break;case"L":0===i?(e[3*t][3*n+3]=u[0],e[3*t][3*n+1]=a(e[3*t][3*n],e[3*t][3*n+3]),e[3*t][3*n+2]=a(e[3*t][3*n+3],e[3*t][3*n])):1===i?(e[3*t+3][3*n+3]=u[0],e[3*t+1][3*n+3]=a(e[3*t][3*n+3],e[3*t+3][3*n+3]),e[3*t+2][3*n+3]=a(e[3*t+3][3*n+3],e[3*t][3*n+3])):2===i?(0===n&amp;&amp;(e[3*t+3][3*n+0]=u[0]),e[3*t+3][3*n+1]=a(e[3*t+3][3*n],e[3*t+3][3*n+3]),e[3*t+3][3*n+2]=a(e[3*t+3][3*n+3],e[3*t+3][3*n])):(e[3*t+1][3*n]=a(e[3*t][3*n],e[3*t+3][3*n]),e[3*t+2][3*n]=a(e[3*t+3][3*n],e[3*t][3*n]));break;case"c":0===i?(e[3*t][3*n+1]=u[0].add(e[3*t][3*n]),e[3*t][3*n+2]=u[1].add(e[3*t][3*n]),e[3*t][3*n+3]=u[2].add(e[3*t][3*n])):1===i?(e[3*t+1][3*n+3]=u[0].add(e[3*t][3*n+3]),e[3*t+2][3*n+3]=u[1].add(e[3*t][3*n+3]),e[3*t+3][3*n+3]=u[2].add(e[3*t][3*n+3])):2===i?(e[3*t+3][3*n+2]=u[0].add(e[3*t+3][3*n+3]),e[3*t+3][3*n+1]=u[1].add(e[3*t+3][3*n+3]),0===n&amp;&amp;(e[3*t+3][3*n+0]=u[2].add(e[3*t+3][3*n+3]))):(e[3*t+2][3*n]=u[0].add(e[3*t+3][3*n]),e[3*t+1][3*n]=u[1].add(e[3*t+3][3*n]));break;case"C":0===i?(e[3*t][3*n+1]=u[0],e[3*t][3*n+2]=u[1],e[3*t][3*n+3]=u[2]):1===i?(e[3*t+1][3*n+3]=u[0],e[3*t+2][3*n+3]=u[1],e[3*t+3][3*n+3]=u[2]):2===i?(e[3*t+3][3*n+2]=u[0],e[3*t+3][3*n+1]=u[1],0===n&amp;&amp;(e[3*t+3][3*n+0]=u[2])):(e[3*t+2][3*n]=u[0],e[3*t+1][3*n]=u[1]);break;default:console.error("mesh.js: "+c+" invalid path type.")}if(0===t&amp;&amp;0===n||r>0){let e=window.getComputedStyle(o[r]).stopColor.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i),a=window.getComputedStyle(o[r]).stopOpacity,h=255;a&amp;&amp;(h=Math.floor(255*a)),e&amp;&amp;(0===i?(s[t][n]=[],s[t][n][0]=Math.floor(e[1]),s[t][n][1]=Math.floor(e[2]),s[t][n][2]=Math.floor(e[3]),s[t][n][3]=h):1===i?(s[t][n+1]=[],s[t][n+1][0]=Math.floor(e[1]),s[t][n+1][1]=Math.floor(e[2]),s[t][n+1][2]=Math.floor(e[3]),s[t][n+1][3]=h):2===i?(s[t+1][n+1]=[],s[t+1][n+1][0]=Math.floor(e[1]),s[t+1][n+1][1]=Math.floor(e[2]),s[t+1][n+1][2]=Math.floor(e[3]),s[t+1][n+1][3]=h):3===i&amp;&amp;(s[t+1][n]=[],s[t+1][n][0]=Math.floor(e[1]),s[t+1][n][1]=Math.floor(e[2]),s[t+1][n][2]=Math.floor(e[3]),s[t+1][n][3]=h))}}e[3*t+1][3*n+1]=new x,e[3*t+1][3*n+2]=new x,e[3*t+2][3*n+1]=new x,e[3*t+2][3*n+2]=new x,e[3*t+1][3*n+1].x=(-4*e[3*t][3*n].x+6*(e[3*t][3*n+1].x+e[3*t+1][3*n].x)+-2*(e[3*t][3*n+3].x+e[3*t+3][3*n].x)+3*(e[3*t+3][3*n+1].x+e[3*t+1][3*n+3].x)+-1*e[3*t+3][3*n+3].x)/9,e[3*t+1][3*n+2].x=(-4*e[3*t][3*n+3].x+6*(e[3*t][3*n+2].x+e[3*t+1][3*n+3].x)+-2*(e[3*t][3*n].x+e[3*t+3][3*n+3].x)+3*(e[3*t+3][3*n+2].x+e[3*t+1][3*n].x)+-1*e[3*t+3][3*n].x)/9,e[3*t+2][3*n+1].x=(-4*e[3*t+3][3*n].x+6*(e[3*t+3][3*n+1].x+e[3*t+2][3*n].x)+-2*(e[3*t+3][3*n+3].x+e[3*t][3*n].x)+3*(e[3*t][3*n+1].x+e[3*t+2][3*n+3].x)+-1*e[3*t][3*n+3].x)/9,e[3*t+2][3*n+2].x=(-4*e[3*t+3][3*n+3].x+6*(e[3*t+3][3*n+2].x+e[3*t+2][3*n+3].x)+-2*(e[3*t+3][3*n].x+e[3*t][3*n+3].x)+3*(e[3*t][3*n+2].x+e[3*t+2][3*n].x)+-1*e[3*t][3*n].x)/9,e[3*t+1][3*n+1].y=(-4*e[3*t][3*n].y+6*(e[3*t][3*n+1].y+e[3*t+1][3*n].y)+-2*(e[3*t][3*n+3].y+e[3*t+3][3*n].y)+3*(e[3*t+3][3*n+1].y+e[3*t+1][3*n+3].y)+-1*e[3*t+3][3*n+3].y)/9,e[3*t+1][3*n+2].y=(-4*e[3*t][3*n+3].y+6*(e[3*t][3*n+2].y+e[3*t+1][3*n+3].y)+-2*(e[3*t][3*n].y+e[3*t+3][3*n+3].y)+3*(e[3*t+3][3*n+2].y+e[3*t+1][3*n].y)+-1*e[3*t+3][3*n].y)/9,e[3*t+2][3*n+1].y=(-4*e[3*t+3][3*n].y+6*(e[3*t+3][3*n+1].y+e[3*t+2][3*n].y)+-2*(e[3*t+3][3*n+3].y+e[3*t][3*n].y)+3*(e[3*t][3*n+1].y+e[3*t+2][3*n+3].y)+-1*e[3*t][3*n+3].y)/9,e[3*t+2][3*n+2].y=(-4*e[3*t+3][3*n+3].y+6*(e[3*t+3][3*n+2].y+e[3*t+2][3*n+3].y)+-2*(e[3*t+3][3*n].y+e[3*t][3*n+3].y)+3*(e[3*t][3*n+2].y+e[3*t+2][3*n].y)+-1*e[3*t][3*n].y)/9}}this.nodes=e,this.colors=s}paintMesh(t,e){let s=(this.nodes.length-1)/3,r=(this.nodes[0].length-1)/3;if("bilinear"===this.type||s&lt;2||r&lt;2){let n;for(let o=0;o&lt;s;++o)for(let s=0;s&lt;r;++s){let r=[];for(let t=3*o,e=3*o+4;t&lt;e;++t)r.push(this.nodes[t].slice(3*s,3*s+4));let i=[];i.push(this.colors[o].slice(s,s+2)),i.push(this.colors[o+1].slice(s,s+2)),(n=new m(r,i)).paint(t,e)}}else{let n,o,a,h,l,d,u;const x=s,g=r;s++,r++;let w=new Array(s);for(let t=0;t&lt;s;++t){w[t]=new Array(r);for(let e=0;e&lt;r;++e)w[t][e]=[],w[t][e][0]=this.nodes[3*t][3*e],w[t][e][1]=this.colors[t][e]}for(let t=0;t&lt;s;++t)for(let e=0;e&lt;r;++e)0!==t&amp;&amp;t!==x&amp;&amp;(n=i(w[t-1][e][0],w[t][e][0]),o=i(w[t+1][e][0],w[t][e][0]),w[t][e][2]=c(w[t-1][e][1],w[t][e][1],w[t+1][e][1],n,o)),0!==e&amp;&amp;e!==g&amp;&amp;(n=i(w[t][e-1][0],w[t][e][0]),o=i(w[t][e+1][0],w[t][e][0]),w[t][e][3]=c(w[t][e-1][1],w[t][e][1],w[t][e+1][1],n,o));for(let t=0;t&lt;r;++t){w[0][t][2]=[],w[x][t][2]=[];for(let e=0;e&lt;4;++e)n=i(w[1][t][0],w[0][t][0]),o=i(w[x][t][0],w[x-1][t][0]),w[0][t][2][e]=n>0?2*(w[1][t][1][e]-w[0][t][1][e])/n-w[1][t][2][e]:0,w[x][t][2][e]=o>0?2*(w[x][t][1][e]-w[x-1][t][1][e])/o-w[x-1][t][2][e]:0}for(let t=0;t&lt;s;++t){w[t][0][3]=[],w[t][g][3]=[];for(let e=0;e&lt;4;++e)n=i(w[t][1][0],w[t][0][0]),o=i(w[t][g][0],w[t][g-1][0]),w[t][0][3][e]=n>0?2*(w[t][1][1][e]-w[t][0][1][e])/n-w[t][1][3][e]:0,w[t][g][3][e]=o>0?2*(w[t][g][1][e]-w[t][g-1][1][e])/o-w[t][g-1][3][e]:0}for(let s=0;s&lt;x;++s)for(let r=0;r&lt;g;++r){let n=i(w[s][r][0],w[s+1][r][0]),o=i(w[s][r+1][0],w[s+1][r+1][0]),c=i(w[s][r][0],w[s][r+1][0]),x=i(w[s+1][r][0],w[s+1][r+1][0]),g=[[],[],[],[]];for(let t=0;t&lt;4;++t){(d=[])[0]=w[s][r][1][t],d[1]=w[s+1][r][1][t],d[2]=w[s][r+1][1][t],d[3]=w[s+1][r+1][1][t],d[4]=w[s][r][2][t]*n,d[5]=w[s+1][r][2][t]*n,d[6]=w[s][r+1][2][t]*o,d[7]=w[s+1][r+1][2][t]*o,d[8]=w[s][r][3][t]*c,d[9]=w[s+1][r][3][t]*x,d[10]=w[s][r+1][3][t]*c,d[11]=w[s+1][r+1][3][t]*x,d[12]=0,d[13]=0,d[14]=0,d[15]=0,u=f(d);for(let e=0;e&lt;9;++e){g[t][e]=[];for(let s=0;s&lt;9;++s)g[t][e][s]=p(u,e/8,s/8),g[t][e][s]>255?g[t][e][s]=255:g[t][e][s]&lt;0&amp;&amp;(g[t][e][s]=0)}}h=[];for(let t=3*s,e=3*s+4;t&lt;e;++t)h.push(this.nodes[t].slice(3*r,3*r+4));l=y(h);for(let s=0;s&lt;8;++s)for(let r=0;r&lt;8;++r)(a=new m(l[s][r],[[[g[0][s][r],g[1][s][r],g[2][s][r],g[3][s][r]],[g[0][s][r+1],g[1][s][r+1],g[2][s][r+1],g[3][s][r+1]]],[[g[0][s+1][r],g[1][s+1][r],g[2][s+1][r],g[3][s+1][r]],[g[0][s+1][r+1],g[1][s+1][r+1],g[2][s+1][r+1],g[3][s+1][r+1]]]])).paint(t,e)}}}transform(t){if(t instanceof x)for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].add(t);else if(t instanceof g)for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].transform(t)}scale(t){for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].scale(t)}}document.querySelectorAll("rect,circle,ellipse,path,text").forEach((r,n)=>{let o=r.getAttribute("id");o||(o="patchjs_shape"+n,r.setAttribute("id",o));const i=r.style.fill.match(/^url\(\s*"?\s*#([^\s"]+)"?\s*\)/),a=r.style.stroke.match(/^url\(\s*"?\s*#([^\s"]+)"?\s*\)/);if(i&amp;&amp;i[1]){const a=document.getElementById(i[1]);if(a&amp;&amp;"meshgradient"===a.nodeName){const i=r.getBBox();let l=document.createElementNS(s,"canvas");d(l,{width:i.width,height:i.height});const c=l.getContext("2d");let u=c.createImageData(i.width,i.height);const f=new b(a);"objectBoundingBox"===a.getAttribute("gradientUnits")&amp;&amp;f.scale(new x(i.width,i.height));const p=a.getAttribute("gradientTransform");null!=p&amp;&amp;f.transform(h(p)),"userSpaceOnUse"===a.getAttribute("gradientUnits")&amp;&amp;f.transform(new x(-i.x,-i.y)),f.paintMesh(u.data,l.width),c.putImageData(u,0,0);const y=document.createElementNS(t,"image");d(y,{width:i.width,height:i.height,x:i.x,y:i.y});let g=l.toDataURL();y.setAttributeNS(e,"xlink:href",g),r.parentNode.insertBefore(y,r),r.style.fill="none";const w=document.createElementNS(t,"use");w.setAttributeNS(e,"xlink:href","#"+o);const m="patchjs_clip"+n,M=document.createElementNS(t,"clipPath");M.setAttribute("id",m),M.appendChild(w),r.parentElement.insertBefore(M,r),y.setAttribute("clip-path","url(#"+m+")"),u=null,l=null,g=null}}if(a&amp;&amp;a[1]){const o=document.getElementById(a[1]);if(o&amp;&amp;"meshgradient"===o.nodeName){const i=parseFloat(r.style.strokeWidth.slice(0,-2))*(parseFloat(r.style.strokeMiterlimit)||parseFloat(r.getAttribute("stroke-miterlimit"))||1),a=r.getBBox(),l=Math.trunc(a.width+i),c=Math.trunc(a.height+i),u=Math.trunc(a.x-i/2),f=Math.trunc(a.y-i/2);let p=document.createElementNS(s,"canvas");d(p,{width:l,height:c});const y=p.getContext("2d");let g=y.createImageData(l,c);const w=new b(o);"objectBoundingBox"===o.getAttribute("gradientUnits")&amp;&amp;w.scale(new x(l,c));const m=o.getAttribute("gradientTransform");null!=m&amp;&amp;w.transform(h(m)),"userSpaceOnUse"===o.getAttribute("gradientUnits")&amp;&amp;w.transform(new x(-u,-f)),w.paintMesh(g.data,p.width),y.putImageData(g,0,0);const M=document.createElementNS(t,"image");d(M,{width:l,height:c,x:0,y:0});let S=p.toDataURL();M.setAttributeNS(e,"xlink:href",S);const k="pattern_clip"+n,A=document.createElementNS(t,"pattern");d(A,{id:k,patternUnits:"userSpaceOnUse",width:l,height:c,x:u,y:f}),A.appendChild(M),o.parentNode.appendChild(A),r.style.stroke="url(#"+k+")",g=null,p=null,S=null}}})}();</script></g><script id="script280328" type="text/javascript">!function(){const t="http://www.w3.org/2000/svg",e="http://www.w3.org/1999/xlink",s="http://www.w3.org/1999/xhtml",r=2;if(document.createElementNS(t,"meshgradient").x)return;const n=(t,e,s,r)=>{let n=new x(.5*(e.x+s.x),.5*(e.y+s.y)),o=new x(.5*(t.x+e.x),.5*(t.y+e.y)),i=new x(.5*(s.x+r.x),.5*(s.y+r.y)),a=new x(.5*(n.x+o.x),.5*(n.y+o.y)),h=new x(.5*(n.x+i.x),.5*(n.y+i.y)),l=new x(.5*(a.x+h.x),.5*(a.y+h.y));return[[t,o,a,l],[l,h,i,r]]},o=t=>{let e=t[0].distSquared(t[1]),s=t[2].distSquared(t[3]),r=.25*t[0].distSquared(t[2]),n=.25*t[1].distSquared(t[3]),o=e>s?e:s,i=r>n?r:n;return 18*(o>i?o:i)},i=(t,e)=>Math.sqrt(t.distSquared(e)),a=(t,e)=>t.scale(2/3).add(e.scale(1/3)),h=t=>{let e,s,r,n,o,i,a,h=new g;return t.match(/(\w+\(\s*[^)]+\))+/g).forEach(t=>{let l=t.match(/[\w.-]+/g),d=l.shift();switch(d){case"translate":2===l.length?e=new g(1,0,0,1,l[0],l[1]):(console.error("mesh.js: translate does not have 2 arguments!"),e=new g(1,0,0,1,0,0)),h=h.append(e);break;case"scale":1===l.length?s=new g(l[0],0,0,l[0],0,0):2===l.length?s=new g(l[0],0,0,l[1],0,0):(console.error("mesh.js: scale does not have 1 or 2 arguments!"),s=new g(1,0,0,1,0,0)),h=h.append(s);break;case"rotate":if(3===l.length&amp;&amp;(e=new g(1,0,0,1,l[1],l[2]),h=h.append(e)),l[0]){r=l[0]*Math.PI/180;let t=Math.cos(r),e=Math.sin(r);Math.abs(t)&lt;1e-16&amp;&amp;(t=0),Math.abs(e)&lt;1e-16&amp;&amp;(e=0),a=new g(t,e,-e,t,0,0),h=h.append(a)}else console.error("math.js: No argument to rotate transform!");3===l.length&amp;&amp;(e=new g(1,0,0,1,-l[1],-l[2]),h=h.append(e));break;case"skewX":l[0]?(r=l[0]*Math.PI/180,n=Math.tan(r),o=new g(1,0,n,1,0,0),h=h.append(o)):console.error("math.js: No argument to skewX transform!");break;case"skewY":l[0]?(r=l[0]*Math.PI/180,n=Math.tan(r),i=new g(1,n,0,1,0,0),h=h.append(i)):console.error("math.js: No argument to skewY transform!");break;case"matrix":6===l.length?h=h.append(new g(...l)):console.error("math.js: Incorrect number of arguments for matrix!");break;default:console.error("mesh.js: Unhandled transform type: "+d)}}),h},l=t=>{let e=[],s=t.split(/[ ,]+/);for(let t=0,r=s.length-1;t&lt;r;t+=2)e.push(new x(parseFloat(s[t]),parseFloat(s[t+1])));return e},d=(t,e)=>{for(let s in e)t.setAttribute(s,e[s])},c=(t,e,s,r,n)=>{let o,i,a=[0,0,0,0];for(let h=0;h&lt;3;++h)e[h]&lt;t[h]&amp;&amp;e[h]&lt;s[h]||t[h]&lt;e[h]&amp;&amp;s[h]&lt;e[h]?a[h]=0:(a[h]=.5*((e[h]-t[h])/r+(s[h]-e[h])/n),o=Math.abs(3*(e[h]-t[h])/r),i=Math.abs(3*(s[h]-e[h])/n),a[h]>o?a[h]=o:a[h]>i&amp;&amp;(a[h]=i));return a},u=[[1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0],[-3,3,0,0,-2,-1,0,0,0,0,0,0,0,0,0,0],[2,-2,0,0,1,1,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0],[0,0,0,0,0,0,0,0,-3,3,0,0,-2,-1,0,0],[0,0,0,0,0,0,0,0,2,-2,0,0,1,1,0,0],[-3,0,3,0,0,0,0,0,-2,0,-1,0,0,0,0,0],[0,0,0,0,-3,0,3,0,0,0,0,0,-2,0,-1,0],[9,-9,-9,9,6,3,-6,-3,6,-6,3,-3,4,2,2,1],[-6,6,6,-6,-3,-3,3,3,-4,4,-2,2,-2,-2,-1,-1],[2,0,-2,0,0,0,0,0,1,0,1,0,0,0,0,0],[0,0,0,0,2,0,-2,0,0,0,0,0,1,0,1,0],[-6,6,6,-6,-4,-2,4,2,-3,3,-3,3,-2,-1,-2,-1],[4,-4,-4,4,2,2,-2,-2,2,-2,2,-2,1,1,1,1]],f=t=>{let e=[];for(let s=0;s&lt;16;++s){e[s]=0;for(let r=0;r&lt;16;++r)e[s]+=u[s][r]*t[r]}return e},p=(t,e,s)=>{const r=e*e,n=s*s,o=e*e*e,i=s*s*s;return t[0]+t[1]*e+t[2]*r+t[3]*o+t[4]*s+t[5]*s*e+t[6]*s*r+t[7]*s*o+t[8]*n+t[9]*n*e+t[10]*n*r+t[11]*n*o+t[12]*i+t[13]*i*e+t[14]*i*r+t[15]*i*o},y=t=>{let e=[],s=[],r=[];for(let s=0;s&lt;4;++s)e[s]=[],e[s][0]=n(t[0][s],t[1][s],t[2][s],t[3][s]),e[s][1]=[],e[s][1].push(...n(...e[s][0][0])),e[s][1].push(...n(...e[s][0][1])),e[s][2]=[],e[s][2].push(...n(...e[s][1][0])),e[s][2].push(...n(...e[s][1][1])),e[s][2].push(...n(...e[s][1][2])),e[s][2].push(...n(...e[s][1][3]));for(let t=0;t&lt;8;++t){s[t]=[];for(let r=0;r&lt;4;++r)s[t][r]=[],s[t][r][0]=n(e[0][2][t][r],e[1][2][t][r],e[2][2][t][r],e[3][2][t][r]),s[t][r][1]=[],s[t][r][1].push(...n(...s[t][r][0][0])),s[t][r][1].push(...n(...s[t][r][0][1])),s[t][r][2]=[],s[t][r][2].push(...n(...s[t][r][1][0])),s[t][r][2].push(...n(...s[t][r][1][1])),s[t][r][2].push(...n(...s[t][r][1][2])),s[t][r][2].push(...n(...s[t][r][1][3]))}for(let t=0;t&lt;8;++t){r[t]=[];for(let e=0;e&lt;8;++e)r[t][e]=[],r[t][e][0]=s[t][0][2][e],r[t][e][1]=s[t][1][2][e],r[t][e][2]=s[t][2][2][e],r[t][e][3]=s[t][3][2][e]}return r};class x{constructor(t,e){this.x=t||0,this.y=e||0}toString(){return`(x=${this.x}, y=${this.y})`}clone(){return new x(this.x,this.y)}add(t){return new x(this.x+t.x,this.y+t.y)}scale(t){return void 0===t.x?new x(this.x*t,this.y*t):new x(this.x*t.x,this.y*t.y)}distSquared(t){let e=this.x-t.x,s=this.y-t.y;return e*e+s*s}transform(t){let e=this.x*t.a+this.y*t.c+t.e,s=this.x*t.b+this.y*t.d+t.f;return new x(e,s)}}class g{constructor(t,e,s,r,n,o){void 0===t?(this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0):(this.a=t,this.b=e,this.c=s,this.d=r,this.e=n,this.f=o)}toString(){return`affine: ${this.a} ${this.c} ${this.e} \n ${this.b} ${this.d} ${this.f}`}append(t){t instanceof g||console.error("mesh.js: argument to Affine.append is not affine!");let e=this.a*t.a+this.c*t.b,s=this.b*t.a+this.d*t.b,r=this.a*t.c+this.c*t.d,n=this.b*t.c+this.d*t.d,o=this.a*t.e+this.c*t.f+this.e,i=this.b*t.e+this.d*t.f+this.f;return new g(e,s,r,n,o,i)}}class w{constructor(t,e){this.nodes=t,this.colors=e}paintCurve(t,e){if(o(this.nodes)>r){const s=n(...this.nodes);let r=[[],[]],o=[[],[]];for(let t=0;t&lt;4;++t)r[0][t]=this.colors[0][t],r[1][t]=(this.colors[0][t]+this.colors[1][t])/2,o[0][t]=r[1][t],o[1][t]=this.colors[1][t];let i=new w(s[0],r),a=new w(s[1],o);i.paintCurve(t,e),a.paintCurve(t,e)}else{let s=Math.round(this.nodes[0].x);if(s>=0&amp;&amp;s&lt;e){let r=4*(~~this.nodes[0].y*e+s);t[r]=Math.round(this.colors[0][0]),t[r+1]=Math.round(this.colors[0][1]),t[r+2]=Math.round(this.colors[0][2]),t[r+3]=Math.round(this.colors[0][3])}}}}class m{constructor(t,e){this.nodes=t,this.colors=e}split(){let t=[[],[],[],[]],e=[[],[],[],[]],s=[[[],[]],[[],[]]],r=[[[],[]],[[],[]]];for(let s=0;s&lt;4;++s){const r=n(this.nodes[0][s],this.nodes[1][s],this.nodes[2][s],this.nodes[3][s]);t[0][s]=r[0][0],t[1][s]=r[0][1],t[2][s]=r[0][2],t[3][s]=r[0][3],e[0][s]=r[1][0],e[1][s]=r[1][1],e[2][s]=r[1][2],e[3][s]=r[1][3]}for(let t=0;t&lt;4;++t)s[0][0][t]=this.colors[0][0][t],s[0][1][t]=this.colors[0][1][t],s[1][0][t]=(this.colors[0][0][t]+this.colors[1][0][t])/2,s[1][1][t]=(this.colors[0][1][t]+this.colors[1][1][t])/2,r[0][0][t]=s[1][0][t],r[0][1][t]=s[1][1][t],r[1][0][t]=this.colors[1][0][t],r[1][1][t]=this.colors[1][1][t];return[new m(t,s),new m(e,r)]}paint(t,e){let s,n=!1;for(let t=0;t&lt;4;++t)if((s=o([this.nodes[0][t],this.nodes[1][t],this.nodes[2][t],this.nodes[3][t]]))>r){n=!0;break}if(n){let s=this.split();s[0].paint(t,e),s[1].paint(t,e)}else{new w([...this.nodes[0]],[...this.colors[0]]).paintCurve(t,e)}}}class b{constructor(t){this.readMesh(t),this.type=t.getAttribute("type")||"bilinear"}readMesh(t){let e=[[]],s=[[]],r=Number(t.getAttribute("x")),n=Number(t.getAttribute("y"));e[0][0]=new x(r,n);let o=t.children;for(let t=0,r=o.length;t&lt;r;++t){e[3*t+1]=[],e[3*t+2]=[],e[3*t+3]=[],s[t+1]=[];let r=o[t].children;for(let n=0,o=r.length;n&lt;o;++n){let o=r[n].children;for(let r=0,i=o.length;r&lt;i;++r){let i=r;0!==t&amp;&amp;++i;let h,d=o[r].getAttribute("path"),c="l";null!=d&amp;&amp;(c=(h=d.match(/\s*([lLcC])\s*(.*)/))[1]);let u=l(h[2]);switch(c){case"l":0===i?(e[3*t][3*n+3]=u[0].add(e[3*t][3*n]),e[3*t][3*n+1]=a(e[3*t][3*n],e[3*t][3*n+3]),e[3*t][3*n+2]=a(e[3*t][3*n+3],e[3*t][3*n])):1===i?(e[3*t+3][3*n+3]=u[0].add(e[3*t][3*n+3]),e[3*t+1][3*n+3]=a(e[3*t][3*n+3],e[3*t+3][3*n+3]),e[3*t+2][3*n+3]=a(e[3*t+3][3*n+3],e[3*t][3*n+3])):2===i?(0===n&amp;&amp;(e[3*t+3][3*n+0]=u[0].add(e[3*t+3][3*n+3])),e[3*t+3][3*n+1]=a(e[3*t+3][3*n],e[3*t+3][3*n+3]),e[3*t+3][3*n+2]=a(e[3*t+3][3*n+3],e[3*t+3][3*n])):(e[3*t+1][3*n]=a(e[3*t][3*n],e[3*t+3][3*n]),e[3*t+2][3*n]=a(e[3*t+3][3*n],e[3*t][3*n]));break;case"L":0===i?(e[3*t][3*n+3]=u[0],e[3*t][3*n+1]=a(e[3*t][3*n],e[3*t][3*n+3]),e[3*t][3*n+2]=a(e[3*t][3*n+3],e[3*t][3*n])):1===i?(e[3*t+3][3*n+3]=u[0],e[3*t+1][3*n+3]=a(e[3*t][3*n+3],e[3*t+3][3*n+3]),e[3*t+2][3*n+3]=a(e[3*t+3][3*n+3],e[3*t][3*n+3])):2===i?(0===n&amp;&amp;(e[3*t+3][3*n+0]=u[0]),e[3*t+3][3*n+1]=a(e[3*t+3][3*n],e[3*t+3][3*n+3]),e[3*t+3][3*n+2]=a(e[3*t+3][3*n+3],e[3*t+3][3*n])):(e[3*t+1][3*n]=a(e[3*t][3*n],e[3*t+3][3*n]),e[3*t+2][3*n]=a(e[3*t+3][3*n],e[3*t][3*n]));break;case"c":0===i?(e[3*t][3*n+1]=u[0].add(e[3*t][3*n]),e[3*t][3*n+2]=u[1].add(e[3*t][3*n]),e[3*t][3*n+3]=u[2].add(e[3*t][3*n])):1===i?(e[3*t+1][3*n+3]=u[0].add(e[3*t][3*n+3]),e[3*t+2][3*n+3]=u[1].add(e[3*t][3*n+3]),e[3*t+3][3*n+3]=u[2].add(e[3*t][3*n+3])):2===i?(e[3*t+3][3*n+2]=u[0].add(e[3*t+3][3*n+3]),e[3*t+3][3*n+1]=u[1].add(e[3*t+3][3*n+3]),0===n&amp;&amp;(e[3*t+3][3*n+0]=u[2].add(e[3*t+3][3*n+3]))):(e[3*t+2][3*n]=u[0].add(e[3*t+3][3*n]),e[3*t+1][3*n]=u[1].add(e[3*t+3][3*n]));break;case"C":0===i?(e[3*t][3*n+1]=u[0],e[3*t][3*n+2]=u[1],e[3*t][3*n+3]=u[2]):1===i?(e[3*t+1][3*n+3]=u[0],e[3*t+2][3*n+3]=u[1],e[3*t+3][3*n+3]=u[2]):2===i?(e[3*t+3][3*n+2]=u[0],e[3*t+3][3*n+1]=u[1],0===n&amp;&amp;(e[3*t+3][3*n+0]=u[2])):(e[3*t+2][3*n]=u[0],e[3*t+1][3*n]=u[1]);break;default:console.error("mesh.js: "+c+" invalid path type.")}if(0===t&amp;&amp;0===n||r>0){let e=window.getComputedStyle(o[r]).stopColor.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i),a=window.getComputedStyle(o[r]).stopOpacity,h=255;a&amp;&amp;(h=Math.floor(255*a)),e&amp;&amp;(0===i?(s[t][n]=[],s[t][n][0]=Math.floor(e[1]),s[t][n][1]=Math.floor(e[2]),s[t][n][2]=Math.floor(e[3]),s[t][n][3]=h):1===i?(s[t][n+1]=[],s[t][n+1][0]=Math.floor(e[1]),s[t][n+1][1]=Math.floor(e[2]),s[t][n+1][2]=Math.floor(e[3]),s[t][n+1][3]=h):2===i?(s[t+1][n+1]=[],s[t+1][n+1][0]=Math.floor(e[1]),s[t+1][n+1][1]=Math.floor(e[2]),s[t+1][n+1][2]=Math.floor(e[3]),s[t+1][n+1][3]=h):3===i&amp;&amp;(s[t+1][n]=[],s[t+1][n][0]=Math.floor(e[1]),s[t+1][n][1]=Math.floor(e[2]),s[t+1][n][2]=Math.floor(e[3]),s[t+1][n][3]=h))}}e[3*t+1][3*n+1]=new x,e[3*t+1][3*n+2]=new x,e[3*t+2][3*n+1]=new x,e[3*t+2][3*n+2]=new x,e[3*t+1][3*n+1].x=(-4*e[3*t][3*n].x+6*(e[3*t][3*n+1].x+e[3*t+1][3*n].x)+-2*(e[3*t][3*n+3].x+e[3*t+3][3*n].x)+3*(e[3*t+3][3*n+1].x+e[3*t+1][3*n+3].x)+-1*e[3*t+3][3*n+3].x)/9,e[3*t+1][3*n+2].x=(-4*e[3*t][3*n+3].x+6*(e[3*t][3*n+2].x+e[3*t+1][3*n+3].x)+-2*(e[3*t][3*n].x+e[3*t+3][3*n+3].x)+3*(e[3*t+3][3*n+2].x+e[3*t+1][3*n].x)+-1*e[3*t+3][3*n].x)/9,e[3*t+2][3*n+1].x=(-4*e[3*t+3][3*n].x+6*(e[3*t+3][3*n+1].x+e[3*t+2][3*n].x)+-2*(e[3*t+3][3*n+3].x+e[3*t][3*n].x)+3*(e[3*t][3*n+1].x+e[3*t+2][3*n+3].x)+-1*e[3*t][3*n+3].x)/9,e[3*t+2][3*n+2].x=(-4*e[3*t+3][3*n+3].x+6*(e[3*t+3][3*n+2].x+e[3*t+2][3*n+3].x)+-2*(e[3*t+3][3*n].x+e[3*t][3*n+3].x)+3*(e[3*t][3*n+2].x+e[3*t+2][3*n].x)+-1*e[3*t][3*n].x)/9,e[3*t+1][3*n+1].y=(-4*e[3*t][3*n].y+6*(e[3*t][3*n+1].y+e[3*t+1][3*n].y)+-2*(e[3*t][3*n+3].y+e[3*t+3][3*n].y)+3*(e[3*t+3][3*n+1].y+e[3*t+1][3*n+3].y)+-1*e[3*t+3][3*n+3].y)/9,e[3*t+1][3*n+2].y=(-4*e[3*t][3*n+3].y+6*(e[3*t][3*n+2].y+e[3*t+1][3*n+3].y)+-2*(e[3*t][3*n].y+e[3*t+3][3*n+3].y)+3*(e[3*t+3][3*n+2].y+e[3*t+1][3*n].y)+-1*e[3*t+3][3*n].y)/9,e[3*t+2][3*n+1].y=(-4*e[3*t+3][3*n].y+6*(e[3*t+3][3*n+1].y+e[3*t+2][3*n].y)+-2*(e[3*t+3][3*n+3].y+e[3*t][3*n].y)+3*(e[3*t][3*n+1].y+e[3*t+2][3*n+3].y)+-1*e[3*t][3*n+3].y)/9,e[3*t+2][3*n+2].y=(-4*e[3*t+3][3*n+3].y+6*(e[3*t+3][3*n+2].y+e[3*t+2][3*n+3].y)+-2*(e[3*t+3][3*n].y+e[3*t][3*n+3].y)+3*(e[3*t][3*n+2].y+e[3*t+2][3*n].y)+-1*e[3*t][3*n].y)/9}}this.nodes=e,this.colors=s}paintMesh(t,e){let s=(this.nodes.length-1)/3,r=(this.nodes[0].length-1)/3;if("bilinear"===this.type||s&lt;2||r&lt;2){let n;for(let o=0;o&lt;s;++o)for(let s=0;s&lt;r;++s){let r=[];for(let t=3*o,e=3*o+4;t&lt;e;++t)r.push(this.nodes[t].slice(3*s,3*s+4));let i=[];i.push(this.colors[o].slice(s,s+2)),i.push(this.colors[o+1].slice(s,s+2)),(n=new m(r,i)).paint(t,e)}}else{let n,o,a,h,l,d,u;const x=s,g=r;s++,r++;let w=new Array(s);for(let t=0;t&lt;s;++t){w[t]=new Array(r);for(let e=0;e&lt;r;++e)w[t][e]=[],w[t][e][0]=this.nodes[3*t][3*e],w[t][e][1]=this.colors[t][e]}for(let t=0;t&lt;s;++t)for(let e=0;e&lt;r;++e)0!==t&amp;&amp;t!==x&amp;&amp;(n=i(w[t-1][e][0],w[t][e][0]),o=i(w[t+1][e][0],w[t][e][0]),w[t][e][2]=c(w[t-1][e][1],w[t][e][1],w[t+1][e][1],n,o)),0!==e&amp;&amp;e!==g&amp;&amp;(n=i(w[t][e-1][0],w[t][e][0]),o=i(w[t][e+1][0],w[t][e][0]),w[t][e][3]=c(w[t][e-1][1],w[t][e][1],w[t][e+1][1],n,o));for(let t=0;t&lt;r;++t){w[0][t][2]=[],w[x][t][2]=[];for(let e=0;e&lt;4;++e)n=i(w[1][t][0],w[0][t][0]),o=i(w[x][t][0],w[x-1][t][0]),w[0][t][2][e]=n>0?2*(w[1][t][1][e]-w[0][t][1][e])/n-w[1][t][2][e]:0,w[x][t][2][e]=o>0?2*(w[x][t][1][e]-w[x-1][t][1][e])/o-w[x-1][t][2][e]:0}for(let t=0;t&lt;s;++t){w[t][0][3]=[],w[t][g][3]=[];for(let e=0;e&lt;4;++e)n=i(w[t][1][0],w[t][0][0]),o=i(w[t][g][0],w[t][g-1][0]),w[t][0][3][e]=n>0?2*(w[t][1][1][e]-w[t][0][1][e])/n-w[t][1][3][e]:0,w[t][g][3][e]=o>0?2*(w[t][g][1][e]-w[t][g-1][1][e])/o-w[t][g-1][3][e]:0}for(let s=0;s&lt;x;++s)for(let r=0;r&lt;g;++r){let n=i(w[s][r][0],w[s+1][r][0]),o=i(w[s][r+1][0],w[s+1][r+1][0]),c=i(w[s][r][0],w[s][r+1][0]),x=i(w[s+1][r][0],w[s+1][r+1][0]),g=[[],[],[],[]];for(let t=0;t&lt;4;++t){(d=[])[0]=w[s][r][1][t],d[1]=w[s+1][r][1][t],d[2]=w[s][r+1][1][t],d[3]=w[s+1][r+1][1][t],d[4]=w[s][r][2][t]*n,d[5]=w[s+1][r][2][t]*n,d[6]=w[s][r+1][2][t]*o,d[7]=w[s+1][r+1][2][t]*o,d[8]=w[s][r][3][t]*c,d[9]=w[s+1][r][3][t]*x,d[10]=w[s][r+1][3][t]*c,d[11]=w[s+1][r+1][3][t]*x,d[12]=0,d[13]=0,d[14]=0,d[15]=0,u=f(d);for(let e=0;e&lt;9;++e){g[t][e]=[];for(let s=0;s&lt;9;++s)g[t][e][s]=p(u,e/8,s/8),g[t][e][s]>255?g[t][e][s]=255:g[t][e][s]&lt;0&amp;&amp;(g[t][e][s]=0)}}h=[];for(let t=3*s,e=3*s+4;t&lt;e;++t)h.push(this.nodes[t].slice(3*r,3*r+4));l=y(h);for(let s=0;s&lt;8;++s)for(let r=0;r&lt;8;++r)(a=new m(l[s][r],[[[g[0][s][r],g[1][s][r],g[2][s][r],g[3][s][r]],[g[0][s][r+1],g[1][s][r+1],g[2][s][r+1],g[3][s][r+1]]],[[g[0][s+1][r],g[1][s+1][r],g[2][s+1][r],g[3][s+1][r]],[g[0][s+1][r+1],g[1][s+1][r+1],g[2][s+1][r+1],g[3][s+1][r+1]]]])).paint(t,e)}}}transform(t){if(t instanceof x)for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].add(t);else if(t instanceof g)for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].transform(t)}scale(t){for(let e=0,s=this.nodes.length;e&lt;s;++e)for(let s=0,r=this.nodes[0].length;s&lt;r;++s)this.nodes[e][s]=this.nodes[e][s].scale(t)}}document.querySelectorAll("rect,circle,ellipse,path,text").forEach((r,n)=>{let o=r.getAttribute("id");o||(o="patchjs_shape"+n,r.setAttribute("id",o));const i=r.style.fill.match(/^url\(\s*"?\s*#([^\s"]+)"?\s*\)/),a=r.style.stroke.match(/^url\(\s*"?\s*#([^\s"]+)"?\s*\)/);if(i&amp;&amp;i[1]){const a=document.getElementById(i[1]);if(a&amp;&amp;"meshgradient"===a.nodeName){const i=r.getBBox();let l=document.createElementNS(s,"canvas");d(l,{width:i.width,height:i.height});const c=l.getContext("2d");let u=c.createImageData(i.width,i.height);const f=new b(a);"objectBoundingBox"===a.getAttribute("gradientUnits")&amp;&amp;f.scale(new x(i.width,i.height));const p=a.getAttribute("gradientTransform");null!=p&amp;&amp;f.transform(h(p)),"userSpaceOnUse"===a.getAttribute("gradientUnits")&amp;&amp;f.transform(new x(-i.x,-i.y)),f.paintMesh(u.data,l.width),c.putImageData(u,0,0);const y=document.createElementNS(t,"image");d(y,{width:i.width,height:i.height,x:i.x,y:i.y});let g=l.toDataURL();y.setAttributeNS(e,"xlink:href",g),r.parentNode.insertBefore(y,r),r.style.fill="none";const w=document.createElementNS(t,"use");w.setAttributeNS(e,"xlink:href","#"+o);const m="patchjs_clip"+n,M=document.createElementNS(t,"clipPath");M.setAttribute("id",m),M.appendChild(w),r.parentElement.insertBefore(M,r),y.setAttribute("clip-path","url(#"+m+")"),u=null,l=null,g=null}}if(a&amp;&amp;a[1]){const o=document.getElementById(a[1]);if(o&amp;&amp;"meshgradient"===o.nodeName){const i=parseFloat(r.style.strokeWidth.slice(0,-2))*(parseFloat(r.style.strokeMiterlimit)||parseFloat(r.getAttribute("stroke-miterlimit"))||1),a=r.getBBox(),l=Math.trunc(a.width+i),c=Math.trunc(a.height+i),u=Math.trunc(a.x-i/2),f=Math.trunc(a.y-i/2);let p=document.createElementNS(s,"canvas");d(p,{width:l,height:c});const y=p.getContext("2d");let g=y.createImageData(l,c);const w=new b(o);"objectBoundingBox"===o.getAttribute("gradientUnits")&amp;&amp;w.scale(new x(l,c));const m=o.getAttribute("gradientTransform");null!=m&amp;&amp;w.transform(h(m)),"userSpaceOnUse"===o.getAttribute("gradientUnits")&amp;&amp;w.transform(new x(-u,-f)),w.paintMesh(g.data,p.width),y.putImageData(g,0,0);const M=document.createElementNS(t,"image");d(M,{width:l,height:c,x:0,y:0});let S=p.toDataURL();M.setAttributeNS(e,"xlink:href",S);const k="pattern_clip"+n,A=document.createElementNS(t,"pattern");d(A,{id:k,patternUnits:"userSpaceOnUse",width:l,height:c,x:u,y:f}),A.appendChild(M),o.parentNode.appendChild(A),r.style.stroke="url(#"+k+")",g=null,p=null,S=null}}})}();</script></svg><br><br><figcaption>Fig 14. Syscall Redirection</figcaption></figure><br></center></div><p>A PoC that wraps all this logic will be published on GitHub.</p><h2 id=conclusion>Conclusion</h2><p>Whilst this application uses the same obfuscator as in the previous blog post, it was configured with
multi-layered code obfuscation which includes control-flow flattening and MBA. In addition, the RASP checks are
also configured to crash the application instead of calling a callback function and displaying a message.
These improvements in the configuration of the obfuscator make the reverse engineering of the application
harder compared to the previous SingPass application.</p><p>This blog post also detailed a new AArch64-generic technique to intercept RASP syscalls
which resulted in a successful bypass of the RASP checks. This technique should also apply to Android AArch64.</p><p>This is the last part of this series about iOS obfuscation. As I said in the first disclaimer, the obfuscator used
for protecting these applications is and remains a good choice to protect assets from reverse engineering.</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>The graph is more convenient to explore if Javascript is enabled.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>We don&rsquo;t restore <code>x0</code> as we want to change the return value from <code>_syscall_handler</code>.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></p></div></div></div></div></main><script src=/vendor/bootstrap/dist/js/bootstrap.min.js></script>
<script src=/vendor/headroom.js/dist/headroom.min.js></script>
<script src=/vendor/onscreen/dist/on-screen.umd.min.js></script>
<script src=/vendor/jarallax/dist/jarallax.min.js></script>
<script src=/vendor/smooth-scroll/dist/smooth-scroll.polyfills.min.js></script>
<script src=/js/theme.bundle.js></script>
<script src=/vendor/@glidejs/glide/dist/glide.min.js></script>
<script src=/js/anime.min.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css integrity=sha384-KiWOvVjnN8qwAZbuQyWDIbfCLFhLXNETzBQjA/92pIowpC0d2O3nppDGQVgwd2nB crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.js integrity=sha384-0fdwu/T/EQMsQlrHCCHoH10pkPLlKA1jL5dFyUOvB3lfeT2540/2g6YgSi2BL14p crossorigin=anonymous></script>
<script>function katex_load(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\begin{equation}",right:"\\end{equation}",display:!0},{left:"\\begin{align}",right:"\\end{align}",display:!0},{left:"\\begin{alignat}",right:"\\end{alignat}",display:!0},{left:"\\begin{gather}",right:"\\end{gather}",display:!0},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})}</script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous onload=katex_load()></script>
<script src=/js/svg-pan-zoom.min.js></script>
<script src=/js/lightense.min.js></script>
<script>var cfg_flat=svgPanZoom("#sub_ebdc",{zoomScaleSensitivity:.5,controlIconsEnabled:1});cfg_flat.zoom(1.5),window.addEventListener("load",function(){Lightense(".lightense")},!1)</script></body></html>