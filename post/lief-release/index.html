<!doctype html><html lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=manifest href=manifest.webmanifest><link rel=icon type=image/png href=/img/favicon/favicon_hu2a60c33e6cc729e53465c846fe50d8b2_13867_32x32_fill_box_center_3.png><link rel=apple-touch-icon type=image/png href=/img/favicon/favicon_hu2a60c33e6cc729e53465c846fe50d8b2_13867_192x192_fill_box_center_3.png><meta name=description content="We are open-sourcing LIEF, a library to parse and manipulate ELF, PE and Mach-O binary formats. This blog post explains the purpose of this project and some parts of its architecture."><meta name=keywords content="lief"><meta property="og:type" content="article"><meta property="og:description" content="We are open-sourcing LIEF, a library to parse and manipulate ELF, PE and Mach-O binary formats. This blog post explains the purpose of this project and some parts of its architecture."><meta property="og:title" content="Open-sourcing LIEF | Romain Thomas"><meta property="og:site_name" content="Romain Thomas"><meta property="og:image" content="https://www.romainthomas.fr/post/lief-release/featured.png"><meta property="og:url" content="https://www.romainthomas.fr/post/lief-release/"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2017-04-04T00:00:00+00:00"><meta property="article:modified_time" content="2022-05-14T15:55:15+02:00"><meta property="article:tag" content="lief"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@rh0main"><meta name=twitter:creator content="@rh0main"><meta name=twitter:title content="Open-sourcing LIEF | Romain Thomas"><meta name=twitter:description content="We are open-sourcing LIEF, a library to parse and manipulate ELF, PE and Mach-O binary formats. This blog post explains the purpose of this project and some parts of its architecture."><meta name=twitter:domain content="https://www.romainthomas.fr/post/lief-release/"><meta property="twitter:image" content="https://www.romainthomas.fr/post/lief-release/featured.png"><title>Romain Thomas</title><link rel=canonical href=https://www.romainthomas.fr/post/lief-release/><link rel=stylesheet href=/css/fa-all.min.css><link rel=stylesheet href=/vendor/@glidejs/glide/dist/css/glide.core.min.css><link rel=stylesheet href=/vendor/@glidejs/glide/dist/css/glide.theme.min.css><link rel=stylesheet href=/css/theme.bundle.css><style>.hide{opacity:0}</style><noscript><style>.hide{opacity:1;!important}</style></noscript><style>.hero_background{position:relative;overflow:hidden}.hero_background:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:90%;z-index:1;opacity:.2;background-image:url(/img/bg_home.svg);background-repeat:repeat;background-position:50%;background-size:100%;transform:rotate(180deg)}.project_bg{position:relative;overflow:hidden}.project_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:.1;background-image:url(/img/bg_project.svg);background-repeat:repeat;background-position:50%;background-size:100%;transform:rotate(180deg)}.experience_bg{position:relative;overflow:hidden}.experience_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:.1;background-image:url(/img/bg_experience.svg);background-position:0 0;background-size:100%}.post_bg{position:relative;overflow:hidden}.post_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:80%;z-index:1;opacity:.6;background-image:url(/img/bg_post.svg);background-position:0 0;background-size:100%}.contact_bg{position:relative;overflow:hidden}.contact_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:80%;z-index:1;opacity:.2;background-image:url(/img/bg_contact.svg);background-position:0 0;background-size:100%}.footnotes p{margin-bottom:0}.highlight{padding-left:20px;border-left:1px solid rgba(0,0,0,.1);border-radius:2px 2px}</style></head><body><header class=header-global><nav id=navbar-main aria-label="Primary navigation" class="navbar navbar-main navbar-expand-lg navbar-theme-primary headroom navbar-dark"><div class="container position-relative"><a class="navbar-brand me-lg-5" href=https://www.romainthomas.fr/><span class="navbar-brand-dark ft-ananda">R. T</span>
<span class="navbar-brand-light ft-ananda">R. T</span></a><div class="navbar-collapse collapse me-auto" id=navbar_global><div class=navbar-collapse-header><div class=row><div class="col-6 collapse-close"><a href=#navbar_global class="fas fa-times" data-bs-toggle=collapse data-bs-target=#navbar_global aria-controls=navbar_global aria-expanded=false title=close aria-label="Toggle navigation"></a></div></div></div><ul class="navbar-nav navbar-nav-hover align-items-lg-center"><li class=nav-item><a href=https://www.romainthomas.fr/#about class="nav-link fw-bold"><span class="fa-regular fa-person-swimming"></span> About</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#posts class="nav-link fw-bold"><span class="fa-regular fa-blog"></span> Posts</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#projects class="nav-link fw-bold"><span class="fa-regular fa-terminal"></span> Projects</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#publications class="nav-link fw-bold"><span class="far fa-book-open-cover"></span> Publications</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#work-experience class="nav-link fw-bold"><span class="fa-regular fa-briefcase"></span> Work Experience</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#misc class="nav-link fw-bold"><span class="fa-regular fa-chart-network"></span> Misc</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#contact class="nav-link fw-bold"><span class="fa-regular fa-binary-lock"></span> Contact</a></li></ul></div><div class="d-flex align-items-center"><button class="navbar-toggler ms-2 collapsed" type=button data-bs-toggle=collapse data-bs-target=#navbar_global aria-controls=navbar_global aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button></div></div></nav></header><main><section class="section-header pb-5 pb-sm-7 bg-primary text-white post_bg"><div class=container><div class="row justify-content-center"><div class="col-12 col-lg-10 text-center"><div class=mb-4></div><h1 class="display-3 mb-4 px-lg-5">Open-sourcing LIEF</h1><div class=post-meta><span class="fw-bold me-3">Romain Thomas</span>
<span class="post-date me-3">April 4, 2017</span>
<span class=fw-bold>5 min read</span></div></div></div></div><figure class="position-absolute bottom-0 left-0 w-100 d-none d-md-block mb-n2"><svg class="fill-white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 3e3 185.4"><path d="M3e3.0v185.4H0V0c496.4 115.6 996.4 173.4 15e2 173.4S2503.6 115.6 3e3.0z"/></svg></figure></section><section class="section section-lg pt-0 pb-0" id=featured><div class="container mt-n8 mt-lg-n10 z-2 pb-0"><div class="row mt-7 mx-10"><img src=/post/lief-release/featured.png class="rounded img-fluid" alt=featured.png></div></div></section><div class="section section-sm bg-white pt-4 pt-lg-4 text-black"><article class=container><div class="row justify-content-center"><div class="col-12 col-lg-9"><p><div class="col-12 col-md-12 mb-4 mb-lg-4 mt-4"><div class="p-4 rounded col-12 alert alert-info" style=background-color:#fafcff><div class="d-flex px-3"><div><div class="icon icon-sm icon-secondary"><span class="fa-duotone fa-link-horizontal" style=color:#084298></span></div></div><div class=ps-4><span class="h6 m-0 mb-1" style=color:#084298>This post has been originally posted on the <a href=https://blog.quarkslab.com/lief-library-to-instrument-executable-formats.html>Quarkslab&rsquo;s blog</a></span></div></div></div></div><h1 id=executable-file-formats-in-a-nutshell>Executable File Formats in a Nutshell</h1><p>When dealing with executable files, the first layer of information is the format in which the code is wrapped. We can see an executable file format
as an envelope. It contains information so that the postman (i.e. Operating System) can handle and deliver (i.e. execute) it.
The message wrapped by this envelope would be the machine code.</p><p>There are mainly three mainstream formats, one per OS:</p><ul><li><strong>P</strong>ortable <strong>E</strong>xecutable (<strong>PE</strong>) for Windows systems</li><li><strong>E</strong>xecutable and <strong>L</strong>inkable <strong>F</strong>ormat (<strong>ELF</strong>) for UN*X systems (Linux, Android&mldr;).</li><li>Mach-O for OS-X, iOS&mldr;</li></ul><p>Other executable file formats, such as <code>COFF</code>, exist but they are less relevant.</p><p>Usually each format has a header which describes at least the target architecture, the program&rsquo;s entry point and the type of the wrapped object (executable, library&mldr;)
Then we have blocks of data that will be mapped by the OS&rsquo;s loader. These blocks of data could hold machine code (<code>.text</code>), read-only data (<code>.rodata</code>) or other OS specific information.</p><p>For PE there is only one kind of such block: <strong>Section</strong>. For ELF and Mach-O formats, a section has a different meaning. In these formats,
sections are used by the <strong>linker</strong> at the <strong>compilation</strong> step, whereas <strong>segments</strong> (second type of block) are used by the OS&rsquo;s loader at <strong>execution</strong> step. Thus
sections are not mandatory for ELF and Mach-O formats and can be removed without affecting the execution.</p><h1 id=purpose-of-lief>Purpose of LIEF</h1><p>It turns out that many projects need to parse executable file formats but don&rsquo;t use a <em>standard</em> library and re-implement their own parser (and the wheel).
Moreover, these parsers are usually bound to one language.</p><p>On Unix system one can find the <code>objdump</code> and <code>objcopy</code> utilities but they are limited to Unix and the API is not user-friendly.</p><p>The purpose of LIEF is to fill this void:</p><ul><li>Providing a cross platform library which can parse and modify (in a certain extent) ELF, PE and Mach-O formats using a common abstraction</li><li>Providing an API for different languages (Python, C++, C&mldr;)</li><li>Abstract common features from the different formats (Section, header, entry point, symbols&mldr;)</li></ul><p>The following snippets show how to obtain information about an executable using different API of LIEF:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>  <span style=color:green;font-weight:700>import</span> <span style=color:#00f;font-weight:700>lief</span>
</span></span><span style=display:flex><span>  <span style=color:#408080;font-style:italic># ELF</span>
</span></span><span style=display:flex><span>  binary <span style=color:#666>=</span> lief<span style=color:#666>.</span>parse(<span style=color:#ba2121>&#34;/usr/bin/ls&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:green>print</span>(binary)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#408080;font-style:italic># PE</span>
</span></span><span style=display:flex><span>  binary <span style=color:#666>=</span> lief<span style=color:#666>.</span>parse(<span style=color:#ba2121>&#34;C:</span><span style=color:#b62;font-weight:700>\\</span><span style=color:#ba2121>Windows</span><span style=color:#b62;font-weight:700>\\</span><span style=color:#ba2121>explorer.exe&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:green>print</span>(binary)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#408080;font-style:italic># Mach-O</span>
</span></span><span style=display:flex><span>  binary <span style=color:#666>=</span> lief<span style=color:#666>.</span>parse(<span style=color:#ba2121>&#34;/usr/bin/ls&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:green>print</span>(binary)
</span></span></code></pre></div><p>With the <code>C++</code> API:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#bc7a00>#include</span> <span style=color:#bc7a00>&lt;LIEF/LIEF.hpp&gt;</span><span style=color:#bc7a00>
</span></span></span><span style=display:flex><span><span style=color:#bc7a00></span>  <span style=color:#b00040>int</span> <span style=color:#00f>main</span>(<span style=color:#b00040>int</span> argc, <span style=color:green;font-weight:700>const</span> <span style=color:#b00040>char</span><span style=color:#666>**</span> argv) {
</span></span><span style=display:flex><span>    LIEF<span style=color:#666>::</span>ELF<span style=color:#666>::</span>Binary<span style=color:#666>*</span>   elf   <span style=color:#666>=</span> LIEF<span style=color:#666>::</span>ELF<span style=color:#666>::</span>Parser<span style=color:#666>::</span>parse(<span style=color:#ba2121>&#34;/usr/bin/ls&#34;</span>);
</span></span><span style=display:flex><span>    LIEF<span style=color:#666>::</span>PE<span style=color:#666>::</span>Binary<span style=color:#666>*</span>    pe    <span style=color:#666>=</span> LIEF<span style=color:#666>::</span>PE<span style=color:#666>::</span>Parser<span style=color:#666>::</span>parse(<span style=color:#ba2121>&#34;C:</span><span style=color:#b62;font-weight:700>\\</span><span style=color:#ba2121>Windows</span><span style=color:#b62;font-weight:700>\\</span><span style=color:#ba2121>explorer.exe&#34;</span>);
</span></span><span style=display:flex><span>    LIEF<span style=color:#666>::</span>MachO<span style=color:#666>::</span>Binary<span style=color:#666>*</span> macho <span style=color:#666>=</span> LIEF<span style=color:#666>::</span>MachO<span style=color:#666>::</span>Parser<span style=color:#666>::</span>parse(<span style=color:#ba2121>&#34;/usr/bin/ls&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    std<span style=color:#666>::</span>cout <span style=color:#666>&lt;&lt;</span> <span style=color:#666>*</span>elf   <span style=color:#666>&lt;&lt;</span> std<span style=color:#666>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#666>::</span>cout <span style=color:#666>&lt;&lt;</span> <span style=color:#666>*</span>pe    <span style=color:#666>&lt;&lt;</span> std<span style=color:#666>::</span>endl;
</span></span><span style=display:flex><span>    std<span style=color:#666>::</span>cout <span style=color:#666>&lt;&lt;</span> <span style=color:#666>*</span>macho <span style=color:#666>&lt;&lt;</span> std<span style=color:#666>::</span>endl;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green;font-weight:700>delete</span> elf;
</span></span><span style=display:flex><span>    <span style=color:green;font-weight:700>delete</span> pe;
</span></span><span style=display:flex><span>    <span style=color:green;font-weight:700>delete</span> macho;
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><p>And finally with the <code>C</code> API:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-C data-lang=C><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#bc7a00>#include</span> <span style=color:#bc7a00>&lt;LIEF/LIEF.h&gt;</span><span style=color:#bc7a00>
</span></span></span><span style=display:flex><span><span style=color:#bc7a00></span>  <span style=color:#b00040>int</span> <span style=color:#00f>main</span>(<span style=color:#b00040>int</span> argc, <span style=color:green;font-weight:700>const</span> <span style=color:#b00040>char</span><span style=color:#666>**</span> argv) {
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Elf_Binary_t<span style=color:#666>*</span>    elf_binary     <span style=color:#666>=</span> elf_parse(<span style=color:#ba2121>&#34;/usr/bin/ls&#34;</span>);
</span></span><span style=display:flex><span>    Pe_Binary_t<span style=color:#666>*</span>     pe_binary      <span style=color:#666>=</span> pe_parse(<span style=color:#ba2121>&#34;C:</span><span style=color:#b62;font-weight:700>\\</span><span style=color:#ba2121>Windows</span><span style=color:#b62;font-weight:700>\\</span><span style=color:#ba2121>explorer.exe&#34;</span>);
</span></span><span style=display:flex><span>    Macho_Binary_t<span style=color:#666>**</span> macho_binaries <span style=color:#666>=</span> macho_parse(<span style=color:#ba2121>&#34;/usr/bin/ls&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    Pe_Section_t<span style=color:#666>**</span>    pe_sections    <span style=color:#666>=</span> pe_binary<span style=color:#666>-&gt;</span>sections;
</span></span><span style=display:flex><span>    Elf_Section_t<span style=color:#666>**</span>   elf_sections   <span style=color:#666>=</span> elf_binary<span style=color:#666>-&gt;</span>sections;
</span></span><span style=display:flex><span>    Macho_Section_t<span style=color:#666>**</span> macho_sections <span style=color:#666>=</span> macho_binaries[<span style=color:#666>0</span>]<span style=color:#666>-&gt;</span>sections;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green;font-weight:700>for</span> (size_t i <span style=color:#666>=</span> <span style=color:#666>0</span>; pe_sections[i] <span style=color:#666>!=</span> <span style=color:green>NULL</span>; <span style=color:#666>++</span>i) {
</span></span><span style=display:flex><span>      printf(<span style=color:#ba2121>&#34;%s</span><span style=color:#b62;font-weight:700>\n</span><span style=color:#ba2121>&#34;</span>, pe_sections[i]<span style=color:#666>-&gt;</span>name)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green;font-weight:700>for</span> (size_t i <span style=color:#666>=</span> <span style=color:#666>0</span>; elf_sections[i] <span style=color:#666>!=</span> <span style=color:green>NULL</span>; <span style=color:#666>++</span>i) {
</span></span><span style=display:flex><span>      printf(<span style=color:#ba2121>&#34;%s</span><span style=color:#b62;font-weight:700>\n</span><span style=color:#ba2121>&#34;</span>, elf_sections[i]<span style=color:#666>-&gt;</span>name)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green;font-weight:700>for</span> (size_t i <span style=color:#666>=</span> <span style=color:#666>0</span>; macho_sections[i] <span style=color:#666>!=</span> <span style=color:green>NULL</span>; <span style=color:#666>++</span>i) {
</span></span><span style=display:flex><span>      printf(<span style=color:#ba2121>&#34;%s</span><span style=color:#b62;font-weight:700>\n</span><span style=color:#ba2121>&#34;</span>, macho_sections[i]<span style=color:#666>-&gt;</span>name)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    elf_binary_destroy(elf_binary);
</span></span><span style=display:flex><span>    pe_binary_destroy(pe_binary);
</span></span><span style=display:flex><span>    macho_binaries_destroy(macho_binaries);
</span></span><span style=display:flex><span>  }
</span></span></code></pre></div><p>LIEF supports FAT-MachO and one can iterate over binaries as follows:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>  <span style=color:green;font-weight:700>import</span> <span style=color:#00f;font-weight:700>lief</span>
</span></span><span style=display:flex><span>  binaries <span style=color:#666>=</span> lief<span style=color:#666>.</span>MachO<span style=color:#666>.</span>parse(<span style=color:#ba2121>&#34;/usr/lib/libc++abi.dylib&#34;</span>)
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>for</span> binary <span style=color:#a2f;font-weight:700>in</span> binaries:
</span></span><span style=display:flex><span>    <span style=color:green>print</span>(binary)
</span></span></code></pre></div><div class="col-12 col-md-12 mb-4 mb-lg-4 mt-4"><div class="p-4 rounded col-12 alert alert-info" style=border:none!important;background-color:#fafcff><div class="d-flex px-3"><div><div class="icon icon-sm icon-secondary"><span class="fas fa-circle-info" style=color:#084298></span></div></div><div class=ps-4 style=color:#084298><h3 class="h5 m-0 mb-1" style=color:#084298>Note</h3>The above script uses the <code>lief.MachO.parse</code> function instead of the <code>lief.parse</code> function because <code>lief.parse</code> returns a <strong>single</strong> <code>lief.MachO.binary</code> object
whereas <code>lief.MachO.parse</code> returns a <strong>list</strong> of <code>lief.MachO.binary</code> (according to the FAT-MachO format).</div></div></div></div><p>Along with standard format components like headers, sections, import table, load commands, symbols, etc. LIEF is also able to parse PE Authenticode:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>import</span> <span style=color:#00f;font-weight:700>lief</span>
</span></span><span style=display:flex><span>  driver <span style=color:#666>=</span> lief<span style=color:#666>.</span>parse(<span style=color:#ba2121>&#34;driver.sys&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>for</span> crt <span style=color:#a2f;font-weight:700>in</span> driver<span style=color:#666>.</span>signature<span style=color:#666>.</span>certificates:
</span></span><span style=display:flex><span>    <span style=color:green>print</span>(crt)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-console data-lang=console><span style=display:flex><span><span>
</span></span></span><span style=display:flex><span><span></span><span style=color:#888>  Version:             3
</span></span></span><span style=display:flex><span><span style=color:#888>  Serial Number:       61:07:02:dc:00:00:00:00:00:0b
</span></span></span><span style=display:flex><span><span style=color:#888>  Signature Algorithm: SHA1_WITH_RSA_ENCRYPTION
</span></span></span><span style=display:flex><span><span style=color:#888>  Valid from:          2005-9-15 21:55:41
</span></span></span><span style=display:flex><span><span style=color:#888>  Valid to:            2016-3-15 22:5:41
</span></span></span><span style=display:flex><span><span style=color:#888>  Issuer:              DC=com, DC=microsoft, CN=Microsoft Root Certificate Authority
</span></span></span><span style=display:flex><span><span style=color:#888>  Subject:             C=US, ST=Washington, L=Redmond, O=Microsoft Corporation, CN=Microsoft Windows Verification PCA
</span></span></span><span style=display:flex><span><span style=color:#888>  ...
</span></span></span></code></pre></div><p>Full API documentation is available here</p><ul><li><a href=https://lief-project.github.io/doc/latest/api/python/index.html>Python API</a></li><li><a href=https://lief-project.github.io/doc/latest/api/cpp/index.html>C++ API</a></li><li><a href=https://lief-project.github.io/doc/latest/api/c/index.html>C API</a></li></ul><h1 id=architecture>Architecture</h1><p>In the <code>LIEF</code> architecture, each format implements at least the following classes:</p><ul><li>Parser: Parse the format and decompose it into a <code>Binary</code> class</li><li>Binary: Modelize the format and provide an API to modify and explore it.</li><li>Builder: Transform the binary object into a valid file.</li></ul><figure><img src=archi.png></figure><p>To factor common characteristics in formats we have an inheritance relationship between these characteristics.</p><p>For symbols it gives the following diagram:</p><figure><img src=symbol_inheritance.png></figure><p>It enables to write cross-format utility like <code>nm</code>. <code>nm</code> is a Unix utility to list symbols in an executable. The source code is available here: <a href=https://github.com/gittup/binutils/blob/0af702d47a443acea853b84157c2e81f6c131e77/binutils/nm.c>binutils</a></p><p>With the given inheritance relationship one can write this utility for the three formats in a single script:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span>  <span style=color:green;font-weight:700>import</span> <span style=color:#00f;font-weight:700>lief</span>
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>import</span> <span style=color:#00f;font-weight:700>sys</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>def</span> <span style=color:#00f>nm</span>(binary):
</span></span><span style=display:flex><span>    <span style=color:green;font-weight:700>for</span> symbol <span style=color:#a2f;font-weight:700>in</span> binary<span style=color:#666>.</span>symbols:
</span></span><span style=display:flex><span>      <span style=color:green>print</span>(symbol)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green;font-weight:700>return</span> <span style=color:#666>0</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>if</span> __name__ <span style=color:#666>==</span> <span style=color:#ba2121>&#34;__main__&#34;</span>:
</span></span><span style=display:flex><span>    r <span style=color:#666>=</span> nm(sys<span style=color:#666>.</span>argv[<span style=color:#666>1</span>])
</span></span><span style=display:flex><span>    sys<span style=color:#666>.</span>exit(r)
</span></span></code></pre></div><h1 id=conclusion>Conclusion</h1><p>As LIEF is still a young project we hope to have feedback, ideas, suggestions and pull requests.</p><p>The source code is available here: <a href=https://github.com/lief-project>https://github.com/lief-project</a> (under Apache 2.0 license) and the associated website: <a href=http://lief.quarkslab.com>http://lief.quarkslab.com</a></p><p>If you are interested in use cases, you can take a look at these tutorials:</p><ul><li><a href=https://lief-project.github.io/doc/latest/tutorials/01_play_with_formats.html>Parse and manipulate formats</a></li><li><a href=https://lief-project.github.io/doc/latest/tutorials/02_pe_from_scratch.html>Create a PE from scratch</a></li><li><a href=https://lief-project.github.io/doc/latest/tutorials/03_elf_change_symbols.html>Play with ELF symbols</a></li><li><a href=https://lief-project.github.io/doc/latest/tutorials/04_elf_hooking.html>Hooking</a></li><li><a href=https://lief-project.github.io/doc/latest/tutorials/05_elf_infect_plt_got.html>Infecting the PLT/GOT</a></li></ul><p>The project will be presented at the <a href=http://cyber.science-japon.org/>Third French Japanese Meeting on Cybersecurity</a></p><h1 id=contact>Contact</h1><ul><li>lief [at] quarkslab [dot] com</li><li>Gitter: <a href=https://gitter.im/lief-project>lief-project</a></li></ul><h1 id=thanks>Thanks</h1><p>Thanks to Serge Guelton and Adrien Guinet for their advice about the design and their code review. Thanks to Quarkslab for making this project open-source.</p></p></div></div></div></div></main><script src=/vendor/bootstrap/dist/js/bootstrap.min.js></script>
<script src=/vendor/headroom.js/dist/headroom.min.js></script>
<script src=/vendor/onscreen/dist/on-screen.umd.min.js></script>
<script src=/vendor/jarallax/dist/jarallax.min.js></script>
<script src=/vendor/smooth-scroll/dist/smooth-scroll.polyfills.min.js></script>
<script src=/js/theme.bundle.js></script>
<script src=/vendor/@glidejs/glide/dist/glide.min.js></script>
<script src=/js/anime.min.js></script></body></html>