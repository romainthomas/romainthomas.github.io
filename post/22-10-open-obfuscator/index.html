<!doctype html><html lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=manifest href=manifest.webmanifest><link rel=icon type=image/png href=/img/favicon/favicon_hu2a60c33e6cc729e53465c846fe50d8b2_13867_32x32_fill_box_center_3.png><link rel=apple-touch-icon type=image/png href=/img/favicon/favicon_hu2a60c33e6cc729e53465c846fe50d8b2_13867_192x192_fill_box_center_3.png><meta name=description content="This blog post introduces open-obfuscator, a new open-source project to obfuscate mobile applications."><meta name=keywords content="Android,iOS,obfuscation,LLVM,Proguard"><meta property="og:type" content="article"><meta property="og:description" content="This blog post introduces open-obfuscator, a new open-source project to obfuscate mobile applications."><meta property="og:title" content="Open-Obfuscator: A free and open-source obfuscator for mobile applications | Romain Thomas"><meta property="og:site_name" content="Romain Thomas"><meta property="og:image" content="https://www.romainthomas.fr/post/22-10-open-obfuscator/featured.webp"><meta property="og:url" content="https://www.romainthomas.fr/post/22-10-open-obfuscator/"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2022-10-31T00:00:00+00:00"><meta property="article:modified_time" content="2022-10-31T08:34:27+01:00"><meta property="article:tag" content="Android"><meta property="article:tag" content="iOS"><meta property="article:tag" content="obfuscation"><meta property="article:tag" content="LLVM"><meta property="article:tag" content="Proguard"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@rh0main"><meta name=twitter:creator content="@rh0main"><meta name=twitter:title content="Open-Obfuscator: A free and open-source obfuscator for mobile applications | Romain Thomas"><meta name=twitter:description content="This blog post introduces open-obfuscator, a new open-source project to obfuscate mobile applications."><meta name=twitter:domain content="https://www.romainthomas.fr/post/22-10-open-obfuscator/"><meta property="twitter:image" content="https://www.romainthomas.fr/post/22-10-open-obfuscator/featured.webp"><title>Romain Thomas</title><link rel=canonical href=https://www.romainthomas.fr/post/22-10-open-obfuscator/><link rel=stylesheet href=/css/fa-all.min.css><link rel=stylesheet href=/vendor/@glidejs/glide/dist/css/glide.core.min.css><link rel=stylesheet href=/vendor/@glidejs/glide/dist/css/glide.theme.min.css><link rel=stylesheet href=/css/theme.bundle.css><style>.hide{opacity:0}</style><noscript><style>.hide{opacity:1;!important}</style></noscript><style>.hero_background{position:relative;overflow:hidden}.hero_background:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:90%;z-index:1;opacity:.2;background-image:url(/img/bg_home.svg);background-repeat:repeat;background-position:50%;background-size:100%;transform:rotate(180deg)}.project_bg{position:relative;overflow:hidden}.project_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:.1;background-image:url(/img/bg_project.svg);background-repeat:repeat;background-position:50%;background-size:100%;transform:rotate(180deg)}.experience_bg{position:relative;overflow:hidden}.experience_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:.1;background-image:url(/img/bg_experience.svg);background-position:0 0;background-size:100%}.post_bg{position:relative;overflow:hidden}.post_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:80%;z-index:1;opacity:.6;background-image:url(/img/bg_post.svg);background-position:0 0;background-size:100%}.contact_bg{position:relative;overflow:hidden}.contact_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:80%;z-index:1;opacity:.2;background-image:url(/img/bg_contact.svg);background-position:0 0;background-size:100%}.footnotes p{margin-bottom:0}.highlight{padding-left:20px;border-left:1px solid rgba(0,0,0,.1);border-radius:2px 2px}</style></head><body><header class=header-global><nav id=navbar-main aria-label="Primary navigation" class="navbar navbar-main navbar-expand-lg navbar-theme-primary headroom navbar-dark"><div class="container position-relative"><a class="navbar-brand me-lg-5" href=https://www.romainthomas.fr/><span class="navbar-brand-dark ft-ananda">R. T</span>
<span class="navbar-brand-light ft-ananda">R. T</span></a><div class="navbar-collapse collapse me-auto" id=navbar_global><div class=navbar-collapse-header><div class=row><div class="col-6 collapse-close"><a href=#navbar_global class="fas fa-times" data-bs-toggle=collapse data-bs-target=#navbar_global aria-controls=navbar_global aria-expanded=false title=close aria-label="Toggle navigation"></a></div></div></div><ul class="navbar-nav navbar-nav-hover align-items-lg-center"><li class=nav-item><a href=https://www.romainthomas.fr/#about class="nav-link fw-bold"><span class="fa-regular fa-person-swimming"></span> About</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#posts class="nav-link fw-bold"><span class="fa-regular fa-blog"></span> Posts</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#projects class="nav-link fw-bold"><span class="fa-regular fa-terminal"></span> Projects</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#publications class="nav-link fw-bold"><span class="far fa-book-open-cover"></span> Publications</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#trainings class="nav-link fw-bold"><span class="far fa-books"></span> Trainings</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#work-experience class="nav-link fw-bold"><span class="fa-regular fa-briefcase"></span> Work Experience</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#misc class="nav-link fw-bold"><span class="fa-regular fa-chart-network"></span> Misc</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#contact class="nav-link fw-bold"><span class="fa-regular fa-binary-lock"></span> Contact</a></li></ul></div><div class="d-flex align-items-center"><button class="navbar-toggler ms-2 collapsed" type=button data-bs-toggle=collapse data-bs-target=#navbar_global aria-controls=navbar_global aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button></div></div></nav></header><main><section class="section-header pb-5 pb-sm-7 bg-primary text-white post_bg"><div class=container><div class="row justify-content-center"><div class="col-12 col-lg-10 text-center"><div class=mb-4><a href=/categories/android/><span class="me-2 badge alert-info text-uppercase px-3 btn-outline-primary">Android</span>
</a><a href=/categories/ios/><span class="me-2 badge alert-info text-uppercase px-3 btn-outline-primary">iOS</span>
</a><a href=/categories/reverse-engineering/><span class="me-2 badge alert-info text-uppercase px-3 btn-outline-primary">Reverse Engineering</span>
</a><a href=/categories/obfuscation/><span class="me-2 badge alert-info text-uppercase px-3 btn-outline-primary">Obfuscation</span></a></div><h1 class="display-3 mb-4 px-lg-5">Open-Obfuscator: A free and open-source obfuscator for mobile applications</h1><div class=post-meta><span class="fw-bold me-3">Romain Thomas</span>
<span class="post-date me-3">October 31, 2022</span>
<span class=fw-bold>8 min read</span></div></div></div></div><figure class="position-absolute bottom-0 left-0 w-100 d-none d-md-block mb-n2"><svg class="fill-white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 3e3 185.4"><path d="M3e3.0v185.4H0V0c496.4 115.6 996.4 173.4 15e2 173.4S2503.6 115.6 3e3.0z"/></svg></figure></section><section class="section section-lg pt-0 pb-0" id=featured><div class="container mt-n8 mt-lg-n10 z-2 pb-0"><div class="row mt-7 mx-10"><img src=/post/22-10-open-obfuscator/featured.webp class="rounded img-fluid" alt=featured.webp></div></div></section><div class="section section-sm bg-white pt-4 pt-lg-4 text-black"><article class=container><div class="row justify-content-center"><div class="col-12 col-lg-9"><p><h2 id=introduction>Introduction</h2><p>This post is about a new project on which I (intensively) worked this month. It aims at providing a free and
open-source solution for obfuscating mobile applications.</p><div class="col-12 col-md-12 mb-4 mb-lg-4 mt-4"><div class="p-4 rounded col-12 alert alert-info" style=border:none!important;background-color:#fafcff><div class="d-flex px-3"><div><div class="icon icon-sm icon-secondary"><span class="fas fa-bolt" style=color:#084298></span></div></div><div class=ps-4 style=color:#084298><h3 class="h5 m-0 mb-1" style=color:#084298>TL;DR</h3>open-obfuscator is available at this url: <a href=https://obfuscator.re>https://obfuscator.re</a>, and this blog post is more about the motivation
behind this project.
You can also check the GitHub repositories: <a href=https://github.com/open-obfuscator/o-mvll>O-MVLL</a> & <a href=https://github.com/open-obfuscator/dprotect>dProtect</a></div></div></div></div><h2 id=the-origin-of-this-project>The origin of this project</h2><p>Since several years now, I&rsquo;m doing reverse engineering on (obfuscated) mobile applications and my latest
publications tend to be more about how to &ldquo;defeat&rdquo; obfuscation rather than how to protect code.
I actually enjoy both aspects and I&rsquo;m also aware that breaking<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> something or reversing a RASP check
is &ndash; most of the time &ndash; easier than finding and building something that works <strong>at scale</strong> and
for <strong>different users/environments</strong> (like an obfuscator).</p><p>An idea started to grow after a recent discussion about the legal aspect of reverse engineering on obfuscated code.
It&rsquo;s true: reverse engineering an obfuscator is not permitted and publishing the results is even less.
Depending on the interlocutor, you might be lucky or not (c.f <a href=https://www.heise.de/newsticker/meldung/Offenlegung-von-Softwareluecken-Rechtsstreit-endet-mit-Vergleich-4156393.html>Promon vs University Researchers</a> and this <a href="https://www.youtube.com/watch?v=RGNarKVO-WI">36C3 talk</a>).</p><p>That being said, the publications of this blog followed a responsible disclosure in which the stakeholders
have been contacted ahead time of the publications.
For instance, the feedback from Google for Safetynet was very fair:</p><p><img src=./snet.webp alt="Google&amp;rsquo;s feedback" title="Google's feedback"></p><p>On the other hand, if one would have to decide which solution would be better to protect his assets,
this person could only refer (and infer) datasheets, demos<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>, or testimonials.</p><p>In particular, there are no public benchmarks to get an idea about how solutions are positioned
from each other.
Moreover, it can be difficult for developers to understand the purpose of an obfuscation scheme and how
it really works underneath.</p><p>Thus, why not trying to take another hat and creating an obfuscator that fulfills these objectives:</p><ul><li>Easy to use and easy to integrate for the developers.</li><li>Highly documented so that developers have a good understanding of the protections.</li><li>Open source:<ol><li>to welcome <strong>public improvements</strong>.</li><li>to welcome <strong>public attacks</strong>, free from legal issues, which in the end are used to enhance the protections.</li><li>to be objectively and technically benchmarked.</li></ol></li><li>Realistic: trying to be as close as possible to the state of the art for the benefit of both: developers and attackers.</li></ul><div class="admonition note"><p><center><p><b><i>Obfuscation and open source sounds a bit contradictory no?</i></b></p></center></p></div><p>Somehow yes. If the design is known attacks are easier. <strong>But</strong>, even if an obfuscation technique
is known, attacks can remain costly.</p><p>Let&rsquo;s take an example with the control-flow flattening protection.
The technique is known, documented and there are public attacks<sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>
but defeating this pass (statically) can be painful and time-consuming.
Usually (including myself), it forces the reverse engineer to analyze the program dynamically
which shifts the problem to dynamic protections. Thus, we can
assume that the pass is efficient against static analysis even if it is known.</p><p>Another example, <a href=https://www.romainthomas.fr/publication/22-sstic-blackhat-droidguard-safetynet/>Safetynet</a>.
The overall design of the protection is based on a virtual machine.
Once we reversed the different handlers, we can assume that the design is &ldquo;known&rdquo;.
Some layers of obfuscation are also based on <strong>known</strong> MBA. But, Google did something very smart, a new
version is published regularly and the internal components are shuffled.</p><p>I do believe that the strongest protection against reverse engineering comes from a well-thought design,
not an individual obfuscation pass.</p><p>Obfuscation is also about time, and I think that by combining several (known) obfuscation techniques,
we can trigger a time-out in the attackers.</p><p>Talking about time, this month I had the time to bridge all these ideas.</p><h2 id=technical-choices>Technical choices</h2><p>So far, the ideas were on the paper and I did not want to create &ldquo;<em>yet another O-LLVM fork</em>&rdquo; <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup> or
spend time on something that already exists.</p><h2 id=native-code-obfuscation>Native code obfuscation</h2><p>No doubt about using LLVM and while looking at the current solutions based on LLVM,
I found <a href=https://github.com/eshard/obfuscator-llvm>eshard/obfuscator-llvm</a> on GitHub which is developed by <a href=https://eshard.com/>eShard</a>
(a company known for side channels attacks on whiteboxes <sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup><sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>).</p><p>Compared to other LLVM-based obfuscators, it uses the new LLVM pass manager which enables us to load an
<strong>out-of-tree plugin</strong> with clang:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span>clang -fpass-plugin<span style=color:#666>=</span>&lt;path/to/llvm/obfuscation&gt;/libLLVMObfuscator.so <span style=color:#b62;font-weight:700>\
</span></span></span><span style=display:flex><span><span style=color:#b62;font-weight:700></span>      hello_world.c -o hello_world
</span></span></code></pre></div><p>I was definitely convinced by this way of using an obfuscator. Especially because it keeps the original
compiler from the toolchain which simplifies this kind of issue: <a href=https://github.com/HikariObfuscator/Hikari/wiki/Troubleshooting#aarch64e-support>Hikari/Troubleshooting - AArch64e Support</a>.</p><p>On the other hand, I was less convinced of using environment variables to trigger and configure the obfuscation passes.</p><h2 id=javakotlin-obfuscation>Java/Kotlin obfuscation</h2><p>To support Java and Kotlin obfuscation for Android, I had a look at
<a href=https://github.com/Guardsquare/proguard>Proguard</a>/<a href=https://github.com/Guardsquare/proguard-core>Proguard-core</a>
which actually provides all the components to create an obfuscation pipeline.</p><p>Proguard is known for obfuscating symbols (class names, methods, &mldr;) and optimizing code but it&rsquo;s just
the tip of the iceberg. The project is <strong>really really</strong> well designed and modular such as it was very
easy to add an obfuscation pipeline.</p><h2 id=o-mvlldprotect>O-MVLL/dProtect</h2><p>I ended up with two projects:</p><ol><li>O-MVLL, in reference to the well know, parent of all the forks:
<a href=https://github.com/obfuscator-llvm>O-LLVM</a>.</li><li><strong>d</strong>Protect for <strong><code>{dex,droid}</code></strong>-Protector</li></ol><h3 id=o-mvll>O-MVLL</h3><p>O-MVLL uses the original idea of eShard: a <em>pass-plugin</em> obfuscator.
On the other hand, it uses a Python API instead of environment variables.</p><p>In short, the user defines what she/he wants to protect and how she/he wants to protect it in Python. For instance,
to obfuscate strings the developer must override the <code>obfuscate_string</code> method:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:green;font-weight:700>def</span> <span style=color:#00f>obfuscate_string</span>(self,
</span></span><span style=display:flex><span>                     mod: omvll<span style=color:#666>.</span>Module,
</span></span><span style=display:flex><span>                     func: omvll<span style=color:#666>.</span>Function,
</span></span><span style=display:flex><span>                     string: <span style=color:green>bytes</span>):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#408080;font-style:italic># Replace the string</span>
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>return</span> <span style=color:#ba2121>&#34;REDACTED&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#408080;font-style:italic># Obfuscate the string on the stack</span>
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>return</span> omvll<span style=color:#666>.</span>StringEncOptStack()
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>  <span style=color:#408080;font-style:italic># Obfsucate the string the stack with a</span>
</span></span><span style=display:flex><span>  <span style=color:#408080;font-style:italic># loop if the length is too long</span>
</span></span><span style=display:flex><span>  <span style=color:green;font-weight:700>return</span> omvll<span style=color:#666>.</span>StringEncOptStack(loopThreshold<span style=color:#666>=</span><span style=color:#666>0</span>)
</span></span><span style=display:flex><span>  <span style=color:#666>...</span>
</span></span></code></pre></div><p>There is also <code>mod: omvll.Module</code> and <code>func: omvll.Function</code> in the arguments of the function.</p><p>These arguments are LLVM objects wrapped with Python bindings. Thus, the user can use all the information (name, flags, visibility <sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>)
provided by LLVM for these objects.</p><p>If the user only wants to protect strings in the function <code>omvll::decode()</code>, she/he can use this condition:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:green;font-weight:700>def</span> <span style=color:#00f>obfuscate_string</span>(self,
</span></span><span style=display:flex><span>                     mod: omvll<span style=color:#666>.</span>Module,
</span></span><span style=display:flex><span>                     func: omvll<span style=color:#666>.</span>Function,
</span></span><span style=display:flex><span>                     string: <span style=color:green>bytes</span>):
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:green;font-weight:700>if</span> func<span style=color:#666>.</span>demangled_name <span style=color:#666>==</span> <span style=color:#ba2121>&#34;omvll::decode()&#34;</span>:
</span></span><span style=display:flex><span>        <span style=color:green;font-weight:700>return</span> StringEncOptGlobal()
</span></span><span style=display:flex><span>    <span style=color:#666>...</span>
</span></span></code></pre></div><p>You can find more details about this pass <a href=https://obfuscator.re/omvll/passes/strings-encoding/>here</a> and
you can also explore the O-MVLL documentation <a href=https://obfuscator.re/omvll>here</a>.</p><h3 id=dprotect>dProtect</h3><p>For dProtect, nothing really new in terms of API compared to Proguard.
I added custom obfuscation passes that can be enabled as follows:</p><div class=highlight><pre tabindex=0 style=-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-bash data-lang=bash><span style=display:flex><span><span style=color:#408080;font-style:italic># Mixed boolean-arithmetic Obfuscation</span>
</span></span><span style=display:flex><span>-obfuscate-arithmetic,high class com.dprotect.salsa20 <span style=color:#666>{</span>
</span></span><span style=display:flex><span>  *;
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic># Strings protection</span>
</span></span><span style=display:flex><span>-obfuscate-strings <span style=color:#ba2121>&#34;XEYnuNOGoEQ*&#34;</span>, <span style=color:#ba2121>&#34;TOKEN: *&#34;</span>
</span></span><span style=display:flex><span>-obfuscate-strings class dprotect.Connect <span style=color:#666>{</span>
</span></span><span style=display:flex><span>  private static java.lang.String API_KEY;
</span></span><span style=display:flex><span>  public static java.lang.String getToken<span style=color:#666>()</span>;
</span></span><span style=display:flex><span><span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic># Constants</span>
</span></span><span style=display:flex><span>-obfuscate-constants    class com.dprotect.secret.** <span style=color:#666>{</span> *; <span style=color:#666>}</span>
</span></span><span style=display:flex><span><span style=color:#408080;font-style:italic># Control-Flow</span>
</span></span><span style=display:flex><span>-obfuscate-control-flow class com.dprotect.internal.** <span style=color:#666>{</span> *; <span style=color:#666>}</span>
</span></span></code></pre></div><p>The logic of these dProtect&rsquo;s passes relies on existing internal components available in Proguard and
Proguard-CORE which have been developed by
<a href=https://www.lafortune.eu/>Eric Lafortune</a> and <a href=https://jameshamilton.eu/>James Hamilton</a>.</p><p>In its current version, dProtect provides the following obfuscation passes:</p><ul><li><a href=https://obfuscator.re/dprotect/passes/arithmetic/>Arithmetic Obfuscation</a></li><li><a href=https://obfuscator.re/dprotect/passes/constants/>Constants Obfuscation</a></li><li><a href=https://obfuscator.re/dprotect/passes/control-flow/>Control-Flow Obfuscation</a></li><li><a href=https://obfuscator.re/dprotect/passes/strings/>Strings Encryption</a></li></ul><h2 id=ci>CI</h2><p>O-MVLL and dProtect are CI compiled with nightly packages available at these addresses:</p><ul><li><a href=http://nightly.obfuscator.re/latest/omvll>http://nightly.obfuscator.re/latest/omvll</a></li><li><a href=http://nightly.obfuscator.re/latest/dprotect>http://nightly.obfuscator.re/latest/dprotect</a></li></ul><p>The CI for O-MVLL could have been challenging to setup but since it is based on an out-of-tree plugin,
once the right version of LLVM is pre-compiled, it takes about <strong>2 minutes</strong> to compile the project from scratch
for both: the NDK and the Xcode toolchain.</p><p>The environment to compile O-MVLL for the Android NDK and Xcode is fully Dockerized and available on Dockerhub:
<a href=https://hub.docker.com/u/openobfuscator>https://hub.docker.com/u/openobfuscator</a>:</p><ul><li><a href=https://hub.docker.com/r/openobfuscator/omvll-ndk>openobfuscator/omvll-ndk</a></li><li><a href=https://hub.docker.com/r/openobfuscator/omvll-xcode>openobfuscator/omvll-xcode</a></li></ul><p>For those who are interested, you can check out the Github Action configurations:</p><ul><li><a href=https://github.com/open-obfuscator/o-mvll/blob/main/.github/workflows/ndk.yml>NDK Workflow</a></li><li><a href=https://github.com/open-obfuscator/o-mvll/blob/main/.github/workflows/xcode.yml>Xcode Workflow</a></li></ul><h2 id=demo>Demo</h2><p>I think the better way to demonstrate the level of obfuscation that can be provided by O-MVLL and dProtect in
their current version, is to obfuscate an open-source project.</p><p>For that purpose, I choose <a href=https://github.com/optiv/android-ndk-crackme>optiv/android-ndk-crackme</a>
and the configuration of O-MVLL and dProtect are available here:</p><ul><li><a href=https://gist.github.com/romainthomas/68ecda22775c2b3ca036bd58e4e73e5a>o-conf.py</a></li><li><a href=https://gist.github.com/romainthomas/0d89bcd2547ff5968a0f3a5f4f7c067d>dProtect.pro</a></li></ul><p>The cherry on the cake, I also applied some techniques described in
<a href=https://www.romainthomas.fr/publication/22-pst-the-poor-mans-obfuscator/>&ldquo;The Poor Man Obfuscator&rdquo;</a>:</p><ul><li><a href=https://gist.github.com/romainthomas/5898cd2c64b01b29270d9cad6787c1ff>elf_tricks.py</a></li></ul><p>In the end, we have this un-obfuscated version of the crackme: <a href=https://data.romainthomas.fr/22-10-open-obfuscator/com.optiv.ndkcrackme.apk>com.optiv.ndkcrackme.apk</a>
and this one, protected with O-MVLL and dProtect: <a href=https://data.romainthomas.fr/22-10-open-obfuscator/com.optiv.ndkcrackme-protected.apk>com.optiv.ndkcrackme-protected.apk</a></p><p>About iOS, O-MVLL works <strong>as a PoC and the support is far from being finished</strong>:</p><div class="col-12 col-md-12 mb-4 mb-lg-4 mt-4"><div class="p-4 rounded col-12 alert alert-info" style=border:none!important;background-color:#ffebeb><div class="d-flex px-3"><div><div class="icon icon-sm icon-secondary"><span class="fas fa-warning" style=color:#e40000></span></div></div><div class=ps-4 style=color:#e40000><h3 class="h5 m-0 mb-1" style=color:#e40000>iOS</h3>The obfuscation passes <a href=https://obfuscator.re/omvll/passes/anti-hook/>Anti-Hooking</a> and
<a href=https://obfuscator.re/omvll/passes/control-flow-breaking>Control-Flow Breaking</a> are not working
correctly due to an issue (from O-MVLL) in the JIT engine.<br><br><u>The overall support for iOS is <strong>highly</strong> experimental.</u></div></div></div></div><p>Nevertheless, you can compare this (unprotected) version of zlib for iOS: <a href=https://data.romainthomas.fr/22-10-open-obfuscator/libz.dylib>libz.dylib</a>
with this protected one: <a href=https://data.romainthomas.fr/22-10-open-obfuscator/libz-obfuscated.dylib>libz-obfuscated.dylib</a>.</p><p>The obfuscation has been done with this configuration file: <a href=https://gist.github.com/romainthomas/149ce793702f3dc28126f7840f5d6870>ios-zlib-obf.py</a>.</p><h2 id=last-words>Last words</h2><p>The project is one month old so you can expect bugs, limitations, and typos. I released a beta version
on GitHub so feel free to try and send your feedback.</p><p>Regarding the time spent on the project:</p><ul><li>60% on the documentation, UI, website, etc</li><li>30% on the obfuscation passes themselves</li><li>5% on the CI</li><li>5% on the tests</li></ul><p>So yes, some obfuscation passes still need to be improved to be really efficient and the support for iOS is
very very experimental (i.e. depending on the configuration, <strong>the compiler might crash</strong>).
There is also a test suite for both dProtect and O-MVLL but it is not public yet.</p><p>Open-obfuscator is going to be my second largest project after <a href=https://lief-project.github.io/>LIEF</a>
and I hope it will serve its long-term purpose:</p><p><strong>Providing an obfuscation playground for both, developers and reverse engineers</strong>.</p><br><p>Thank you for reading and happy Halloween 🎃</p><p>Romain</p><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>Breaking obfuscation is a moot topic.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>I guess the <em>terms of use</em> of the demo does not allow you to reverse it.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>See: <a href=https://obfuscator.re/omvll/passes/control-flow-flattening/#references>https://obfuscator.re/omvll/passes/control-flow-flattening/#references</a>&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>This fork exists: <a href=https://github.com/emc2314/YANSOllvm>https://github.com/emc2314/YANSOllvm</a>&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p><a href=https://gitlab.com/eshard/scared>https://gitlab.com/eshard/scared</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p><a href=https://gitlab.com/eshard/estraces>https://gitlab.com/eshard/estraces</a>&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7><p>In the current version, only the name is provided.&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></p></div></div></div></div></main><script src=/vendor/bootstrap/dist/js/bootstrap.min.js></script>
<script src=/vendor/headroom.js/dist/headroom.min.js></script>
<script src=/vendor/onscreen/dist/on-screen.umd.min.js></script>
<script src=/vendor/jarallax/dist/jarallax.min.js></script>
<script src=/vendor/smooth-scroll/dist/smooth-scroll.polyfills.min.js></script>
<script src=/js/theme.bundle.js></script>
<script src=/vendor/@glidejs/glide/dist/glide.min.js></script>
<script src=/js/anime.min.js></script></body></html>