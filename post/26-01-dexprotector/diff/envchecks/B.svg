<?xml version="1.0" ?>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
    viewBox="0 0 772 1059" width="772" height="1059">
    <g font-family="JetBrains Mono" font-size="12px" font-weight="600">
<image href="envchecks-bg.webp" width="772" height="1059" />
    <text x="22" y="22"  xml:space="preserve"><tspan fill="#cba6f7">package</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">com.dexprotector.detector.envchecks</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="39"   xml:space="preserve"><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="56"   xml:space="preserve"><tspan fill="#cba6f7">import</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">android.security.keystore.KeyGenParameterSpec</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="73"   xml:space="preserve"><tspan fill="#cba6f7">import</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">android.util.Base64</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="90"   xml:space="preserve"><tspan fill="#cba6f7">import</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">android.util.Log</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="107"   xml:space="preserve"><tspan fill="#cba6f7">import</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">java.nio.charset.StandardCharsets</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="124"   xml:space="preserve"><tspan fill="#cba6f7">import</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">java.security.KeyPairGenerator</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="141"   xml:space="preserve"><tspan fill="#cba6f7">import</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">java.security.KeyStore</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="158"   xml:space="preserve"><tspan fill="#cba6f7">import</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">java.security.cert.Certificate</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="175"   xml:space="preserve"><tspan fill="#cba6f7">import</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">java.security.cert.X509Certificate</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="192"   xml:space="preserve"><tspan fill="#cba6f7">import</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">java.security.spec.ECGenParameterSpec</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="209"   xml:space="preserve"><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="226"   xml:space="preserve"><tspan fill="#cba6f7">public</tspan><tspan>&#160;</tspan><tspan fill="#cba6f7">class</tspan><tspan>&#160;</tspan><tspan fill="#f9e2af">KeystoreUtils</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">{</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="243"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">private</tspan><tspan>&#160;</tspan><tspan fill="#cba6f7">static</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">String</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">keyCertificateAttestationExt</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="260"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">private</tspan><tspan>&#160;</tspan><tspan fill="#cba6f7">static</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">String</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">keyName</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan>&#160;</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">dexprotector_ec_keys</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="277"   xml:space="preserve"><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="294"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">public</tspan><tspan>&#160;</tspan><tspan fill="#cba6f7">static</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">String</tspan><tspan>&#160;</tspan><tspan fill="#89b4fa">getKeyAttestationExt</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#9399b2">)</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">{</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="311"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">Certificate</tspan><tspan fill="#94e2d5">[</tspan><tspan fill="#94e2d5">]</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">certificateChain</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="328"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">String</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">strEncodeToString</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="345"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">String</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">str</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">keyCertificateAttestationExt</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="362"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cdd6f4">str</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan fill="#94e2d5">=</tspan><tspan>&#160;</tspan><tspan fill="#89b4fa">null</tspan><tspan fill="#9399b2">)</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">{</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="379"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">try</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">{</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="396"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">KeyPairGenerator</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">keyPairGenerator</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="413"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">KeyPairGenerator</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">getInstance</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">EC</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">,</tspan><tspan>&#160;</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">AndroidKeyStore</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="430"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">KeyStore</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">keyStore</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">KeyStore</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">getInstance</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">AndroidKeyStore</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="447"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">keyStore</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">load</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#89b4fa">null</tspan><tspan fill="#9399b2">,</tspan><tspan>&#160;</tspan><tspan fill="#89b4fa">null</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="464"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cdd6f4">keyStore</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">containsAlias</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cdd6f4">keyName</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">)</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">{</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="481"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">certificateChain</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">keyStore</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">getCertificateChain</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cdd6f4">keyName</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="498"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">}</tspan><tspan>&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">{</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="515"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">keyPairGenerator</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">initialize</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="532"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">new</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">KeyGenParameterSpec</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">Builder</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cdd6f4">keyName</tspan><tspan fill="#9399b2">,</tspan><tspan>&#160;</tspan><tspan fill="#fab387">4</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="549"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">setAlgorithmParameterSpec</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cba6f7">new</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">ECGenParameterSpec</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">secp256r1</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="566"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">setDigests</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#9399b2">{</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">SHA-256</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">,</tspan><tspan>&#160;</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">SHA-384</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">,</tspan><tspan>&#160;</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">SHA-512</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">}</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="583"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">setUserAuthenticationRequired</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#89b4fa">true</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="600"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">setUserAuthenticationValidityDurationSeconds</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#fab387">300</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="617"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">setAttestationChallenge</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">getting&#160;sec&#160;info</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">getBytes</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cdd6f4">StandardCharsets</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">UTF_8</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="634"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">build</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="651"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">keyPairGenerator</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">generateKeyPair</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="668"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">certificateChain</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">keyStore</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">getCertificateChain</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cdd6f4">keyName</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="685"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">}</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="702"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">byte</tspan><tspan fill="#94e2d5">[</tspan><tspan fill="#94e2d5">]</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">extensionValue</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="719"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cdd6f4">X509Certificate</tspan><tspan fill="#9399b2">)</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">certificateChain</tspan><tspan fill="#94e2d5">[</tspan><tspan fill="#fab387">0</tspan><tspan fill="#94e2d5">]</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="736"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">getExtensionValue</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">1.3.6.1.4.1.11129.2.1.17</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="753"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">if</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cdd6f4">extensionValue</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan fill="#94e2d5">=</tspan><tspan>&#160;</tspan><tspan fill="#89b4fa">null</tspan><tspan fill="#9399b2">)</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">{</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="770"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">strEncodeToString</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan>&#160;</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">Not&#160;Present</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="787"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">}</tspan><tspan>&#160;</tspan><tspan fill="#cba6f7">else</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">{</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="804"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">strEncodeToString</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">Base64</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">encodeToString</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cdd6f4">extensionValue</tspan><tspan fill="#9399b2">,</tspan><tspan>&#160;</tspan><tspan fill="#fab387">0</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="821"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">}</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="838"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">keyCertificateAttestationExt</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">strEncodeToString</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="855"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">keyStore</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">deleteEntry</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">dexprotector_ec_keys</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="872"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">}</tspan><tspan>&#160;</tspan><tspan fill="#cba6f7">catch</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#cdd6f4">Exception</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">e</tspan><tspan fill="#9399b2">)</tspan><tspan>&#160;</tspan><tspan fill="#9399b2">{</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="889"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">Log</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">e</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">DEXPROTECTOR</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">,</tspan><tspan>&#160;</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">Couldn't&#160;get&#160;attestation&#160;ext</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">,</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">e</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="906"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">keyCertificateAttestationExt</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan>&#160;</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">Error</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="923"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">}</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="940"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">Log</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">i</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">DEXPROTECTOR</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">,</tspan><tspan>&#160;</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">Ext:</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="957"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">Log</tspan><tspan fill="#9399b2">.</tspan><tspan fill="#f9e2af">i</tspan><tspan fill="#9399b2">(</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#a6e3a1">DEXPROTECTOR</tspan><tspan fill="#a6e3a1">"</tspan><tspan fill="#9399b2">,</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">keyCertificateAttestationExt</tspan><tspan fill="#9399b2">)</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="974"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cdd6f4">str</tspan><tspan>&#160;</tspan><tspan fill="#94e2d5">=</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">keyCertificateAttestationExt</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="991"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">}</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="1008"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;</tspan><tspan fill="#cba6f7">return</tspan><tspan>&#160;</tspan><tspan fill="#cdd6f4">str</tspan><tspan fill="#9399b2">;</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="1025"   xml:space="preserve"><tspan fill="#cdd6f4">&#160;&#160;&#160;&#160;</tspan><tspan fill="#9399b2">}</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="1042"   xml:space="preserve"><tspan fill="#9399b2">}</tspan><tspan fill="#cdd6f4"></tspan></text>
<text x="22" y="1059"   xml:space="preserve"></text>

    </g>
</svg>
        