<!doctype html><html lang=en-us prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb#"><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=HandheldFriendly content="True"><meta name=MobileOptimized content="320"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><link rel=manifest href=manifest.webmanifest><link rel=icon type=image/png href=/img/favicon/favicon_hu2a60c33e6cc729e53465c846fe50d8b2_13867_32x32_fill_box_center_3.png><link rel=apple-touch-icon type=image/png href=/img/favicon/favicon_hu2a60c33e6cc729e53465c846fe50d8b2_13867_192x192_fill_box_center_3.png><meta name=description content="SafetyNet is the Android component developed by Google to verify the devices' integrity. These checks
are used by the developers to prevent running applications on devices that would not meet security requirements
but it is also used by Google to prevent bots, fraud & abuse.
<br /><br />
In 2017, Collin Mulliner & John Kozyrakis made one of the first public presentations about SafetyNet and
a glimpse into the internal mechanisms.
Since then, the Google anti-abuse team improved the strength of the solution which moved most of the original Java layer of SafetyNet,
into a native module called DroidGuard. This module implements a custom virtual machine that runs a proprietary bytecode
provided by Google to perform the devices integrity checks.
<br /><br />
This paper aims at providing a state-of-the-art of the current implementation of SafetyNet.
In particular, it presents the internal mechanisms behind SafetyNet and the DroidGuard module.
This includes an overview of the VM design, its internal mechanisms, and the security
checks performed by SafetyNet to detect Magisk, emulators, rooted devices, and even Pegasus.
"><meta property="og:type" content="article"><meta property="og:description" content="SafetyNet is the Android component developed by Google to verify the devices' integrity. These checks
are used by the developers to prevent running applications on devices that would not meet security requirements
but it is also used by Google to prevent bots, fraud & abuse.
<br /><br />
In 2017, Collin Mulliner & John Kozyrakis made one of the first public presentations about SafetyNet and
a glimpse into the internal mechanisms.
Since then, the Google anti-abuse team improved the strength of the solution which moved most of the original Java layer of SafetyNet,
into a native module called DroidGuard. This module implements a custom virtual machine that runs a proprietary bytecode
provided by Google to perform the devices integrity checks.
<br /><br />
This paper aims at providing a state-of-the-art of the current implementation of SafetyNet.
In particular, it presents the internal mechanisms behind SafetyNet and the DroidGuard module.
This includes an overview of the VM design, its internal mechanisms, and the security
checks performed by SafetyNet to detect Magisk, emulators, rooted devices, and even Pegasus.
"><meta property="og:title" content="DroidGuard: A Deep Dive into SafetyNet | Romain Thomas"><meta property="og:site_name" content="Romain Thomas"><meta property="og:image" content="https://www.romainthomas.fr/publication/22-sstic-blackhat-droidguard-safetynet/featured.png"><meta property="og:url" content="https://www.romainthomas.fr/publication/22-sstic-blackhat-droidguard-safetynet/"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2022-05-12T00:00:00+00:00"><meta property="article:modified_time" content="2022-06-04T09:39:05+02:00"><meta name=twitter:card content="summary_large_image"><meta name=twitter:site content="@rh0main"><meta name=twitter:creator content="@rh0main"><meta name=twitter:title content="DroidGuard: A Deep Dive into SafetyNet | Romain Thomas"><meta name=twitter:description content="SafetyNet is the Android component developed by Google to verify the devices' integrity. These checks
are used by the developers to prevent running applications on devices that would not meet security requirements
but it is also used by Google to prevent bots, fraud & abuse.
<br /><br />
In 2017, Collin Mulliner & John Kozyrakis made one of the first public presentations about SafetyNet and
a glimpse into the internal mechanisms.
Since then, the Google anti-abuse team improved the strength of the solution which moved most of the original Java layer of SafetyNet,
into a native module called DroidGuard. This module implements a custom virtual machine that runs a proprietary bytecode
provided by Google to perform the devices integrity checks.
<br /><br />
This paper aims at providing a state-of-the-art of the current implementation of SafetyNet.
In particular, it presents the internal mechanisms behind SafetyNet and the DroidGuard module.
This includes an overview of the VM design, its internal mechanisms, and the security
checks performed by SafetyNet to detect Magisk, emulators, rooted devices, and even Pegasus.
"><meta name=twitter:domain content="https://www.romainthomas.fr/publication/22-sstic-blackhat-droidguard-safetynet/"><meta property="twitter:image" content="https://www.romainthomas.fr/publication/22-sstic-blackhat-droidguard-safetynet/featured.png"><title>Romain Thomas</title><link rel=canonical href=https://www.romainthomas.fr/publication/22-sstic-blackhat-droidguard-safetynet/><link rel=stylesheet href=/css/fa-all.min.css><link rel=stylesheet href=/vendor/@glidejs/glide/dist/css/glide.core.min.css><link rel=stylesheet href=/vendor/@glidejs/glide/dist/css/glide.theme.min.css><link rel=stylesheet href=/css/theme.bundle.css><style>.hide{opacity:0}</style><noscript><style>.hide{opacity:1;!important}</style></noscript><style>.hero_background{position:relative;overflow:hidden}.hero_background:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:90%;z-index:1;opacity:.2;background-image:url(/img/bg_home.svg);background-repeat:repeat;background-position:50%;background-size:100%;transform:rotate(180deg)}.project_bg{position:relative;overflow:hidden}.project_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:.1;background-image:url(/img/bg_project.svg);background-repeat:repeat;background-position:50%;background-size:100%;transform:rotate(180deg)}.experience_bg{position:relative;overflow:hidden}.experience_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:100%;z-index:1;opacity:.1;background-image:url(/img/bg_experience.svg);background-position:0 0;background-size:100%}.post_bg{position:relative;overflow:hidden}.post_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:80%;z-index:1;opacity:.6;background-image:url(/img/bg_post.svg);background-position:0 0;background-size:100%}.contact_bg{position:relative;overflow:hidden}.contact_bg:before{pointer-events:none;content:' ';display:block;position:absolute;left:0;top:0;width:100%;height:80%;z-index:1;opacity:.2;background-image:url(/img/bg_contact.svg);background-position:0 0;background-size:100%}.footnotes p{margin-bottom:0}.highlight{padding-left:20px;border-left:1px solid rgba(0,0,0,.1);border-radius:2px 2px}</style></head><body><header class=header-global><nav id=navbar-main aria-label="Primary navigation" class="navbar navbar-main navbar-expand-lg navbar-theme-primary headroom navbar-dark"><div class="container position-relative"><a class="navbar-brand me-lg-5" href=https://www.romainthomas.fr/><span class="navbar-brand-dark ft-ananda">R. T</span>
<span class="navbar-brand-light ft-ananda">R. T</span></a><div class="navbar-collapse collapse me-auto" id=navbar_global><div class=navbar-collapse-header><div class=row><div class="col-6 collapse-close"><a href=#navbar_global class="fas fa-times" data-bs-toggle=collapse data-bs-target=#navbar_global aria-controls=navbar_global aria-expanded=false title=close aria-label="Toggle navigation"></a></div></div></div><ul class="navbar-nav navbar-nav-hover align-items-lg-center"><li class=nav-item><a href=https://www.romainthomas.fr/#about class="nav-link fw-bold"><span class="fa-regular fa-person-swimming"></span> About</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#posts class="nav-link fw-bold"><span class="fa-regular fa-blog"></span> Posts</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#projects class="nav-link fw-bold"><span class="fa-regular fa-terminal"></span> Projects</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#publications class="nav-link fw-bold"><span class="far fa-book-open-cover"></span> Publications</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#work-experience class="nav-link fw-bold"><span class="fa-regular fa-briefcase"></span> Work Experience</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#misc class="nav-link fw-bold"><span class="fa-regular fa-chart-network"></span> Misc</a></li><li class=nav-item><a href=https://www.romainthomas.fr/#contact class="nav-link fw-bold"><span class="fa-regular fa-binary-lock"></span> Contact</a></li></ul></div><div class="d-flex align-items-center"><button class="navbar-toggler ms-2 collapsed" type=button data-bs-toggle=collapse data-bs-target=#navbar_global aria-controls=navbar_global aria-expanded=false aria-label="Toggle navigation">
<span class=navbar-toggler-icon></span></button></div></div></nav></header><main><section class="section-header pb-10 pb-lg-11 mb-4 mb-lg-6 bg-primary text-white"><div class=container><div class="row justify-content-center"><div class="col-12 text-center mb-4 mb-lg-5"><h1 class="display-2 font-weight-extreme mb-4">DroidGuard: A Deep Dive into SafetyNet</h1><div class="d-flex flex-column flex-lg-row justify-content-center"><span class="h5 mb-3 mb-lg-0"><span class="fas fa-map-marker-alt"></span>
<span class=ms-3>SSTIC & BlackHat Asia</span></span>
<span class="ms-lg-5 mb-3 mb-lg-0 h5"><span class="fa-duotone fa-calendars"></span>
<span class=ms-3>May 12, 2022</span></span></div></div></div></div><div class="pattern bottom"></div></section><section class="section section-lg pt-0"><div class="container mt-n8 mt-lg-n11 z-2"><div class="row justify-content-center"><div class=col><div class="card border-gray-300 p-3 p-md-5"><div class="card bg-secondary text-white p-1 p-md-4 mb-4 mb-lg-4"><div class=card-body><span class="icon icon-shape icon-shape-white rounded-circle mb-4 me-4"><span class="fa-duotone fa-lightbulb-exclamation-on"></span></span>
<span class="h5 mb-3">Abstract</span><p class="fw-bold text-justify abstract">SafetyNet is the Android component developed by Google to verify the devices' integrity. These checks
are used by the developers to prevent running applications on devices that would not meet security requirements
but it is also used by Google to prevent bots, fraud & abuse.<br><br>In 2017, Collin Mulliner & John Kozyrakis made one of the first public presentations about SafetyNet and
a glimpse into the internal mechanisms.
Since then, the Google anti-abuse team improved the strength of the solution which moved most of the original Java layer of SafetyNet,
into a native module called DroidGuard. This module implements a custom virtual machine that runs a proprietary bytecode
provided by Google to perform the devices integrity checks.<br><br>This paper aims at providing a state-of-the-art of the current implementation of SafetyNet.
In particular, it presents the internal mechanisms behind SafetyNet and the DroidGuard module.
This includes an overview of the VM design, its internal mechanisms, and the security
checks performed by SafetyNet to detect Magisk, emulators, rooted devices, and even Pegasus.</p></div></div><article class=container><h2 id=hahahugoshortcode-s0-hbhb-slidesslidespdf><i class="fas fa-copy pr-1 fa-fw"></i> <a href=slides.pdf>Slides</a></h2><div class="pdfpreview shortcode shortcode--pdfpreview mb-4"><embed src=slides.pdf type=application/pdf width=100% height=450px></div><h2 id=hahahugoshortcode-s2-hbhb-whitepaperwhitepaperpdf><i class="fas fa-file-pdf pr-1 fa-fw"></i> <a href=whitepaper.pdf>Whitepaper</a></h2><div class="pdfpreview shortcode shortcode--pdfpreview mb-4"><embed src=whitepaper.pdf type=application/pdf width=100% height=1060px></div><h2 id=hahahugoshortcode-s4-hbhb-talk-at-blackhathttpswwwblackhatcomasia-22briefingsscheduledroidguard-a-deep-dive-into-safetynet-25835-english><i class="fas fa-laptop-code pr-1 fa-fw"></i> Talk at <a href=https://www.blackhat.com/asia-22/briefings/schedule/#droidguard-a-deep-dive-into-safetynet-25835>BlackHat</a> (English)</h2><p><em>To be published</em></p><h2 id=hahahugoshortcode-s5-hbhb-talk-at-sstichttpswwwssticorg2022presentationdroidguard_a_deep_dive_into_safetynet-french><i class="fas fa-laptop-code pr-1 fa-fw"></i> Talk at <a href=https://www.sstic.org/2022/presentation/droidguard_a_deep_dive_into_safetynet/>SSTIC</a> (French)</h2><video class=mb-4 controls>
<source src=https://static.sstic.org/videos2022/1080p/droidguard_a_deep_dive_into_safetynet.mp4 type=video/mp4></video><h2 id=hahahugoshortcode-s7-hbhb-assets><i class="fab fa-github pr-1 fa-fw"></i> Assets</h2><p><a href=https://github.com/romainthomas/droidguard-samples>https://github.com/romainthomas/droidguard-samples</a></p></article></div></div></div></div></section></main><script src=/vendor/bootstrap/dist/js/bootstrap.min.js></script>
<script src=/vendor/headroom.js/dist/headroom.min.js></script>
<script src=/vendor/onscreen/dist/on-screen.umd.min.js></script>
<script src=/vendor/jarallax/dist/jarallax.min.js></script>
<script src=/vendor/smooth-scroll/dist/smooth-scroll.polyfills.min.js></script>
<script src=/js/theme.bundle.js></script>
<script src=/vendor/@glidejs/glide/dist/glide.min.js></script>
<script src=/js/anime.min.js></script></body></html>